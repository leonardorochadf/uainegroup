<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard de Energia - UAINE Group</title>
  <link rel="icon" type="image/png" href="logo_sisgdsolar.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --bg: #f4fbf7;
      --card: #ffffff;
      --card-alt: #e9f6ef;
      --border: #c6e4d6;
      --accent: #0f9b9c;
      --accent-strong: #0d7c83;
      --positive: #22c55e;
      --negative: #ef4444;
      --text: #0f2a24;
      --muted: #5f7468;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: radial-gradient(120% 120% at 50% 0%, #b9f3d5 0%, var(--bg) 60%);
      color: var(--text);
      min-height: 100vh;
      padding: 24px;
    }

    header {
      max-width: 1200px;
      margin: 0 auto 32px auto;
      text-align: center;
    }

    .header-container {
      background: #ffffff;
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 32px 24px;
      box-shadow: 0 25px 70px rgba(15, 41, 36, 0.12);
      margin-bottom: 24px;
    }

    header h1 {
      margin: 0;
      font-size: 2.25rem;
      font-weight: 700;
      color: #15803d;
      text-transform: uppercase;
    }

    .header-logo {
      display: block;
      margin: 16px auto;
      max-width: 200px;
      height: auto;
    }

    .header-logos-container {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 32px;
      margin: 16px auto;
      flex-wrap: wrap;
    }

    .header-logos-container img {
      max-width: 200px;
      height: auto;
      display: block;
    }

    .header-metric {
      margin: 12px auto 0 auto;
      max-width: 720px;
      color: var(--muted);
      font-weight: 600;
      letter-spacing: 0.03em;
    }

    .footer-logo {
      display: block;
      margin: 40px auto 24px auto;
      max-width: 250px;
      height: auto;
      text-align: center;
    }

    main {
      max-width: 1200px;
      margin: 0 auto 80px auto;
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    section {
      background: rgba(255, 255, 255, 0.95);
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 24px;
      box-shadow: 0 25px 70px rgba(15, 41, 36, 0.12);
      backdrop-filter: blur(8px);
    }

    .btn-inicio, .btn-topo {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 20px;
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      text-decoration: none;
      font-family: inherit;
    }

    .btn-inicio:hover, .btn-topo:hover {
      background: var(--accent-strong);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(15, 155, 156, 0.3);
    }

    .btn-inicio:active, .btn-topo:active {
      transform: translateY(0);
    }

    .section-title {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 18px;
      font-size: 1.1rem;
      font-weight: 600;
    }

    .section-title span {
      width: 34px;
      height: 34px;
      border-radius: 10px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background: rgba(15, 155, 156, 0.18);
      color: var(--accent);
      font-weight: 700;
    }

    .filters-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 16px;
    }

    .field-full {
      grid-column: 1 / -1;
    }

    .field-full select {
      width: 100%;
    }

    .checkbox-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
      background: var(--card-alt);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px;
      min-height: 200px;
      max-height: none;
      overflow-y: auto;
    }
    

    .checkbox-filter-container {
      display: flex;
      flex-direction: column;
      gap: 8px;
      background: var(--card-alt);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 10px;
      max-height: 200px;
      overflow-y: auto;
    }

    .checkbox-filter-all {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 6px;
      font-weight: 600;
      font-size: 0.9rem;
      color: var(--accent);
      cursor: pointer;
      border-bottom: 1px solid var(--border);
      padding-bottom: 8px;
      margin-bottom: 4px;
    }

    .checkbox-filter-all input {
      accent-color: var(--accent);
      width: 16px;
      height: 16px;
      cursor: pointer;
    }

    .checkbox-filter-list {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .checkbox-filter-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 4px 6px;
      font-size: 0.85rem;
      cursor: pointer;
      border-radius: 4px;
      transition: background 0.2s;
    }

    .checkbox-filter-item:hover {
      background: rgba(15, 155, 156, 0.08);
    }

    .checkbox-filter-item input {
      accent-color: var(--accent);
      width: 16px;
      height: 16px;
      cursor: pointer;
    }

    .checkbox-filter-item label {
      cursor: pointer;
      flex: 1;
      user-select: none;
    }

    .checkbox-item {
      display: flex;
      gap: 12px;
      padding: 12px;
      border: 1px solid rgba(15, 155, 156, 0.12);
      border-radius: 12px;
      background: #fff;
      box-shadow: 0 6px 18px rgba(15, 41, 36, 0.08);
    }

    .checkbox-item.checkbox-all {
      align-items: center;
      justify-content: start;
      font-weight: 600;
      gap: 10px;
    }

    .checkbox-item input {
      accent-color: var(--accent);
      width: 18px;
      height: 18px;
      flex-shrink: 0;
      margin-top: 4px;
      pointer-events: auto !important;
      cursor: pointer !important;
      z-index: 999 !important;
      position: relative !important;
    }
    
    .checkbox-item {
      cursor: pointer;
      position: relative;
    }
    
    .checkbox-item input[type="checkbox"] {
      pointer-events: auto !important;
      cursor: pointer !important;
      z-index: 999 !important;
      position: relative !important;
      margin: 0 !important;
      flex-shrink: 0 !important;
    }
    
    /* Permite intera��o normal com o conte�do, mas mant�m o label clic�vel */
    .checkbox-item .checkbox-meta {
      pointer-events: auto !important;
      user-select: text !important;
    }
    
    .checkbox-item .checkbox-meta * {
      pointer-events: auto !important;
      user-select: text !important;
    }
    
    /* Permite hover e intera��es normais */
    .checkbox-item:hover {
      background: rgba(15, 155, 156, 0.05);
    }
    
    /* Garante que o label seja clic�vel em toda sua �rea */
    label.checkbox-item {
      pointer-events: auto !important;
      position: relative !important;
      z-index: 1 !important;
    }

    .checkbox-meta {
      display: flex;
      flex-direction: column;
      gap: 6px;
      width: 100%;
    }

    .benef-primary {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.95rem;
      color: var(--text);
    }

    .benef-primary span {
      font-size: 0.85rem;
      color: var(--muted);
    }

    .benef-metrics {
      display: block;
      width: 100%;
      margin-top: 8px;
    }
    

    .benef-boxes-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 12px;
      background: rgba(255, 255, 255, 0.5);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 12px;
      min-width: 0;
      overflow: visible;
    }

    .benef-atualmente-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 8px;
      background: rgba(255, 255, 255, 0.7);
      border: 2px solid var(--accent);
      border-radius: 12px;
      padding: 12px;
      min-width: 200px;
    }

    .benef-atualmente-title {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--accent);
      font-weight: 700;
      margin-bottom: 8px;
      border-bottom: 2px solid var(--accent);
      padding-bottom: 6px;
    }

    .benef-atualmente-boxes {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .benef-meta-row {
      display: flex;
      flex-direction: row;
      gap: 12px;
      align-items: stretch;
      width: 100%;
      margin-bottom: 20px;
      flex-shrink: 0;
      clear: both;
      position: relative;
      box-sizing: border-box;
    }
    
    .benef-meta-row:last-child {
      margin-bottom: 0;
    }
    
    .benef-meta-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 12px;
      min-width: 0;
      box-sizing: border-box;
    }
    
    .benef-year-data-container {
      display: flex;
      flex-direction: row;
      gap: 12px;
      align-items: flex-start;
      flex-wrap: nowrap;
      width: 100%;
      box-sizing: border-box;
    }
    
    .benef-year-data-left {
      display: flex;
      flex-direction: column;
      gap: 12px;
      flex: 0 0 25%;
      min-width: 0;
      box-sizing: border-box;
    }
    
    .benef-year-data-right {
      flex: 1 1 75%;
      min-width: 500px;
      max-width: 75%;
      box-sizing: border-box;
      display: flex;
      align-items: stretch;
    }
    
    .benef-year-data-right .benef-box {
      width: 100%;
      display: flex;
      flex-direction: column;
      height: auto;
      max-height: 400px;
    }
    
    .benef-year-data-right canvas {
      width: 100% !important;
      max-height: 350px !important;
      height: 350px !important;
      min-height: 350px;
    }
    
    .chart-table-container {
      margin-top: 16px;
      width: 100%;
      overflow-x: auto;
    }
    
    .chart-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.85rem;
      background: var(--card);
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }
    
    .chart-table thead {
      background: var(--card-alt);
    }
    
    .chart-table th {
      padding: 10px 12px;
      text-align: left;
      font-weight: 600;
      color: var(--text);
      border-bottom: 2px solid var(--border);
      text-transform: uppercase;
      font-size: 0.75rem;
      letter-spacing: 0.05em;
    }
    
    .chart-table td {
      padding: 8px 12px;
      border-bottom: 1px solid var(--border);
      color: var(--text);
    }
    
    .chart-table tbody tr:last-child td {
      border-bottom: none;
    }
    
    .chart-table tbody tr:hover {
      background: rgba(15, 155, 156, 0.05);
    }
    
    .chart-table td:nth-child(2),
    .chart-table td:nth-child(3) {
      text-align: right;
      font-weight: 500;
    }
    
    .benef-meta {
      display: flex;
      flex-direction: row;
      gap: 12px;
      align-items: stretch;
      width: 100%;
      margin-bottom: 16px;
      flex-shrink: 0;
      min-height: 200px;
    }
    
    .benef-meta:last-child {
      margin-bottom: 0;
    }

    .benef-box {
      flex: 1;
      min-width: 160px;
      background: var(--card-alt);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .benef-year-indicator {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-width: 50px;
      align-self: stretch;
      background: linear-gradient(135deg, var(--accent), #4ade80);
      color: #fff;
      border-radius: 12px;
      padding: 12px 8px;
      font-weight: 700;
      font-size: 1.2rem;
      letter-spacing: 2px;
      writing-mode: vertical-rl;
      text-orientation: mixed;
      box-shadow: 0 4px 12px rgba(15, 155, 156, 0.3);
      white-space: nowrap;
    }
    
    .benef-year-indicator.multiple-years {
      writing-mode: horizontal-tb;
      text-orientation: unset;
      font-size: 0.9rem;
      padding: 8px 12px;
      min-width: auto;
    }

    .benef-box-title {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--muted);
      font-weight: 600;
      margin-bottom: 4px;
      border-bottom: 1px solid var(--border);
      padding-bottom: 4px;
    }

    .benef-box-item {
      font-size: 0.7rem;
      color: var(--muted);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .benef-box-item strong {
      color: var(--text);
      font-weight: 600;
      font-size: 0.7rem;
    }

    .benef-box-single {
      text-align: center;
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--accent);
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    label {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.04em;
      color: var(--muted);
    }

    select, input {
      background: var(--card-alt);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 10px 12px;
      color: var(--text);
      font-size: 0.95rem;
      transition: border 0.2s ease, box-shadow 0.2s ease;
    }

    select:focus, input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 2px rgba(15, 155, 156, 0.2);
    }

    button {
      background: linear-gradient(120deg, var(--accent), #4ade80);
      border: none;
      border-radius: 12px;
      color: #fff;
      font-weight: 600;
      font-size: 0.95rem;
      padding: 12px 18px;
      cursor: pointer;
      margin-top: 8px;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 12px 30px rgba(15, 155, 156, 0.3);
    }

    .highlight-card {
      display: flex;
      flex-direction: column;
      gap: 8px;
      padding: 20px;
      border-radius: 16px;
      background: linear-gradient(135deg, #e4fff5 0%, #ffffff 60%);
      border: 1px solid var(--border);
      margin-bottom: 16px;
    }

    .highlight-card[data-state="positive"] {
      border-color: rgba(34, 197, 94, 0.6);
      box-shadow: 0 10px 32px rgba(34, 197, 94, 0.2);
    }

    .highlight-card[data-state="negative"] {
      border-color: rgba(239, 68, 68, 0.5);
      box-shadow: 0 10px 32px rgba(239, 68, 68, 0.18);
    }

    .highlight-card small {
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-weight: 600;
      color: var(--muted);
    }

    .highlight-card strong {
      font-size: 2rem;
      letter-spacing: -0.02em;
    }

    .highlight-card p {
      margin: 0;
      color: var(--muted);
    }

    .year-summary-card {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      padding: 20px;
      border-radius: 16px;
      background: linear-gradient(135deg, #f9fffb 0%, #eefaf3 80%);
      border: 1px solid var(--border);
      margin-top: 16px;
    }

    .year-summary-item {
      display: flex;
      flex-direction: column;
      gap: 8px;
      padding: 16px;
      background: #fff;
      border-radius: 12px;
      border: 1px solid var(--border);
      box-shadow: 0 4px 12px rgba(15, 41, 36, 0.08);
    }

    .year-summary-item-label {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--muted);
      font-weight: 600;
    }

    .year-summary-item-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--text);
    }

    .year-summary-item-value.positive {
      color: var(--positive);
    }

    .year-summary-item-value.negative {
      color: var(--negative);
    }

    .year-summary-item-detail {
      font-size: 0.8rem;
      color: var(--muted);
      margin-top: 4px;
    }

    .summary-cards-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 16px;
      margin-top: 16px;
    }

    .summary-card {
      background: linear-gradient(135deg, #f9fffb 0%, #eefaf3 80%);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(15, 41, 36, 0.08);
    }

    .summary-card-title {
      font-size: 1rem;
      font-weight: 700;
      color: var(--text);
      margin-bottom: 16px;
      text-align: center;
      padding-bottom: 12px;
      border-bottom: 2px solid var(--border);
    }

    .summary-card-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 0;
      border-bottom: 1px solid rgba(15, 155, 156, 0.1);
    }

    .summary-card-item:last-child {
      border-bottom: none;
    }

    .summary-card-item-label {
      font-size: 0.9rem;
      color: var(--muted);
      font-weight: 500;
    }

    .summary-card-item-value {
      font-size: 1rem;
      font-weight: 700;
      color: var(--text);
    }

    .summary-card-item-value.positive {
      color: var(--positive);
    }

    .summary-card-item-value.negative {
      color: var(--negative);
    }

    .chart-container {
      position: relative;
      width: 100%;
      min-height: 320px;
    }

    .insights-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(190px, 1fr));
      gap: 16px;
    }

    .insight-card {
      background: linear-gradient(135deg, #fcfffd 0%, #e8f8f1 80%);
      border: 1px solid rgba(15, 155, 156, 0.12);
      border-radius: 14px;
      padding: 20px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      align-items: center;
      text-align: center;
      gap: 10px;
      min-height: 150px;
    }

    .insight-card span {
      font-size: 0.8rem;
      color: var(--muted);
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }

    .insight-card strong {
      font-size: 1.6rem;
      font-weight: 600;
    }

    .insight-card p {
      margin: 0;
      font-size: 0.85rem;
      color: var(--muted);
    }

    .table-wrapper {
      margin-top: 20px;
      border-radius: 14px;
      border: 1px solid var(--border);
      overflow: hidden;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.9rem;
    }

    thead {
      background: var(--card-alt);
    }

    th, td {
      padding: 12px 14px;
      text-align: left;
      border-bottom: 1px solid rgba(15, 42, 36, 0.08);
    }

    tbody tr:hover {
      background: rgba(15, 155, 156, 0.12);
    }

    /* Oculta a coluna "kWh Recebido a mais do Previsto" quando todos os valores são 0 */
    table.hide-diferenca-column thead th:nth-child(5),
    table.hide-diferenca-column tbody td:nth-child(5) {
      display: none !important;
    }

    .empty-state {
      text-align: center;
      padding: 40px 0;
      color: var(--muted);
    }

    @media (max-width: 640px) {
      body {
        padding: 16px;
      }
      section {
        padding: 18px;
      }
    }

    /* Estilos para seção de Contas EDP */
    .pdf-benef-card {
      background: linear-gradient(135deg, #f9fffb 0%, #eefaf3 80%);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 4px 12px rgba(15, 41, 36, 0.08);
    }

    .pdf-benef-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 2px solid var(--border);
    }

    .pdf-benef-header .benef-primary {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .pdf-benef-header .benef-primary strong {
      font-size: 1.1rem;
      color: var(--text);
    }

    .pdf-benef-header .benef-primary span {
      font-size: 0.9rem;
      color: var(--muted);
    }

    .pdf-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 12px;
    }

    .pdf-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 12px 16px;
      transition: all 0.2s ease;
    }

    .pdf-item:hover {
      border-color: var(--accent);
      box-shadow: 0 2px 8px rgba(15, 155, 156, 0.2);
      transform: translateY(-1px);
    }

    .pdf-item-name {
      flex: 1;
      font-size: 0.9rem;
      color: var(--text);
      font-weight: 500;
    }

    .pdf-item-actions {
      display: flex;
      gap: 8px;
    }

    .pdf-btn {
      background: var(--accent);
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 6px 12px;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .pdf-btn:hover {
      background: #0d9a9b;
      transform: translateY(-1px);
      box-shadow: 0 2px 6px rgba(15, 155, 156, 0.3);
    }

    .pdf-btn.download {
      background: linear-gradient(120deg, #4ade80, #22c55e);
    }

    .pdf-btn.download:hover {
      background: linear-gradient(120deg, #22c55e, #16a34a);
    }
  </style>
</head>
<body>
  <header>
    <div class="header-container">
      <h1>Analítica de Energia Contratada vs Recebida</h1>
      <div class="header-logos-container">
        <img src="logo_cooperebr.jpg" alt="COOPEREBR - Energia Verde">
        <img src="cropped-UAINE-GROUP.png" alt="UAINE GROUP">
      </div>
      <p style="text-align: center; font-size: 1.1rem; font-weight: 600; color: #333; margin-top: 12px; margin-bottom: 0;">PLANO DE ASSINATURA</p>
    </div>
    <p id="instalacoesIndicator" class="header-metric">Instalações monitoradas: 0</p>
  </header>

  <main>
    <section>
      <div class="section-title">
        <span>01</span>
        <button class="btn-inicio" onclick="scrollToTop()" style="margin-left: auto;">🏠 Início</button>
      </div>
      <form id="filters" class="filters-grid">
        <div class="field" style="display: none;">
          <label for="parceiroFilter">Parceiro</label>
          <select id="parceiroFilter">
            <option value="">Todos</option>
          </select>
        </div>
        <div class="field">
          <label>Ano</label>
          <div class="checkbox-filter-container" id="anoFilterContainer">
            <label class="checkbox-filter-all">
              <input type="checkbox" id="anoFilterAll" data-filter="ano">
              <span>Todos</span>
            </label>
            <div class="checkbox-filter-list" id="anoFilterList"></div>
          </div>
        </div>
        <div class="field" style="display: none;">
          <label>Mês / Ano</label>
          <div class="checkbox-filter-container" id="mesFilterContainer">
            <label class="checkbox-filter-all">
              <input type="checkbox" id="mesFilterAll" data-filter="mes">
              <span>Todos</span>
            </label>
            <div class="checkbox-filter-list" id="mesFilterList"></div>
          </div>
        </div>
        <div class="field">
          <label>Instalação</label>
          <div class="checkbox-filter-container" id="instalacaoFilterContainer">
            <label class="checkbox-filter-all">
              <input type="checkbox" id="instalacaoFilterAll" data-filter="instalacao">
              <span>Todas</span>
            </label>
            <div class="checkbox-filter-list" id="instalacaoFilterList"></div>
          </div>
        </div>
        <div class="field field-full">
          <label for="benefFilter">Beneficiário</label>
          <div id="benefFilter" class="checkbox-list"></div>
        </div>
      </form>
    </section>

    <section>
      <h2 class="section-title" style="margin-bottom: 16px; font-size: 1.2rem; font-weight: 700;">
        Total Período Filtro
      </h2>
      <div class="highlight-card" id="diffCard" data-state="positive" style="display: none;">
        <small style="color: #000000; font-weight: 600;">Recebido acima do contratado</small>
        <strong id="diffValue" style="font-size: 2rem; font-weight: 700; color: #15803d; margin: 8px 0;">0 kWh</strong>
      </div>
      <div class="year-summary-card" id="yearSummaryCard" hidden>
        <div class="year-summary-item">
          <div class="year-summary-item-label">kWh Recebidos (Período Filtro)</div>
          <div class="year-summary-item-value" id="yearRecebido">0</div>
        </div>
      </div>
      <!-- Detalhe dos anos com recebimento acima do contratado -->
      <div id="diffDetailContainer" style="margin-top: 16px; display: none;">
        <div class="benef-atualmente-container">
          <div class="benef-atualmente-title">Total recebido a mais por ano</div>
          <div class="chart-table-container">
            <table class="chart-table">
              <thead>
                <tr>
                  <th>Ano</th>
                  <th>kWh recebido a mais</th>
                </tr>
              </thead>
              <tbody id="diffDetailBody">
                <!-- preenchido via JS -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- Seção 02 - Distribuição mensal beneficiário em caixa separada -->
    <section>
      <div class="section-title">
        <span>02</span>
        <div>Distribuição mensal beneficiário</div>
        <button class="btn-inicio" onclick="scrollToTop()" style="margin-left: auto;">🏠 Início</button>
      </div>
      <div class="chart-container">
        <canvas id="energiaChart" aria-label="Gráfico contratado vs recebido" role="img"></canvas>
      </div>
    </section>

    <section>
      <div class="section-title">
        <span>03</span>
        <button class="btn-inicio" onclick="scrollToTop()" style="margin-left: auto;">🏠 Início</button>
      </div>
      <div class="insights-grid" id="insightsGrid">
        <!-- preenchido via JS -->
      </div>
      <h3 style="margin-top: 24px; margin-bottom: 16px; font-size: 1.2rem; font-weight: 600; color: var(--text);">kWh Recebido a mais</h3>
      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>Mês/Ano</th>
              <th>Instalação</th>
              <th>Beneficiário</th>
              <th>kWh recebido</th>
              <th>kWh Recebido a mais do Previsto</th>
              <th>Mensalidade (R$)</th>
              <th>% Desc. Energia</th>
            </tr>
          </thead>
          <tbody id="tableBody">
            <!-- preenchido via JS -->
          </tbody>
        </table>
        <div class="empty-state" id="emptyState" hidden>
          Nenhum registro encontrado para os filtros selecionados.
        </div>
      </div>
    </section>

    <section>
      <div class="section-title">
        <span>04</span>
        <div>Energia Total Gerada pela Usina</div>
        <button class="btn-inicio" onclick="scrollToTop()" style="margin-left: auto;">🏠 Início</button>
      </div>
      <div class="chart-container">
        <canvas id="usinaChart" aria-label="Gr�fico energia gerada pela usina" role="img"></canvas>
      </div>
      <div class="table-wrapper" style="margin-top: 24px;">
        <table id="usinaTable" style="width: 100%; border-collapse: collapse;">
          <thead id="usinaTableHead">
            <!-- preenchido via JS -->
          </thead>
          <tbody id="usinaTableBody">
            <!-- preenchido via JS -->
          </tbody>
        </table>
      </div>
      <div id="usinaSummaryContainer" style="margin-top: 32px; display: flex; flex-direction: column; gap: 24px;">
        <!-- Resumo por ano ser� inserido aqui via JS -->
        <div id="usinaYearSummary" style="display: flex; flex-wrap: wrap; gap: 16px;">
          <!-- Caixas por ano ser�o inseridas aqui -->
        </div>
        <!-- Resumo geral -->
        <div id="usinaGeneralSummary" style="display: flex; flex-wrap: wrap; gap: 16px;">
          <!-- Caixas gerais ser�o inseridas aqui -->
        </div>
      </div>
    </section>

    <section>
      <div class="section-title">
        <span>05</span>
        <div>Análise de Performance da Usina</div>
        <button class="btn-inicio" onclick="scrollToTop()" style="margin-left: auto;">🏠 Início</button>
      </div>
      <div id="usinaPerformanceContainer" style="display: flex; flex-direction: column; gap: 24px;">
        <!-- Análises de performance serão inseridas aqui via JS -->
      </div>
    </section>

    <!-- Dashboard Executivo -->
    <section id="executiveDashboard" style="background: linear-gradient(135deg, rgba(15, 155, 156, 0.1) 0%, rgba(15, 155, 156, 0.05) 100%);">
      <div class="section-title">
        <span>06</span>
        <div>Dashboard Executivo</div>
        <button class="btn-inicio" onclick="scrollToTop()" style="margin-left: auto;">🏠 Início</button>
      </div>
      <div id="executiveKPIs" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-top: 20px;">
        <!-- KPIs ser�o inseridos aqui via JS -->
      </div>
    </section>

    <!-- Seção 07 - Contas de Energia EDP -->
    <section id="contasEdpSection">
      <div class="section-title">
        <span>07</span>
        <div>Contas de Energia EDP</div>
        <button class="btn-inicio" onclick="scrollToTop()" style="margin-left: auto;">🏠 Início</button>
      </div>
      <div id="contasEdpContainer" style="display: flex; flex-direction: column; gap: 24px; margin-top: 24px;">
        <!-- Cards de beneficiários com PDFs serão inseridos aqui via JS -->
      </div>
    </section>

    <!-- Modal para visualizar PDF -->
    <div id="pdfModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.9); z-index: 10000; overflow: auto;">
      <div style="position: relative; width: 100%; height: 100%; padding: 20px; box-sizing: border-box;">
        <button id="closePdfModal" onclick="closePdfModal(); return false;" style="position: fixed; top: 20px; right: 20px; background: #fff; color: #000; border: none; border-radius: 50%; width: 40px; height: 40px; font-size: 24px; cursor: pointer; z-index: 10001; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 10px rgba(0,0,0,0.3);">×</button>
        <iframe id="pdfViewer" style="width: 100%; height: 100%; border: none; background: #fff;"></iframe>
      </div>
    </div>
  </main>

  <!-- Dados JSON embutidos - pode ser substitu�do por fetch quando usar endpoint -->
  <script type="application/json" id="dashboard-data">


 {"detalhamento_beneficiarios":[{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-12-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":7.217130000000000e+003,"valorMensalidade":5.281460000000000e+003,"percent_desc_energia":10,"valor_kwh":0.73,"percentual_desconto_aplicado":1.778000000000000e+001,"edp_total_kwh":7524,"edp_dif_recebidos_x_contratado":3.068699999999999e+002,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-01-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":7.217130000000000e+003,"valorMensalidade":5.281460000000000e+003,"percent_desc_energia":10,"valor_kwh":0.73,"percentual_desconto_aplicado":4.146000000000000e+001,"edp_total_kwh":7091,"edp_dif_recebidos_x_contratado":-1.261300000000001e+002,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-02-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6.495000000000000e+003,"valorMensalidade":6.062390000000000e+003,"percent_desc_energia":10,"valor_kwh":0.93,"percentual_desconto_aplicado":2.533000000000000e+001,"edp_total_kwh":6476,"edp_dif_recebidos_x_contratado":-1.900000000000000e+001,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-03-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6.495000000000000e+003,"valorMensalidade":6.062390000000000e+003,"percent_desc_energia":10,"valor_kwh":0.93,"percentual_desconto_aplicado":2.533000000000000e+001,"edp_total_kwh":8502,"edp_dif_recebidos_x_contratado":2.007000000000000e+003,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-04-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":7.217130000000000e+003,"valorMensalidade":6.062390000000000e+003,"percent_desc_energia":10,"valor_kwh":0.84,"percentual_desconto_aplicado":3.280000000000000e+001,"edp_total_kwh":7527,"edp_dif_recebidos_x_contratado":3.098699999999999e+002,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-05-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6.495000000000000e+003,"valorMensalidade":6.062390000000000e+003,"percent_desc_energia":10,"valor_kwh":0.93,"percentual_desconto_aplicado":2.533000000000000e+001,"edp_total_kwh":6474,"edp_dif_recebidos_x_contratado":-2.100000000000000e+001,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-06-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6.495000000000000e+003,"valorMensalidade":6.062390000000000e+003,"percent_desc_energia":10,"valor_kwh":0.93,"percentual_desconto_aplicado":2.533000000000000e+001,"edp_total_kwh":5238,"edp_dif_recebidos_x_contratado":-1.257000000000000e+003,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-07-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6.495000000000000e+003,"valorMensalidade":6.062390000000000e+003,"percent_desc_energia":10,"valor_kwh":0.93,"percentual_desconto_aplicado":3.236000000000000e+001,"edp_total_kwh":5506,"edp_dif_recebidos_x_contratado":-9.890000000000000e+002,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-08-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6.495000000000000e+003,"valorMensalidade":6.062390000000000e+003,"percent_desc_energia":10,"valor_kwh":0.93,"percentual_desconto_aplicado":3.236000000000000e+001,"edp_total_kwh":6094,"edp_dif_recebidos_x_contratado":-4.010000000000000e+002,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-09-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6.495000000000000e+003,"valorMensalidade":6.062390000000000e+003,"percent_desc_energia":10,"valor_kwh":0.93,"percentual_desconto_aplicado":3.236000000000000e+001,"edp_total_kwh":6334,"edp_dif_recebidos_x_contratado":-1.610000000000000e+002,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-10-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6.495000000000000e+003,"valorMensalidade":6.062390000000000e+003,"percent_desc_energia":10,"valor_kwh":0.93,"percentual_desconto_aplicado":3.236000000000000e+001,"edp_total_kwh":5648,"edp_dif_recebidos_x_contratado":-8.470000000000000e+002,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-11-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6.495000000000000e+003,"valorMensalidade":6.574000000000000e+003,"percent_desc_energia":10,"valor_kwh":1.01,"percentual_desconto_aplicado":2.665000000000000e+001,"edp_total_kwh":4641,"edp_dif_recebidos_x_contratado":-1.854000000000000e+003,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-12-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6.495000000000000e+003,"valorMensalidade":6.584000000000000e+003,"percent_desc_energia":10,"valor_kwh":1.01,"percentual_desconto_aplicado":2.654000000000000e+001,"edp_total_kwh":6191,"edp_dif_recebidos_x_contratado":-3.040000000000000e+002,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-01-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":7.217130000000000e+003,"valorMensalidade":6.062390000000000e+003,"percent_desc_energia":10,"valor_kwh":0.84,"percentual_desconto_aplicado":3.731000000000000e+001,"edp_total_kwh":5787,"edp_dif_recebidos_x_contratado":-1.430130000000000e+003,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-02-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6.495000000000000e+003,"valorMensalidade":6.584000000000000e+003,"percent_desc_energia":10,"valor_kwh":1.01,"percentual_desconto_aplicado":2.435000000000000e+001,"edp_total_kwh":6719,"edp_dif_recebidos_x_contratado":2.240000000000000e+002,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-03-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6.495000000000000e+003,"valorMensalidade":6.584000000000000e+003,"percent_desc_energia":10,"valor_kwh":1.01,"percentual_desconto_aplicado":2.435000000000000e+001,"edp_total_kwh":7263,"edp_dif_recebidos_x_contratado":7.680000000000000e+002,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-04-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6.495000000000000e+003,"valorMensalidade":6.584000000000000e+003,"percent_desc_energia":10,"valor_kwh":1.01,"percentual_desconto_aplicado":2.435000000000000e+001,"edp_total_kwh":5641,"edp_dif_recebidos_x_contratado":-8.540000000000000e+002,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-05-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6.495000000000000e+003,"valorMensalidade":6.584000000000000e+003,"percent_desc_energia":10,"valor_kwh":1.01,"percentual_desconto_aplicado":2.435000000000000e+001,"edp_total_kwh":5066,"edp_dif_recebidos_x_contratado":-1.429000000000000e+003,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-06-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6.495000000000000e+003,"valorMensalidade":6.584000000000000e+003,"percent_desc_energia":10,"valor_kwh":1.01,"percentual_desconto_aplicado":2.435000000000000e+001,"edp_total_kwh":5434,"edp_dif_recebidos_x_contratado":-1.061000000000000e+003,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-07-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6.495000000000000e+003,"valorMensalidade":6.584000000000000e+003,"percent_desc_energia":10,"valor_kwh":1.01,"percentual_desconto_aplicado":2.435000000000000e+001,"edp_total_kwh":5654,"edp_dif_recebidos_x_contratado":-8.410000000000000e+002,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-08-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6.495000000000000e+003,"valorMensalidade":6.574000000000000e+003,"percent_desc_energia":10,"valor_kwh":1.01,"percentual_desconto_aplicado":2.447000000000000e+001,"edp_total_kwh":6020,"edp_dif_recebidos_x_contratado":-4.750000000000000e+002,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-09-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6.495000000000000e+003,"valorMensalidade":6.574000000000000e+003,"percent_desc_energia":10,"valor_kwh":1.01,"percentual_desconto_aplicado":2.447000000000000e+001,"edp_total_kwh":5618,"edp_dif_recebidos_x_contratado":-8.770000000000000e+002,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-10-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6.495000000000000e+003,"valorMensalidade":6.574000000000000e+003,"percent_desc_energia":10,"valor_kwh":1.01,"percentual_desconto_aplicado":2.447000000000000e+001,"edp_total_kwh":5632,"edp_dif_recebidos_x_contratado":-8.630000000000000e+002,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-12-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.209570000000000e+003,"valorMensalidade":1.283850000000000e+003,"percent_desc_energia":15,"valor_kwh":1.06,"percentual_desconto_aplicado":0.000000000000000e+000,"edp_total_kwh":1267,"edp_dif_recebidos_x_contratado":5.743000000000006e+001,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-01-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.209570000000000e+003,"valorMensalidade":1.283850000000000e+003,"percent_desc_energia":15,"valor_kwh":1.06,"percentual_desconto_aplicado":1.509000000000000e+001,"edp_total_kwh":1194,"edp_dif_recebidos_x_contratado":-1.556999999999994e+001,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-02-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.090000000000000e+003,"valorMensalidade":1.016040000000000e+003,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":2.543000000000000e+001,"edp_total_kwh":1090,"edp_dif_recebidos_x_contratado":0.000000000000000e+000,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-03-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.090000000000000e+003,"valorMensalidade":1.016040000000000e+003,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":2.543000000000000e+001,"edp_total_kwh":1431,"edp_dif_recebidos_x_contratado":3.410000000000000e+002,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-04-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.209570000000000e+003,"valorMensalidade":1.016040000000000e+003,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.280000000000000e+001,"edp_total_kwh":1267,"edp_dif_recebidos_x_contratado":5.743000000000006e+001,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-05-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.090000000000000e+003,"valorMensalidade":1.016040000000000e+003,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":2.543000000000000e+001,"edp_total_kwh":1081,"edp_dif_recebidos_x_contratado":-9.000000000000000e+000,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-06-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.090000000000000e+003,"valorMensalidade":1.016040000000000e+003,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":2.543000000000000e+001,"edp_total_kwh":875,"edp_dif_recebidos_x_contratado":-2.150000000000000e+002,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-07-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.090000000000000e+003,"valorMensalidade":1.016040000000000e+003,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":3.245000000000000e+001,"edp_total_kwh":920,"edp_dif_recebidos_x_contratado":-1.700000000000000e+002,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-08-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.090000000000000e+003,"valorMensalidade":1.016040000000000e+003,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":3.245000000000000e+001,"edp_total_kwh":1018,"edp_dif_recebidos_x_contratado":-7.200000000000000e+001,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-09-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.090000000000000e+003,"valorMensalidade":1.016040000000000e+003,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":3.245000000000000e+001,"edp_total_kwh":1066,"edp_dif_recebidos_x_contratado":-2.400000000000000e+001,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-10-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.090000000000000e+003,"valorMensalidade":1.016040000000000e+003,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":3.245000000000000e+001,"edp_total_kwh":943,"edp_dif_recebidos_x_contratado":-1.470000000000000e+002,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-11-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.090000000000000e+003,"valorMensalidade":1.101900000000000e+003,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":2.675000000000000e+001,"edp_total_kwh":775,"edp_dif_recebidos_x_contratado":-3.150000000000000e+002,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-12-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.090000000000000e+003,"valorMensalidade":1.111900000000000e+003,"percent_desc_energia":15,"valor_kwh":1.02,"percentual_desconto_aplicado":2.608000000000000e+001,"edp_total_kwh":1034,"edp_dif_recebidos_x_contratado":-5.600000000000000e+001,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-01-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.209570000000000e+003,"valorMensalidade":1.016040000000000e+003,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.731000000000000e+001,"edp_total_kwh":976,"edp_dif_recebidos_x_contratado":-2.335699999999999e+002,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-02-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.090000000000000e+003,"valorMensalidade":1.111900000000000e+003,"percent_desc_energia":15,"valor_kwh":1.02,"percentual_desconto_aplicado":2.387000000000000e+001,"edp_total_kwh":1133,"edp_dif_recebidos_x_contratado":4.300000000000000e+001,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-03-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.090000000000000e+003,"valorMensalidade":1.111900000000000e+003,"percent_desc_energia":15,"valor_kwh":1.02,"percentual_desconto_aplicado":2.387000000000000e+001,"edp_total_kwh":1224,"edp_dif_recebidos_x_contratado":1.340000000000000e+002,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-04-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.090000000000000e+003,"valorMensalidade":1.111900000000000e+003,"percent_desc_energia":15,"valor_kwh":1.02,"percentual_desconto_aplicado":2.387000000000000e+001,"edp_total_kwh":951,"edp_dif_recebidos_x_contratado":-1.390000000000000e+002,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-05-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.090000000000000e+003,"valorMensalidade":1.111900000000000e+003,"percent_desc_energia":15,"valor_kwh":1.02,"percentual_desconto_aplicado":2.387000000000000e+001,"edp_total_kwh":854,"edp_dif_recebidos_x_contratado":-2.360000000000000e+002,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-06-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.090000000000000e+003,"valorMensalidade":1.111900000000000e+003,"percent_desc_energia":15,"valor_kwh":1.02,"percentual_desconto_aplicado":2.387000000000000e+001,"edp_total_kwh":916,"edp_dif_recebidos_x_contratado":-1.740000000000000e+002,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-07-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.090000000000000e+003,"valorMensalidade":1.111900000000000e+003,"percent_desc_energia":15,"valor_kwh":1.02,"percentual_desconto_aplicado":2.387000000000000e+001,"edp_total_kwh":953,"edp_dif_recebidos_x_contratado":-1.370000000000000e+002,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-08-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.090000000000000e+003,"valorMensalidade":1.101900000000000e+003,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":2.456000000000000e+001,"edp_total_kwh":1014,"edp_dif_recebidos_x_contratado":-7.600000000000000e+001,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-09-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.090000000000000e+003,"valorMensalidade":1.101900000000000e+003,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":2.456000000000000e+001,"edp_total_kwh":940,"edp_dif_recebidos_x_contratado":-1.500000000000000e+002,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-10-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.090000000000000e+003,"valorMensalidade":1.101900000000000e+003,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":2.456000000000000e+001,"edp_total_kwh":949,"edp_dif_recebidos_x_contratado":-1.410000000000000e+002,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-12-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.347910000000000e+003,"valorMensalidade":1.662300000000000e+003,"percent_desc_energia":15,"valor_kwh":0.71,"percentual_desconto_aplicado":2.045000000000000e+001,"edp_total_kwh":2456,"edp_dif_recebidos_x_contratado":1.080900000000002e+002,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-01-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.347910000000000e+003,"valorMensalidade":1.662300000000000e+003,"percent_desc_energia":15,"valor_kwh":0.71,"percentual_desconto_aplicado":4.336000000000000e+001,"edp_total_kwh":2314,"edp_dif_recebidos_x_contratado":-3.390999999999985e+001,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-02-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.050000000000000e+003,"valorMensalidade":1.972240000000000e+003,"percent_desc_energia":15,"valor_kwh":0.96,"percentual_desconto_aplicado":2.303000000000000e+001,"edp_total_kwh":2113,"edp_dif_recebidos_x_contratado":6.300000000000000e+001,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-03-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.050000000000000e+003,"valorMensalidade":1.972240000000000e+003,"percent_desc_energia":15,"valor_kwh":0.96,"percentual_desconto_aplicado":2.303000000000000e+001,"edp_total_kwh":2775,"edp_dif_recebidos_x_contratado":7.250000000000000e+002,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-04-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.347910000000000e+003,"valorMensalidade":1.972240000000000e+003,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.280000000000000e+001,"edp_total_kwh":2456,"edp_dif_recebidos_x_contratado":1.080900000000002e+002,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-05-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.050000000000000e+003,"valorMensalidade":1.972240000000000e+003,"percent_desc_energia":15,"valor_kwh":0.96,"percentual_desconto_aplicado":2.303000000000000e+001,"edp_total_kwh":2039,"edp_dif_recebidos_x_contratado":-1.100000000000000e+001,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-06-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.050000000000000e+003,"valorMensalidade":1.972240000000000e+003,"percent_desc_energia":15,"valor_kwh":0.96,"percentual_desconto_aplicado":2.303000000000000e+001,"edp_total_kwh":1660,"edp_dif_recebidos_x_contratado":-3.900000000000000e+002,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-07-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.050000000000000e+003,"valorMensalidade":1.972240000000000e+003,"percent_desc_energia":15,"valor_kwh":0.96,"percentual_desconto_aplicado":3.028000000000000e+001,"edp_total_kwh":1745,"edp_dif_recebidos_x_contratado":-3.050000000000000e+002,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-08-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.050000000000000e+003,"valorMensalidade":1.972240000000000e+003,"percent_desc_energia":15,"valor_kwh":0.96,"percentual_desconto_aplicado":3.028000000000000e+001,"edp_total_kwh":1931,"edp_dif_recebidos_x_contratado":-1.190000000000000e+002,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-09-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.050000000000000e+003,"valorMensalidade":1.972240000000000e+003,"percent_desc_energia":15,"valor_kwh":0.96,"percentual_desconto_aplicado":3.028000000000000e+001,"edp_total_kwh":1993,"edp_dif_recebidos_x_contratado":-5.700000000000000e+001,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-10-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.050000000000000e+003,"valorMensalidade":1.972240000000000e+003,"percent_desc_energia":15,"valor_kwh":0.96,"percentual_desconto_aplicado":3.028000000000000e+001,"edp_total_kwh":1790,"edp_dif_recebidos_x_contratado":-2.600000000000000e+002,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-11-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.050000000000000e+003,"valorMensalidade":2.133720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.04,"percentual_desconto_aplicado":2.458000000000000e+001,"edp_total_kwh":1471,"edp_dif_recebidos_x_contratado":-5.790000000000000e+002,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-12-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.050000000000000e+003,"valorMensalidade":2.143720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.05,"percentual_desconto_aplicado":2.422000000000000e+001,"edp_total_kwh":1950,"edp_dif_recebidos_x_contratado":-1.000000000000000e+002,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-01-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.347910000000000e+003,"valorMensalidade":1.972240000000000e+003,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.731000000000000e+001,"edp_total_kwh":1828,"edp_dif_recebidos_x_contratado":-5.199099999999999e+002,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-02-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.050000000000000e+003,"valorMensalidade":2.143720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.05,"percentual_desconto_aplicado":2.196000000000000e+001,"edp_total_kwh":2122,"edp_dif_recebidos_x_contratado":7.200000000000000e+001,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-03-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.050000000000000e+003,"valorMensalidade":2.143720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.05,"percentual_desconto_aplicado":2.196000000000000e+001,"edp_total_kwh":2298,"edp_dif_recebidos_x_contratado":2.480000000000000e+002,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-04-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.050000000000000e+003,"valorMensalidade":2.143720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.05,"percentual_desconto_aplicado":2.196000000000000e+001,"edp_total_kwh":1784,"edp_dif_recebidos_x_contratado":-2.660000000000000e+002,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-05-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.050000000000000e+003,"valorMensalidade":2.143720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.05,"percentual_desconto_aplicado":2.196000000000000e+001,"edp_total_kwh":1602,"edp_dif_recebidos_x_contratado":-4.480000000000000e+002,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-06-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.050000000000000e+003,"valorMensalidade":2.143720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.05,"percentual_desconto_aplicado":2.196000000000000e+001,"edp_total_kwh":1719,"edp_dif_recebidos_x_contratado":-3.310000000000000e+002,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-07-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.050000000000000e+003,"valorMensalidade":2.143720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.05,"percentual_desconto_aplicado":2.196000000000000e+001,"edp_total_kwh":1789,"edp_dif_recebidos_x_contratado":-2.610000000000000e+002,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-08-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.050000000000000e+003,"valorMensalidade":2.133720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.04,"percentual_desconto_aplicado":2.233000000000000e+001,"edp_total_kwh":1904,"edp_dif_recebidos_x_contratado":-1.460000000000000e+002,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-09-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.050000000000000e+003,"valorMensalidade":2.133720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.04,"percentual_desconto_aplicado":2.233000000000000e+001,"edp_total_kwh":1766,"edp_dif_recebidos_x_contratado":-2.840000000000000e+002,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-10-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.050000000000000e+003,"valorMensalidade":2.133720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.04,"percentual_desconto_aplicado":2.233000000000000e+001,"edp_total_kwh":1782,"edp_dif_recebidos_x_contratado":-2.680000000000000e+002,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-12-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":4.180920000000000e+003,"valorMensalidade":3.039040000000000e+003,"percent_desc_energia":15,"valor_kwh":0.73,"percentual_desconto_aplicado":1.833000000000000e+001,"edp_total_kwh":4364,"edp_dif_recebidos_x_contratado":1.830799999999999e+002,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-01-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":4.180920000000000e+003,"valorMensalidade":3.039040000000000e+003,"percent_desc_energia":15,"valor_kwh":0.73,"percentual_desconto_aplicado":4.185000000000000e+001,"edp_total_kwh":4113,"edp_dif_recebidos_x_contratado":-6.792000000000007e+001,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-02-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3.780000000000000e+003,"valorMensalidade":3.511970000000000e+003,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":2.567000000000000e+001,"edp_total_kwh":3756,"edp_dif_recebidos_x_contratado":-2.400000000000000e+001,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-03-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3.780000000000000e+003,"valorMensalidade":3.511970000000000e+003,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":2.567000000000000e+001,"edp_total_kwh":4931,"edp_dif_recebidos_x_contratado":1.151000000000000e+003,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-04-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":4.180920000000000e+003,"valorMensalidade":3.511970000000000e+003,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.280000000000000e+001,"edp_total_kwh":4366,"edp_dif_recebidos_x_contratado":1.850799999999999e+002,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-05-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3.780000000000000e+003,"valorMensalidade":3.511970000000000e+003,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":2.567000000000000e+001,"edp_total_kwh":3770,"edp_dif_recebidos_x_contratado":-1.000000000000000e+001,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-06-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3.780000000000000e+003,"valorMensalidade":3.511970000000000e+003,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":2.567000000000000e+001,"edp_total_kwh":3050,"edp_dif_recebidos_x_contratado":-7.300000000000000e+002,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-07-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3.780000000000000e+003,"valorMensalidade":3.511970000000000e+003,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":3.267000000000000e+001,"edp_total_kwh":3206,"edp_dif_recebidos_x_contratado":-5.740000000000000e+002,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-08-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3.780000000000000e+003,"valorMensalidade":3.511970000000000e+003,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":3.267000000000000e+001,"edp_total_kwh":3548,"edp_dif_recebidos_x_contratado":-2.320000000000000e+002,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-09-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3.780000000000000e+003,"valorMensalidade":3.511970000000000e+003,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":3.267000000000000e+001,"edp_total_kwh":3692,"edp_dif_recebidos_x_contratado":-8.800000000000000e+001,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-10-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3.780000000000000e+003,"valorMensalidade":3.511970000000000e+003,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":3.267000000000000e+001,"edp_total_kwh":3289,"edp_dif_recebidos_x_contratado":-4.910000000000000e+002,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-11-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3.780000000000000e+003,"valorMensalidade":3.809720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":2.697000000000000e+001,"edp_total_kwh":2702,"edp_dif_recebidos_x_contratado":-1.078000000000000e+003,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-12-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3.780000000000000e+003,"valorMensalidade":3.819720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":2.677000000000000e+001,"edp_total_kwh":3605,"edp_dif_recebidos_x_contratado":-1.750000000000000e+002,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-01-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":4.180920000000000e+003,"valorMensalidade":3.511970000000000e+003,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.731000000000000e+001,"edp_total_kwh":3368,"edp_dif_recebidos_x_contratado":-8.129200000000001e+002,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-02-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3.780000000000000e+003,"valorMensalidade":3.819720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":2.459000000000000e+001,"edp_total_kwh":3910,"edp_dif_recebidos_x_contratado":1.300000000000000e+002,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-03-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3.780000000000000e+003,"valorMensalidade":3.819720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":2.459000000000000e+001,"edp_total_kwh":4227,"edp_dif_recebidos_x_contratado":4.470000000000000e+002,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-04-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3.780000000000000e+003,"valorMensalidade":3.819720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":2.459000000000000e+001,"edp_total_kwh":3283,"edp_dif_recebidos_x_contratado":-4.970000000000000e+002,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-05-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3.780000000000000e+003,"valorMensalidade":3.819720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":2.459000000000000e+001,"edp_total_kwh":2948,"edp_dif_recebidos_x_contratado":-8.320000000000000e+002,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-06-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3.780000000000000e+003,"valorMensalidade":3.819720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":2.459000000000000e+001,"edp_total_kwh":3162,"edp_dif_recebidos_x_contratado":-6.180000000000000e+002,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-07-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3.780000000000000e+003,"valorMensalidade":3.819720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":2.459000000000000e+001,"edp_total_kwh":3291,"edp_dif_recebidos_x_contratado":-4.890000000000000e+002,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-08-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3.780000000000000e+003,"valorMensalidade":3.809720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":2.479000000000000e+001,"edp_total_kwh":3503,"edp_dif_recebidos_x_contratado":-2.770000000000000e+002,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-09-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3.780000000000000e+003,"valorMensalidade":3.809720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":2.479000000000000e+001,"edp_total_kwh":3266,"edp_dif_recebidos_x_contratado":-5.140000000000000e+002,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-10-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3.780000000000000e+003,"valorMensalidade":3.809720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":2.479000000000000e+001,"edp_total_kwh":3277,"edp_dif_recebidos_x_contratado":-5.030000000000000e+002,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-12-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.276780000000000e+003,"valorMensalidade":2.455510000000000e+003,"percent_desc_energia":15,"valor_kwh":1.08,"percentual_desconto_aplicado":0.000000000000000e+000,"edp_total_kwh":2377,"edp_dif_recebidos_x_contratado":1.002199999999998e+002,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-01-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.276780000000000e+003,"valorMensalidade":2.455510000000000e+003,"percent_desc_energia":15,"valor_kwh":1.08,"percentual_desconto_aplicado":1.372000000000000e+001,"edp_total_kwh":2240,"edp_dif_recebidos_x_contratado":-3.678000000000020e+001,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-02-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.076000000000000e+003,"valorMensalidade":1.912500000000000e+003,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":2.630000000000000e+001,"edp_total_kwh":2046,"edp_dif_recebidos_x_contratado":-3.000000000000000e+001,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-03-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.076000000000000e+003,"valorMensalidade":1.912500000000000e+003,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":2.630000000000000e+001,"edp_total_kwh":2686,"edp_dif_recebidos_x_contratado":6.100000000000000e+002,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-04-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.276780000000000e+003,"valorMensalidade":1.912500000000000e+003,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.280000000000000e+001,"edp_total_kwh":2378,"edp_dif_recebidos_x_contratado":1.012199999999998e+002,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-05-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.076000000000000e+003,"valorMensalidade":1.912500000000000e+003,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":2.630000000000000e+001,"edp_total_kwh":2070,"edp_dif_recebidos_x_contratado":-6.000000000000000e+000,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-06-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.076000000000000e+003,"valorMensalidade":1.912500000000000e+003,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":2.630000000000000e+001,"edp_total_kwh":1673,"edp_dif_recebidos_x_contratado":-4.030000000000000e+002,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-07-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.076000000000000e+003,"valorMensalidade":1.912500000000000e+003,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":3.324000000000000e+001,"edp_total_kwh":1758,"edp_dif_recebidos_x_contratado":-3.180000000000000e+002,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-08-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.076000000000000e+003,"valorMensalidade":1.912500000000000e+003,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":3.324000000000000e+001,"edp_total_kwh":1946,"edp_dif_recebidos_x_contratado":-1.300000000000000e+002,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-09-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.076000000000000e+003,"valorMensalidade":1.912500000000000e+003,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":3.324000000000000e+001,"edp_total_kwh":2024,"edp_dif_recebidos_x_contratado":-5.200000000000000e+001,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-10-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.076000000000000e+003,"valorMensalidade":1.912500000000000e+003,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":3.324000000000000e+001,"edp_total_kwh":1804,"edp_dif_recebidos_x_contratado":-2.720000000000000e+002,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-11-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.076000000000000e+003,"valorMensalidade":2.076030000000000e+003,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":2.754000000000000e+001,"edp_total_kwh":1482,"edp_dif_recebidos_x_contratado":-5.940000000000000e+002,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-12-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.076000000000000e+003,"valorMensalidade":2.086030000000000e+003,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":2.719000000000000e+001,"edp_total_kwh":1979,"edp_dif_recebidos_x_contratado":-9.700000000000000e+001,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-01-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.276780000000000e+003,"valorMensalidade":1.912500000000000e+003,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.731000000000000e+001,"edp_total_kwh":1855,"edp_dif_recebidos_x_contratado":-4.217800000000002e+002,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-02-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.076000000000000e+003,"valorMensalidade":2.086030000000000e+003,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":2.501000000000000e+001,"edp_total_kwh":2154,"edp_dif_recebidos_x_contratado":7.800000000000000e+001,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-03-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.076000000000000e+003,"valorMensalidade":2.086030000000000e+003,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":2.501000000000000e+001,"edp_total_kwh":2315,"edp_dif_recebidos_x_contratado":2.390000000000000e+002,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-04-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.076000000000000e+003,"valorMensalidade":2.086030000000000e+003,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":2.501000000000000e+001,"edp_total_kwh":1797,"edp_dif_recebidos_x_contratado":-2.790000000000000e+002,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-05-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.076000000000000e+003,"valorMensalidade":2.086030000000000e+003,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":2.501000000000000e+001,"edp_total_kwh":1614,"edp_dif_recebidos_x_contratado":-4.620000000000000e+002,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-06-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.076000000000000e+003,"valorMensalidade":2.086030000000000e+003,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":2.501000000000000e+001,"edp_total_kwh":1731,"edp_dif_recebidos_x_contratado":-3.450000000000000e+002,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-07-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.076000000000000e+003,"valorMensalidade":2.086030000000000e+003,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":2.501000000000000e+001,"edp_total_kwh":1802,"edp_dif_recebidos_x_contratado":-2.740000000000000e+002,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-08-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.076000000000000e+003,"valorMensalidade":2.076030000000000e+003,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":2.537000000000000e+001,"edp_total_kwh":1918,"edp_dif_recebidos_x_contratado":-1.580000000000000e+002,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-09-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.076000000000000e+003,"valorMensalidade":2.076030000000000e+003,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":2.537000000000000e+001,"edp_total_kwh":1792,"edp_dif_recebidos_x_contratado":-2.840000000000000e+002,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-10-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.076000000000000e+003,"valorMensalidade":2.076030000000000e+003,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":2.537000000000000e+001,"edp_total_kwh":1795,"edp_dif_recebidos_x_contratado":-2.810000000000000e+002,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-12-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":3.566390000000000e+003,"valorMensalidade":3.971410000000000e+003,"percent_desc_energia":15,"valor_kwh":1.11,"percentual_desconto_aplicado":0.000000000000000e+000,"edp_total_kwh":3723,"edp_dif_recebidos_x_contratado":1.566100000000001e+002,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-01-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":3.566390000000000e+003,"valorMensalidade":3.971410000000000e+003,"percent_desc_energia":15,"valor_kwh":1.11,"percentual_desconto_aplicado":1.091000000000000e+001,"edp_total_kwh":3508,"edp_dif_recebidos_x_contratado":-5.838999999999987e+001,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-02-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":3.366000000000000e+003,"valorMensalidade":2.995770000000000e+003,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":2.880000000000000e+001,"edp_total_kwh":3204,"edp_dif_recebidos_x_contratado":-1.620000000000000e+002,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-03-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":3.366000000000000e+003,"valorMensalidade":2.995770000000000e+003,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":2.880000000000000e+001,"edp_total_kwh":4206,"edp_dif_recebidos_x_contratado":8.400000000000000e+002,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-04-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":3.566390000000000e+003,"valorMensalidade":2.995770000000000e+003,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.280000000000000e+001,"edp_total_kwh":3724,"edp_dif_recebidos_x_contratado":1.576100000000001e+002,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-05-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":3.366000000000000e+003,"valorMensalidade":2.995770000000000e+003,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":2.880000000000000e+001,"edp_total_kwh":3352,"edp_dif_recebidos_x_contratado":-1.400000000000000e+001,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-06-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":3.366000000000000e+003,"valorMensalidade":2.995770000000000e+003,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":2.880000000000000e+001,"edp_total_kwh":2715,"edp_dif_recebidos_x_contratado":-6.510000000000000e+002,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-07-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":3.366000000000000e+003,"valorMensalidade":2.995770000000000e+003,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":3.551000000000000e+001,"edp_total_kwh":2854,"edp_dif_recebidos_x_contratado":-5.120000000000000e+002,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-08-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":3.366000000000000e+003,"valorMensalidade":2.995770000000000e+003,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":3.551000000000000e+001,"edp_total_kwh":3159,"edp_dif_recebidos_x_contratado":-2.070000000000000e+002,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-09-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":3.366000000000000e+003,"valorMensalidade":2.995770000000000e+003,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":3.551000000000000e+001,"edp_total_kwh":3275,"edp_dif_recebidos_x_contratado":-9.100000000000000e+001,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-10-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":3.366000000000000e+003,"valorMensalidade":2.995770000000000e+003,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":3.551000000000000e+001,"edp_total_kwh":2928,"edp_dif_recebidos_x_contratado":-4.380000000000000e+002,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-11-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":3.366000000000000e+003,"valorMensalidade":3.260910000000000e+003,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":2.980000000000000e+001,"edp_total_kwh":2406,"edp_dif_recebidos_x_contratado":-9.600000000000000e+002,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-12-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":3.366000000000000e+003,"valorMensalidade":3.270910000000000e+003,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":2.958000000000000e+001,"edp_total_kwh":3206,"edp_dif_recebidos_x_contratado":-1.600000000000000e+002,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-01-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":3.566390000000000e+003,"valorMensalidade":2.995770000000000e+003,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.731000000000000e+001,"edp_total_kwh":2996,"edp_dif_recebidos_x_contratado":-5.703899999999999e+002,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-02-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":3.366000000000000e+003,"valorMensalidade":3.270910000000000e+003,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":2.748000000000000e+001,"edp_total_kwh":3479,"edp_dif_recebidos_x_contratado":1.130000000000000e+002,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-03-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":3.366000000000000e+003,"valorMensalidade":3.270910000000000e+003,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":2.748000000000000e+001,"edp_total_kwh":3757,"edp_dif_recebidos_x_contratado":3.910000000000000e+002,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-04-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":3.366000000000000e+003,"valorMensalidade":3.270910000000000e+003,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":2.748000000000000e+001,"edp_total_kwh":2918,"edp_dif_recebidos_x_contratado":-4.480000000000000e+002,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-05-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":3.366000000000000e+003,"valorMensalidade":3.270910000000000e+003,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":2.748000000000000e+001,"edp_total_kwh":2620,"edp_dif_recebidos_x_contratado":-7.460000000000000e+002,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-06-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":3.366000000000000e+003,"valorMensalidade":3.270910000000000e+003,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":2.748000000000000e+001,"edp_total_kwh":2811,"edp_dif_recebidos_x_contratado":-5.550000000000000e+002,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-07-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":3.366000000000000e+003,"valorMensalidade":3.270910000000000e+003,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":2.748000000000000e+001,"edp_total_kwh":2925,"edp_dif_recebidos_x_contratado":-4.410000000000000e+002,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-08-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":3.366000000000000e+003,"valorMensalidade":3.260910000000000e+003,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":2.770000000000000e+001,"edp_total_kwh":3114,"edp_dif_recebidos_x_contratado":-2.520000000000000e+002,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-09-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":3.366000000000000e+003,"valorMensalidade":3.260910000000000e+003,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":2.770000000000000e+001,"edp_total_kwh":12,"edp_dif_recebidos_x_contratado":-3.354000000000000e+003,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-12-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.535090000000000e+003,"valorMensalidade":7.783500000000000e+002,"percent_desc_energia":15,"valor_kwh":0.51,"percentual_desconto_aplicado":4.303000000000000e+001,"edp_total_kwh":1595,"edp_dif_recebidos_x_contratado":5.991000000000008e+001,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-01-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.535090000000000e+003,"valorMensalidade":7.783500000000000e+002,"percent_desc_energia":15,"valor_kwh":0.51,"percentual_desconto_aplicado":5.944000000000000e+001,"edp_total_kwh":1503,"edp_dif_recebidos_x_contratado":-3.208999999999992e+001,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-02-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.355000000000000e+003,"valorMensalidade":1.289480000000000e+003,"percent_desc_energia":15,"valor_kwh":0.95,"percentual_desconto_aplicado":2.387000000000000e+001,"edp_total_kwh":1373,"edp_dif_recebidos_x_contratado":1.800000000000000e+001,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-03-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.355000000000000e+003,"valorMensalidade":1.289480000000000e+003,"percent_desc_energia":15,"valor_kwh":0.95,"percentual_desconto_aplicado":2.387000000000000e+001,"edp_total_kwh":1802,"edp_dif_recebidos_x_contratado":4.470000000000000e+002,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-04-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.535090000000000e+003,"valorMensalidade":1.289480000000000e+003,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.280000000000000e+001,"edp_total_kwh":1596,"edp_dif_recebidos_x_contratado":6.091000000000008e+001,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-05-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.355000000000000e+003,"valorMensalidade":1.289480000000000e+003,"percent_desc_energia":15,"valor_kwh":0.95,"percentual_desconto_aplicado":2.387000000000000e+001,"edp_total_kwh":1344,"edp_dif_recebidos_x_contratado":-1.100000000000000e+001,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-06-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.355000000000000e+003,"valorMensalidade":1.289480000000000e+003,"percent_desc_energia":15,"valor_kwh":0.95,"percentual_desconto_aplicado":2.387000000000000e+001,"edp_total_kwh":1094,"edp_dif_recebidos_x_contratado":-2.610000000000000e+002,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-07-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.355000000000000e+003,"valorMensalidade":1.289480000000000e+003,"percent_desc_energia":15,"valor_kwh":0.95,"percentual_desconto_aplicado":3.104000000000000e+001,"edp_total_kwh":1150,"edp_dif_recebidos_x_contratado":-2.050000000000000e+002,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-08-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.355000000000000e+003,"valorMensalidade":1.289480000000000e+003,"percent_desc_energia":15,"valor_kwh":0.95,"percentual_desconto_aplicado":3.104000000000000e+001,"edp_total_kwh":1272,"edp_dif_recebidos_x_contratado":-8.300000000000000e+001,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-09-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.355000000000000e+003,"valorMensalidade":1.289480000000000e+003,"percent_desc_energia":15,"valor_kwh":0.95,"percentual_desconto_aplicado":3.104000000000000e+001,"edp_total_kwh":1313,"edp_dif_recebidos_x_contratado":-4.200000000000000e+001,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-10-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.355000000000000e+003,"valorMensalidade":1.289480000000000e+003,"percent_desc_energia":15,"valor_kwh":0.95,"percentual_desconto_aplicado":3.104000000000000e+001,"edp_total_kwh":1179,"edp_dif_recebidos_x_contratado":-1.760000000000000e+002,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-11-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.355000000000000e+003,"valorMensalidade":1.396210000000000e+003,"percent_desc_energia":15,"valor_kwh":1.03,"percentual_desconto_aplicado":2.533000000000000e+001,"edp_total_kwh":969,"edp_dif_recebidos_x_contratado":-3.860000000000000e+002,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-12-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.355000000000000e+003,"valorMensalidade":1.406210000000000e+003,"percent_desc_energia":15,"valor_kwh":1.04,"percentual_desconto_aplicado":2.480000000000000e+001,"edp_total_kwh":1285,"edp_dif_recebidos_x_contratado":-7.000000000000000e+001,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-01-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.535090000000000e+003,"valorMensalidade":1.289480000000000e+003,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.731000000000000e+001,"edp_total_kwh":1209,"edp_dif_recebidos_x_contratado":-3.260899999999999e+002,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-02-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.355000000000000e+003,"valorMensalidade":1.406210000000000e+003,"percent_desc_energia":15,"valor_kwh":1.04,"percentual_desconto_aplicado":2.255000000000000e+001,"edp_total_kwh":1404,"edp_dif_recebidos_x_contratado":4.900000000000000e+001,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-03-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.355000000000000e+003,"valorMensalidade":1.406210000000000e+003,"percent_desc_energia":15,"valor_kwh":1.04,"percentual_desconto_aplicado":2.255000000000000e+001,"edp_total_kwh":1509,"edp_dif_recebidos_x_contratado":1.540000000000000e+002,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-04-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.355000000000000e+003,"valorMensalidade":1.406210000000000e+003,"percent_desc_energia":15,"valor_kwh":1.04,"percentual_desconto_aplicado":2.255000000000000e+001,"edp_total_kwh":1172,"edp_dif_recebidos_x_contratado":-1.830000000000000e+002,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-05-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.355000000000000e+003,"valorMensalidade":1.406210000000000e+003,"percent_desc_energia":15,"valor_kwh":1.04,"percentual_desconto_aplicado":2.255000000000000e+001,"edp_total_kwh":1053,"edp_dif_recebidos_x_contratado":-3.020000000000000e+002,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-06-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.355000000000000e+003,"valorMensalidade":1.406210000000000e+003,"percent_desc_energia":15,"valor_kwh":1.04,"percentual_desconto_aplicado":2.255000000000000e+001,"edp_total_kwh":1129,"edp_dif_recebidos_x_contratado":-2.260000000000000e+002,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-07-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.355000000000000e+003,"valorMensalidade":1.406210000000000e+003,"percent_desc_energia":15,"valor_kwh":1.04,"percentual_desconto_aplicado":2.255000000000000e+001,"edp_total_kwh":1175,"edp_dif_recebidos_x_contratado":-1.800000000000000e+002,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-08-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.355000000000000e+003,"valorMensalidade":1.396210000000000e+003,"percent_desc_energia":15,"valor_kwh":1.03,"percentual_desconto_aplicado":2.310000000000000e+001,"edp_total_kwh":1251,"edp_dif_recebidos_x_contratado":-1.040000000000000e+002,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-10-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.355000000000000e+003,"valorMensalidade":1.396210000000000e+003,"percent_desc_energia":15,"valor_kwh":1.03,"percentual_desconto_aplicado":2.310000000000000e+001,"edp_total_kwh":1170,"edp_dif_recebidos_x_contratado":-1.850000000000000e+002,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-12-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":9.056350000000000e+003,"valorMensalidade":6.257310000000000e+003,"percent_desc_energia":15,"valor_kwh":0.69,"percentual_desconto_aplicado":2.237000000000000e+001,"edp_total_kwh":9449,"edp_dif_recebidos_x_contratado":3.926499999999996e+002,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-01-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":9.056350000000000e+003,"valorMensalidade":6.257310000000000e+003,"percent_desc_energia":15,"valor_kwh":0.69,"percentual_desconto_aplicado":4.473000000000000e+001,"edp_total_kwh":8904,"edp_dif_recebidos_x_contratado":-1.523500000000004e+002,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-02-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8.500000000000000e+003,"valorMensalidade":7.607330000000000e+003,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":2.840000000000000e+001,"edp_total_kwh":8132,"edp_dif_recebidos_x_contratado":-3.680000000000000e+002,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-03-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8.500000000000000e+003,"valorMensalidade":7.607330000000000e+003,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":2.840000000000000e+001,"edp_total_kwh":10676,"edp_dif_recebidos_x_contratado":2.176000000000000e+003,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-04-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":9.056350000000000e+003,"valorMensalidade":7.607330000000000e+003,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.280000000000000e+001,"edp_total_kwh":9452,"edp_dif_recebidos_x_contratado":3.956499999999996e+002,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-05-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8.500000000000000e+003,"valorMensalidade":7.607330000000000e+003,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":2.840000000000000e+001,"edp_total_kwh":8467,"edp_dif_recebidos_x_contratado":-3.300000000000000e+001,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-06-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8.500000000000000e+003,"valorMensalidade":7.607330000000000e+003,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":2.840000000000000e+001,"edp_total_kwh":6860,"edp_dif_recebidos_x_contratado":-1.640000000000000e+003,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-07-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8.500000000000000e+003,"valorMensalidade":7.607330000000000e+003,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":3.515000000000000e+001,"edp_total_kwh":7211,"edp_dif_recebidos_x_contratado":-1.289000000000000e+003,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-08-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8.500000000000000e+003,"valorMensalidade":7.607330000000000e+003,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":3.515000000000000e+001,"edp_total_kwh":7981,"edp_dif_recebidos_x_contratado":-5.190000000000000e+002,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-09-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8.500000000000000e+003,"valorMensalidade":7.607330000000000e+003,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":3.515000000000000e+001,"edp_total_kwh":8281,"edp_dif_recebidos_x_contratado":-2.190000000000000e+002,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-10-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8.500000000000000e+003,"valorMensalidade":7.607330000000000e+003,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":3.515000000000000e+001,"edp_total_kwh":7397,"edp_dif_recebidos_x_contratado":-1.103000000000000e+003,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-11-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8.500000000000000e+003,"valorMensalidade":8.276879999999999e+003,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":2.944000000000000e+001,"edp_total_kwh":6078,"edp_dif_recebidos_x_contratado":-2.422000000000000e+003,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-12-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8.500000000000000e+003,"valorMensalidade":8.286879999999999e+003,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":2.935000000000000e+001,"edp_total_kwh":8097,"edp_dif_recebidos_x_contratado":-4.030000000000000e+002,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-01-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":9.056350000000000e+003,"valorMensalidade":7.607330000000000e+003,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.731000000000000e+001,"edp_total_kwh":7588,"edp_dif_recebidos_x_contratado":-1.468350000000000e+003,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-02-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8.500000000000000e+003,"valorMensalidade":8.286879999999999e+003,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":2.724000000000000e+001,"edp_total_kwh":8809,"edp_dif_recebidos_x_contratado":3.090000000000000e+002,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-03-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8.500000000000000e+003,"valorMensalidade":8.286879999999999e+003,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":2.724000000000000e+001,"edp_total_kwh":9511,"edp_dif_recebidos_x_contratado":1.011000000000000e+003,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-04-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8.500000000000000e+003,"valorMensalidade":8.286879999999999e+003,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":2.724000000000000e+001,"edp_total_kwh":7387,"edp_dif_recebidos_x_contratado":-1.113000000000000e+003,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-05-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8.500000000000000e+003,"valorMensalidade":8.286879999999999e+003,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":2.724000000000000e+001,"edp_total_kwh":6634,"edp_dif_recebidos_x_contratado":-1.866000000000000e+003,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-06-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8.500000000000000e+003,"valorMensalidade":8.286879999999999e+003,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":2.724000000000000e+001,"edp_total_kwh":7115,"edp_dif_recebidos_x_contratado":-1.385000000000000e+003,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-07-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8.500000000000000e+003,"valorMensalidade":8.286879999999999e+003,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":2.724000000000000e+001,"edp_total_kwh":7404,"edp_dif_recebidos_x_contratado":-1.096000000000000e+003,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-08-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8.500000000000000e+003,"valorMensalidade":8.276879999999999e+003,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":2.733000000000000e+001,"edp_total_kwh":7883,"edp_dif_recebidos_x_contratado":-6.170000000000000e+002,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-09-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8.500000000000000e+003,"valorMensalidade":8.276879999999999e+003,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":2.733000000000000e+001,"edp_total_kwh":7347,"edp_dif_recebidos_x_contratado":-1.153000000000000e+003,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-10-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8.500000000000000e+003,"valorMensalidade":8.276879999999999e+003,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":2.733000000000000e+001,"edp_total_kwh":7375,"edp_dif_recebidos_x_contratado":-1.125000000000000e+003,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-12-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":4.723190000000000e+003,"valorMensalidade":4.863650000000000e+003,"percent_desc_energia":15,"valor_kwh":1.03,"percentual_desconto_aplicado":0.000000000000000e+000,"edp_total_kwh":4927,"edp_dif_recebidos_x_contratado":2.038100000000004e+002,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-01-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":4.723190000000000e+003,"valorMensalidade":4.863650000000000e+003,"percent_desc_energia":15,"valor_kwh":1.03,"percentual_desconto_aplicado":1.762000000000000e+001,"edp_total_kwh":4643,"edp_dif_recebidos_x_contratado":-8.018999999999960e+001,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-02-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":5.000000000000000e+002,"valorMensalidade":4.200000000000000e+002,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.280000000000000e+001,"edp_total_kwh":4241,"edp_dif_recebidos_x_contratado":3.741000000000000e+003,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-03-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":5.000000000000000e+002,"valorMensalidade":4.200000000000000e+002,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.280000000000000e+001,"edp_total_kwh":5567,"edp_dif_recebidos_x_contratado":5.067000000000000e+003,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-04-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":5.000000000000000e+002,"valorMensalidade":4.200000000000000e+002,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.280000000000000e+001,"edp_total_kwh":4929,"edp_dif_recebidos_x_contratado":4.429000000000000e+003,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-05-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":5.000000000000000e+002,"valorMensalidade":4.200000000000000e+002,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.280000000000000e+001,"edp_total_kwh":494,"edp_dif_recebidos_x_contratado":-6.000000000000000e+000,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-06-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":5.000000000000000e+002,"valorMensalidade":4.200000000000000e+002,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.280000000000000e+001,"edp_total_kwh":399,"edp_dif_recebidos_x_contratado":-1.010000000000000e+002,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-07-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":5.000000000000000e+002,"valorMensalidade":4.200000000000000e+002,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.913000000000000e+001,"edp_total_kwh":419,"edp_dif_recebidos_x_contratado":-8.100000000000000e+001,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-08-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":5.000000000000000e+002,"valorMensalidade":4.200000000000000e+002,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.913000000000000e+001,"edp_total_kwh":464,"edp_dif_recebidos_x_contratado":-3.600000000000000e+001,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-09-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":5.000000000000000e+002,"valorMensalidade":4.200000000000000e+002,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.913000000000000e+001,"edp_total_kwh":494,"edp_dif_recebidos_x_contratado":-6.000000000000000e+000,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-10-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":5.000000000000000e+002,"valorMensalidade":4.200000000000000e+002,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.913000000000000e+001,"edp_total_kwh":430,"edp_dif_recebidos_x_contratado":-7.000000000000000e+001,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-11-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":5.000000000000000e+002,"valorMensalidade":4.593800000000000e+002,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":3.342000000000000e+001,"edp_total_kwh":353,"edp_dif_recebidos_x_contratado":-1.470000000000000e+002,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-12-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":5.000000000000000e+002,"valorMensalidade":4.693800000000000e+002,"percent_desc_energia":15,"valor_kwh":0.94,"percentual_desconto_aplicado":3.197000000000000e+001,"edp_total_kwh":472,"edp_dif_recebidos_x_contratado":-2.800000000000000e+001,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-01-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":5.000000000000000e+002,"valorMensalidade":4.200000000000000e+002,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.731000000000000e+001,"edp_total_kwh":439,"edp_dif_recebidos_x_contratado":-6.100000000000000e+001,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-02-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":5.000000000000000e+002,"valorMensalidade":4.693800000000000e+002,"percent_desc_energia":15,"valor_kwh":0.94,"percentual_desconto_aplicado":2.994000000000000e+001,"edp_total_kwh":510,"edp_dif_recebidos_x_contratado":1.000000000000000e+001,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-03-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":5.000000000000000e+002,"valorMensalidade":4.693800000000000e+002,"percent_desc_energia":15,"valor_kwh":0.94,"percentual_desconto_aplicado":2.994000000000000e+001,"edp_total_kwh":553,"edp_dif_recebidos_x_contratado":5.300000000000000e+001,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-04-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":5.000000000000000e+002,"valorMensalidade":4.693800000000000e+002,"percent_desc_energia":15,"valor_kwh":0.94,"percentual_desconto_aplicado":2.994000000000000e+001,"edp_total_kwh":429,"edp_dif_recebidos_x_contratado":-7.100000000000000e+001,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-05-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":5.000000000000000e+002,"valorMensalidade":4.693800000000000e+002,"percent_desc_energia":15,"valor_kwh":0.94,"percentual_desconto_aplicado":2.994000000000000e+001,"edp_total_kwh":386,"edp_dif_recebidos_x_contratado":-1.140000000000000e+002,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-06-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":5.000000000000000e+002,"valorMensalidade":4.693800000000000e+002,"percent_desc_energia":15,"valor_kwh":0.94,"percentual_desconto_aplicado":2.994000000000000e+001,"edp_total_kwh":414,"edp_dif_recebidos_x_contratado":-8.600000000000000e+001,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-07-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":5.000000000000000e+002,"valorMensalidade":4.693800000000000e+002,"percent_desc_energia":15,"valor_kwh":0.94,"percentual_desconto_aplicado":2.994000000000000e+001,"edp_total_kwh":430,"edp_dif_recebidos_x_contratado":-7.000000000000000e+001,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-08-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":5.000000000000000e+002,"valorMensalidade":4.593800000000000e+002,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":3.144000000000000e+001,"edp_total_kwh":458,"edp_dif_recebidos_x_contratado":-4.200000000000000e+001,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-09-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":5.000000000000000e+002,"valorMensalidade":4.593800000000000e+002,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":3.144000000000000e+001,"edp_total_kwh":432,"edp_dif_recebidos_x_contratado":-6.800000000000000e+001,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-10-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":5.000000000000000e+002,"valorMensalidade":4.593800000000000e+002,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":3.144000000000000e+001,"edp_total_kwh":429,"edp_dif_recebidos_x_contratado":-7.100000000000000e+001,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-02-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7.300000000000000e+003,"valorMensalidade":6.720000000000000e+003,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":2.636000000000000e+001,"edp_total_kwh":10596,"edp_dif_recebidos_x_contratado":3.296000000000000e+003,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-03-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7.300000000000000e+003,"valorMensalidade":6.720000000000000e+003,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":2.636000000000000e+001,"edp_total_kwh":13910,"edp_dif_recebidos_x_contratado":6.610000000000000e+003,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-04-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":8.000000000000000e+003,"valorMensalidade":6.720000000000000e+003,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.280000000000000e+001,"edp_total_kwh":12315,"edp_dif_recebidos_x_contratado":4.315000000000000e+003,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-05-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7.300000000000000e+003,"valorMensalidade":6.720000000000000e+003,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":2.636000000000000e+001,"edp_total_kwh":7277,"edp_dif_recebidos_x_contratado":-2.300000000000000e+001,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-06-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7.300000000000000e+003,"valorMensalidade":6.720000000000000e+003,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":2.636000000000000e+001,"edp_total_kwh":5895,"edp_dif_recebidos_x_contratado":-1.405000000000000e+003,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.2500},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-07-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7.300000000000000e+003,"valorMensalidade":6.720000000000000e+003,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":3.329000000000000e+001,"edp_total_kwh":6197,"edp_dif_recebidos_x_contratado":-1.103000000000000e+003,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-08-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7.300000000000000e+003,"valorMensalidade":6.720000000000000e+003,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":3.329000000000000e+001,"edp_total_kwh":6858,"edp_dif_recebidos_x_contratado":-4.420000000000000e+002,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-09-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7.300000000000000e+003,"valorMensalidade":6.720000000000000e+003,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":3.329000000000000e+001,"edp_total_kwh":7122,"edp_dif_recebidos_x_contratado":-1.780000000000000e+002,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-10-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7.300000000000000e+003,"valorMensalidade":6.720000000000000e+003,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":3.329000000000000e+001,"edp_total_kwh":6356,"edp_dif_recebidos_x_contratado":-9.440000000000000e+002,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-11-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7.300000000000000e+003,"valorMensalidade":7.295020000000000e+003,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":2.759000000000000e+001,"edp_total_kwh":5222,"edp_dif_recebidos_x_contratado":-2.078000000000000e+003,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-12-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7.300000000000000e+003,"valorMensalidade":7.305020000000000e+003,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":2.749000000000000e+001,"edp_total_kwh":6959,"edp_dif_recebidos_x_contratado":-3.410000000000000e+002,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.3800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-01-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":8.000000000000000e+003,"valorMensalidade":6.720000000000000e+003,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":3.731000000000000e+001,"edp_total_kwh":6516,"edp_dif_recebidos_x_contratado":-1.484000000000000e+003,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-02-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7.300000000000000e+003,"valorMensalidade":7.305020000000000e+003,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":2.532000000000000e+001,"edp_total_kwh":7565,"edp_dif_recebidos_x_contratado":2.650000000000000e+002,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-03-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7.300000000000000e+003,"valorMensalidade":7.305020000000000e+003,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":2.532000000000000e+001,"edp_total_kwh":8169,"edp_dif_recebidos_x_contratado":8.690000000000000e+002,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-04-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7.300000000000000e+003,"valorMensalidade":7.305020000000000e+003,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":2.532000000000000e+001,"edp_total_kwh":6344,"edp_dif_recebidos_x_contratado":-9.560000000000000e+002,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-05-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7.300000000000000e+003,"valorMensalidade":7.305020000000000e+003,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":2.532000000000000e+001,"edp_total_kwh":5697,"edp_dif_recebidos_x_contratado":-1.603000000000000e+003,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-06-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7.300000000000000e+003,"valorMensalidade":7.305020000000000e+003,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":2.532000000000000e+001,"edp_total_kwh":6111,"edp_dif_recebidos_x_contratado":-1.189000000000000e+003,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-07-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7.300000000000000e+003,"valorMensalidade":7.305020000000000e+003,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":2.532000000000000e+001,"edp_total_kwh":6360,"edp_dif_recebidos_x_contratado":-9.400000000000000e+002,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-08-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7.300000000000000e+003,"valorMensalidade":7.295020000000000e+003,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":2.542000000000000e+001,"edp_total_kwh":6770,"edp_dif_recebidos_x_contratado":-5.300000000000000e+002,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-09-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7.300000000000000e+003,"valorMensalidade":7.295020000000000e+003,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":2.542000000000000e+001,"edp_total_kwh":9215,"edp_dif_recebidos_x_contratado":1.915000000000000e+003,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-11-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":5.000000000000000e+002,"valorMensalidade":4.593800000000000e+002,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":0.000000000000000e+000,"edp_total_kwh":5446,"edp_dif_recebidos_x_contratado":4.946000000000000e+003,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-11-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1.090000000000000e+003,"valorMensalidade":1.101900000000000e+003,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":0.000000000000000e+000,"edp_total_kwh":1400,"edp_dif_recebidos_x_contratado":3.100000000000000e+002,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-11-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3.780000000000000e+003,"valorMensalidade":3.809720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":0.000000000000000e+000,"edp_total_kwh":4824,"edp_dif_recebidos_x_contratado":1.044000000000000e+003,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-11-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2.076000000000000e+003,"valorMensalidade":2.076030000000000e+003,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":0.000000000000000e+000,"edp_total_kwh":2628,"edp_dif_recebidos_x_contratado":5.520000000000000e+002,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-10-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":1.066600000000000e+004,"valorMensalidade":1.055593000000000e+004,"percent_desc_energia":15,"valor_kwh":0.99,"percentual_desconto_aplicado":2.614000000000000e+001,"edp_total_kwh":9248,"edp_dif_recebidos_x_contratado":-1.418000000000000e+003,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.3400},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-11-01","instalacao":"158059","cpf_cnpj_beneficiario":"05404946660","nome_beneficiario":"LEONARDO MARTINS DE FREITAS","kWhDisponibilizadosMes":0.000000000000000e+000,"valorMensalidade":0.000000000000000e+000,"percent_desc_energia":15,"percentual_desconto_aplicado":0.000000000000000e+000,"edp_total_kwh":4115,"edp_dif_recebidos_x_contratado":4.115000000000000e+003,"id_tbl_plano_assinatura_benef":474,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-11-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8.500000000000000e+003,"valorMensalidade":8.276879999999999e+003,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":0.000000000000000e+000,"edp_total_kwh":10445,"edp_dif_recebidos_x_contratado":1.945000000000000e+003,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-11-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA D´AMPEZZO LTDA","kWhDisponibilizadosMes":2.050000000000000e+003,"valorMensalidade":2.133720000000000e+003,"percent_desc_energia":15,"valor_kwh":1.04,"percentual_desconto_aplicado":0.000000000000000e+000,"edp_total_kwh":2714,"edp_dif_recebidos_x_contratado":6.640000000000000e+002,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-11-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1.355000000000000e+003,"valorMensalidade":1.396210000000000e+003,"percent_desc_energia":15,"valor_kwh":1.03,"percentual_desconto_aplicado":0.000000000000000e+000,"edp_total_kwh":1763,"edp_dif_recebidos_x_contratado":4.080000000000000e+002,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-11-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6.495000000000000e+003,"valorMensalidade":6.574000000000000e+003,"percent_desc_energia":10,"valor_kwh":1.01,"percentual_desconto_aplicado":0.000000000000000e+000,"edp_total_kwh":8317,"edp_dif_recebidos_x_contratado":1.822000000000000e+003,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":0.8900}],"geral_usina":[{"numero_instalacao_geradora":161073905,"mes_ano":"2024-02","ano":2024,"total_kwh_gerado":"134.641"},{"numero_instalacao_geradora":161073905,"mes_ano":"2024-01","ano":2024,"total_kwh_gerado":"147.427"},{"numero_instalacao_geradora":161073905,"mes_ano":"2023-12","ano":2023,"total_kwh_gerado":"157.217"},{"numero_instalacao_geradora":161073905,"mes_ano":"2023-11","ano":2023,"total_kwh_gerado":"172.636"},{"numero_instalacao_geradora":161073905,"mes_ano":"2023-10","ano":2023,"total_kwh_gerado":"146.973"},{"numero_instalacao_geradora":161073905,"mes_ano":"2023-09","ano":2023,"total_kwh_gerado":"134.152"},{"numero_instalacao_geradora":161073905,"mes_ano":"2023-08","ano":2023,"total_kwh_gerado":"138.464"},{"numero_instalacao_geradora":161073905,"mes_ano":"2023-07","ano":2023,"total_kwh_gerado":"133.082"},{"numero_instalacao_geradora":161073905,"mes_ano":"2023-06","ano":2023,"total_kwh_gerado":"225.136"},{"numero_instalacao_geradora":161073905,"mes_ano":"2024-03","ano":2024,"total_kwh_gerado":"176.758"},{"numero_instalacao_geradora":161073905,"mes_ano":"2024-04","ano":2024,"total_kwh_gerado":"157.593"},{"numero_instalacao_geradora":161073905,"mes_ano":"2024-05","ano":2024,"total_kwh_gerado":"155.650"},{"numero_instalacao_geradora":161073905,"mes_ano":"2024-06","ano":2024,"total_kwh_gerado":" 129.830"},{"numero_instalacao_geradora":161073905,"mes_ano":"2024-07","ano":2024,"total_kwh_gerado":"136.462"},{"numero_instalacao_geradora":161073905,"mes_ano":"2024-08","ano":2024,"total_kwh_gerado":"150.823"},{"numero_instalacao_geradora":161073905,"mes_ano":"2024-09","ano":2024,"total_kwh_gerado":"155.550"},{"numero_instalacao_geradora":161073905,"mes_ano":"2024-10","ano":2024,"total_kwh_gerado":"139.826"},{"numero_instalacao_geradora":161073905,"mes_ano":"2024-11","ano":2024,"total_kwh_gerado":"114.967,6500"},{"numero_instalacao_geradora":161073905,"mes_ano":"2024-12","ano":2024,"total_kwh_gerado":"148.730,4000"},{"numero_instalacao_geradora":161073905,"mes_ano":"2025-01","ano":2025,"total_kwh_gerado":"138.415,2000"},{"numero_instalacao_geradora":161073905,"mes_ano":"2025-02","ano":2025,"total_kwh_gerado":"160.540,8000"},{"numero_instalacao_geradora":161073905,"mes_ano":"2025-03","ano":2025,"total_kwh_gerado":"168.792,7500"},{"numero_instalacao_geradora":161073905,"mes_ano":"2025-04","ano":2025,"total_kwh_gerado":"131.381,2500"},{"numero_instalacao_geradora":161073905,"mes_ano":"2025-05","ano":2025,"total_kwh_gerado":"118.170,1500"},{"numero_instalacao_geradora":161073905,"mes_ano":"2025-06","ano":2025,"total_kwh_gerado":"126.649,95"},{"numero_instalacao_geradora":161073905,"mes_ano":"2025-07","ano":2025,"total_kwh_gerado":"131.640,6000"},{"numero_instalacao_geradora":161073905,"mes_ano":"2025-08","ano":2025,"total_kwh_gerado":"140.094,150"},{"numero_instalacao_geradora":161073905,"mes_ano":"2025-09","ano":2025,"total_kwh_gerado":"128.093,7000"},{"numero_instalacao_geradora":161073905,"mes_ano":"2025-10","ano":2025,"total_kwh_gerado":" 131.033,7000"}]}

  </script>

  <script>
    // ============================================
    // FUN��O DE NORMALIZA��O DE VALORES
    // ============================================
    // Normaliza valores num�ricos: converte nota��o cient�fica e v�rgulas para pontos
    function normalizeValue(value) {
      if (value === null || value === undefined) return value;
      if (typeof value === 'number') return value;
      if (typeof value !== 'string') return value;
      
      // Remove espa�os
      let str = value.trim();
      
      // Se estiver vazio, retorna null
      if (str === '') return null;
      
      // Substitui v�rgulas por pontos
      str = str.replace(',', '.');
      
      // Remove pontos extras (mant�m apenas um ponto decimal)
      const parts = str.split('.');
      if (parts.length > 2) {
        str = parts[0] + '.' + parts.slice(1).join('');
      }
      
      // Tenta converter nota��o cient�fica
      if (/[eE]/.test(str)) {
        const num = parseFloat(str);
        return isNaN(num) ? value : num;
      }
      
      // Tenta converter para n�mero
      const num = parseFloat(str);
      return isNaN(num) ? value : num;
    }

    // Normaliza recursivamente todos os valores num�ricos em um objeto/array
    function normalizeData(data) {
      if (Array.isArray(data)) {
        return data.map(item => normalizeData(item));
      } else if (data !== null && typeof data === 'object') {
        const normalized = {};
        for (const key in data) {
          if (data.hasOwnProperty(key)) {
            const value = data[key];
            // Campos num�ricos conhecidos
            const numericFields = [
              'kWhDisponibilizadosMes', 'valorMensalidade', 'percent_desc_energia', 
              'valor_kwh', 'percentual_desconto_aplicado', 'edp_total_kwh', 
              'edp_dif_recebidos_x_contratado', 'valor_kwh_edp', 'ano',
              'numero_instalacao_geradora'
            ];
            
            // total_kwh_gerado não deve ser normalizado aqui, será tratado por normalizeKwhValue
            if (key === 'total_kwh_gerado') {
              normalized[key] = value; // Mantém como string para normalizeKwhValue processar
            } else if (numericFields.includes(key) || typeof value === 'string' && /^-?\d+([.,]\d+)?([eE][+-]?\d+)?$/.test(value.trim().replace(',', '.'))) {
              normalized[key] = normalizeValue(value);
            } else if (typeof value === 'object') {
              normalized[key] = normalizeData(value);
            } else {
              normalized[key] = value;
            }
          }
        }
        return normalized;
      }
      return data;
    }

    // ============================================
    // FUN��O DE CARREGAMENTO DE DADOS
    // ============================================
    // Para carregar de um endpoint no futuro, substitua esta fun��o por:
    // async function loadDashboardData() {
    //   const response = await fetch('https://seu-endpoint.com/api/dados');
    //   const json = await response.json();
    //   return normalizeData(json.detalhamento_beneficiarios || []);
    // }
    // ============================================
    function loadDashboardData() {
      try {
        const dataElement = document.getElementById('dashboard-data');
        if (dataElement && dataElement.textContent.trim()) {
          const jsonData = JSON.parse(dataElement.textContent);
          const beneficiarios = jsonData.detalhamento_beneficiarios || [];
          return normalizeData(beneficiarios);
        }
      } catch (e) {
        console.error('Erro ao carregar dados do elemento JSON:', e);
      }
      // Fallback: dados embutidos (ser� removido quando usar endpoint)
      return normalizeData([]);
    }

    // Função de inicialização do dashboard
    function initDashboard() {
      // Carrega os dados (atualmente embutidos, mas pode ser facilmente substituÃ­do por fetch)
      let rawData = loadDashboardData();
      
      if (!rawData || rawData.length === 0) {
        console.error('Nenhum dado foi carregado! Verifique o elemento dashboard-data.');
        return;
      }

    const filtersForm = document.getElementById('filters');
    const diffCard = document.getElementById('diffCard');
    const diffValue = document.getElementById('diffValue');
    const tableBody = document.getElementById('tableBody');
    const emptyState = document.getElementById('emptyState');
    const insightsGrid = document.getElementById('insightsGrid');
    const yearSummaryCard = document.getElementById('yearSummaryCard');
    const yearContratado = document.getElementById('yearContratado');
    const yearRecebido = document.getElementById('yearRecebido');
    const yearDiferenca = document.getElementById('yearDiferenca');
    const yearDiferencaDetail = document.getElementById('yearDiferencaDetail');
    const yearPercentual = document.getElementById('yearPercentual');
    const diffDetailContainer = document.getElementById('diffDetailContainer');
    const diffDetailBody = document.getElementById('diffDetailBody');

    const selectElements = {
      parceiro: document.getElementById('parceiroFilter'),
      ano: { container: document.getElementById('anoFilterContainer'), list: document.getElementById('anoFilterList'), all: document.getElementById('anoFilterAll') },
      mes: { container: document.getElementById('mesFilterContainer'), list: document.getElementById('mesFilterList'), all: document.getElementById('mesFilterAll') },
      instalacao: { container: document.getElementById('instalacaoFilterContainer'), list: document.getElementById('instalacaoFilterList'), all: document.getElementById('instalacaoFilterAll') },
      beneficiario: document.getElementById('benefFilter')
    };

    // Sets para armazenar valores selecionados
    const selectedFilters = {
      ano: new Set(),
      mes: new Set(),
      instalacao: new Set()
    };

    const monthFormatter = new Intl.DateTimeFormat('pt-BR', { month: 'short', year: 'numeric' });
    const currencyFormatter = new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL', maximumFractionDigits: 0 });
    const numberFormatter = new Intl.NumberFormat('pt-BR', { maximumFractionDigits: 0 });
    
    // Formatador específico para kWh que trata milhares e milhões corretamente
    function formatKwh(value) {
      if (!value || value === 0) return '0 kWh';
      const num = Math.round(value);
      
      // Se o valor for maior ou igual a 1 milhão, mostra em milhões
      if (num >= 1000000) {
        const milhoes = (num / 1000000);
        // Formata com 1 casa decimal, removendo zeros à direita
        let milhoesFormatado = milhoes.toFixed(1);
        // Remove zeros à direita e ponto se não houver decimais
        milhoesFormatado = milhoesFormatado.replace(/\.?0+$/, '');
        // Converte ponto para vírgula
        milhoesFormatado = milhoesFormatado.replace('.', ',');
        // Usa "milhão" no singular ou "milhões" no plural
        const plural = milhoes >= 2 ? 'milhões' : 'milhão';
        return `${milhoesFormatado} ${plural} kWh`;
      }
      
      // Se o valor for maior ou igual a 1 mil, mostra em milhares
      if (num >= 1000) {
        const milhares = (num / 1000);
        // Formata sem casas decimais se for inteiro, senão com até 1 casa decimal
        let milharesFormatado;
        if (milhares % 1 === 0) {
          milharesFormatado = milhares.toFixed(0);
        } else {
          milharesFormatado = milhares.toFixed(1).replace(/\.?0+$/, '');
        }
        // Converte ponto para vírgula se necessário
        milharesFormatado = milharesFormatado.replace('.', ',');
        return `${milharesFormatado} mil kWh`;
      }
      
      // Valores menores que 1000, mostra direto
      return `${num} kWh`;
    }
    const currencyPerKwhFormatter = new Intl.NumberFormat('pt-BR', {
      style: 'currency',
      currency: 'BRL',
      minimumFractionDigits: 2,
      maximumFractionDigits: 2
    });

    let beneficiariosList = [];
    let selectedBeneficiarios = new Set();
    let benefProfiles = [];

    function populateFilters(data) {
      const sets = {
        parceiro: new Set(),
        ano: new Set(),
        mes: new Set(),
        instalacao: new Set(),
        beneficiario: new Set()
      };

      data.forEach(item => {
        if (item.parceiro) sets.parceiro.add(item.parceiro);
        sets.ano.add(item.ano);
        sets.mes.add(item.mes_ano);
        sets.instalacao.add(item.instalacao);
        sets.beneficiario.add(item.nome_beneficiario);
      });

      const sortedMes = Array.from(sets.mes).sort();
      const parceiros = Array.from(sets.parceiro).sort();

      populateSelect(selectElements.parceiro, parceiros);
      
      // Se houver apenas 1 parceiro, seleciona automaticamente
      if (parceiros.length === 1) {
        selectElements.parceiro.value = parceiros[0];
        // Dispara o evento change para atualizar o dashboard
        setTimeout(() => {
          selectElements.parceiro.dispatchEvent(new Event('change', { bubbles: true }));
        }, 0);
      }

      populateCheckboxFilter('ano', sets.ano);
      populateCheckboxFilter('mes', sets.mes, formatMesLabel);
      populateCheckboxFilter('instalacao', sets.instalacao);

      const selectedYears = getSelectedYears();
      // Só popula beneficiários se houver instalações selecionadas
      if (selectedFilters.instalacao.size > 0) {
        const selectedInstalacoes = selectedFilters.instalacao;
        benefProfiles = buildBeneficiaryProfiles(data, selectedYears, selectedInstalacoes);
        populateBenefCheckboxes(benefProfiles);
      } else {
        // Se não houver instalações selecionadas, limpa a lista de beneficiários
        const benefFilterContainer = selectElements.beneficiario;
        if (benefFilterContainer) {
          benefFilterContainer.innerHTML = '<p style="text-align: center; color: var(--muted); padding: 20px;">Selecione pelo menos uma instalação para ver os beneficiários.</p>';
        }
        selectedBeneficiarios = new Set();
        benefProfiles = [];
      }
      
      const instalacoesIndicator = document.getElementById('instalacoesIndicator');
      if (instalacoesIndicator) {
        instalacoesIndicator.textContent = `Instalações monitoradas: ${sets.instalacao.size}`;
      }
    }

    function populateSelect(select, values, formatFn, defaultLabel = 'Todos') {
      const defaultOption = document.createElement('option');
      defaultOption.value = '';
      defaultOption.textContent = defaultLabel;
      select.innerHTML = '';
      select.appendChild(defaultOption);
      values.forEach(value => {
        const option = document.createElement('option');
        option.value = value;
        option.textContent = formatFn ? formatFn(value) : value;
        select.appendChild(option);
      });
    }

    function populateCheckboxFilter(filterKey, values, formatFn) {
      const filter = selectElements[filterKey];
      if (!filter || !filter.list) return;
      
      filter.list.innerHTML = '';
      // Converte todos os valores para string e ordena
      const allValues = Array.from(values).map(v => String(v)).sort();
      
      // Limpa o Set para este filtro antes de popular
      selectedFilters[filterKey].clear();
      
      // Para mês e instalação, marca todos inicialmente
      const shouldStartChecked = ['mes', 'instalacao'].includes(filterKey);
      
      // Remove event listeners anteriores para evitar duplicação
      const newAllCheckbox = filter.all.cloneNode(true);
      filter.all.parentNode.replaceChild(newAllCheckbox, filter.all);
      selectElements[filterKey].all = newAllCheckbox;
      
      // Handler para "Selecionar todos"
      newAllCheckbox.addEventListener('change', function() {
        const checkboxes = filter.list.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach(cb => {
          cb.checked = this.checked;
          if (this.checked) {
            selectedFilters[filterKey].add(cb.value);
          } else {
            selectedFilters[filterKey].delete(cb.value);
          }
        });
        
        // Se for o filtro de instalação, atualiza a lista de beneficiários
        if (filterKey === 'instalacao') {
          updateBeneficiariosList();
        }
        
        refreshDashboard();
      });
      
      // Cria checkboxes para cada valor
      allValues.forEach(value => {
        const item = document.createElement('div');
        item.className = 'checkbox-filter-item';
        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        // value já é string (convertido na linha 1498)
        checkbox.value = value;
        checkbox.id = `${filterKey}_${value}`;
        checkbox.dataset.filter = filterKey;
        
        // Marca inicialmente se for mês ou instalação
        if (shouldStartChecked) {
          checkbox.checked = true;
          // Usa o mesmo valor do checkbox para garantir consistência
          selectedFilters[filterKey].add(value);
          console.log(`Inicialização ${filterKey}: Adicionado valor`, value, 'Set agora:', Array.from(selectedFilters[filterKey]));
        }
        
        checkbox.addEventListener('change', function() {
          // Usa o valor do checkbox (já é string) para garantir consistência
          const val = this.value;
          console.log(`Checkbox ${filterKey} mudou:`, {
            valor: val,
            checked: this.checked,
            tipo: typeof val
          });
          if (this.checked) {
            selectedFilters[filterKey].add(val);
            console.log(`Adicionado ao Set ${filterKey}:`, Array.from(selectedFilters[filterKey]));
          } else {
            selectedFilters[filterKey].delete(val);
            console.log(`Removido do Set ${filterKey}:`, Array.from(selectedFilters[filterKey]));
            newAllCheckbox.checked = false;
          }
          // Atualiza o estado de "Selecionar todos"
          const allChecked = filter.list.querySelectorAll('input[type="checkbox"]:checked').length === allValues.length;
          newAllCheckbox.checked = allChecked;
          
          // Se for o filtro de instalação, atualiza a lista de beneficiários
          if (filterKey === 'instalacao') {
            updateBeneficiariosList();
          }
          
          refreshDashboard();
        });
        
        const label = document.createElement('label');
        label.htmlFor = checkbox.id;
        label.textContent = formatFn ? formatFn(value) : value;
        
        item.appendChild(checkbox);
        item.appendChild(label);
        filter.list.appendChild(item);
      });
      
      // Marca o checkbox "Selecionar todos" se todos estiverem marcados
      if (shouldStartChecked) {
        newAllCheckbox.checked = true;
        console.log(`Inicialização ${filterKey} completa:`, {
          totalValores: allValues.length,
          valoresNoSet: selectedFilters[filterKey].size,
          valores: Array.from(selectedFilters[filterKey])
        });
      } else if (filterKey === 'ano') {
        // Para o filtro de ano, não marca todos inicialmente (será feito depois)
        console.log(`Inicialização ${filterKey} (será preenchido depois):`, {
          totalValores: allValues.length,
          valoresNoSet: selectedFilters[filterKey].size
        });
      }
    }

    function getSelectedYears() {
      // Se nenhum ano foi selecionado, retorna todos os anos dispon�veis nos dados
      if (selectedFilters.ano.size === 0) {
        return [];
      }
      // Retorna os anos selecionados
      return Array.from(selectedFilters.ano).map(y => parseInt(y)).sort();
    }

    function formatYearIndicator(years) {
      if (years.length === 0) return new Date().getFullYear();
      if (years.length === 1) return years[0];
      // Se m�ltiplos anos, mostra todos separados por v�rgula
      return years.join(', ');
    }

    function getMonthlyDataForYear(registros, year) {
      const registrosAno = registros.filter(item => {
        const itemYear = new Date(`${item.mes_ano}T00:00:00`).getFullYear();
        return itemYear === year;
      }).sort((a, b) => {
        const dateA = new Date(`${a.mes_ano}T00:00:00`);
        const dateB = new Date(`${b.mes_ano}T00:00:00`);
        return dateA - dateB;
      });
      
      return {
        meses: registrosAno.map(item => {
          const date = new Date(`${item.mes_ano}T00:00:00`);
          const mesesAbrev = ['jan', 'fev', 'mar', 'abr', 'mai', 'jun', 'jul', 'ago', 'set', 'out', 'nov', 'dez'];
          return mesesAbrev[date.getMonth()];
        }),
        contratado: registrosAno.map(item => item.kWhDisponibilizadosMes || 0),
        recebido: registrosAno.map(item => item.edp_total_kwh || 0),
        valorPago: registrosAno.map(item => item.valorMensalidade || 0)
      };
    }

    function buildBeneficiaryProfiles(data, selectedYears, selectedInstalacoes = null) {
      const map = new Map();
      const anoAtual = new Date().getFullYear();
      
      // Se há instalações selecionadas, filtra os dados primeiro
      const dataToProcess = selectedInstalacoes && selectedInstalacoes.size > 0
        ? data.filter(item => {
            const itemInstalacao = String(item.instalacao || '');
            return selectedInstalacoes.has(itemInstalacao);
          })
        : data;
      
      // Agrupa por beneficiário e encontra o último mês de cada um
      dataToProcess.forEach(item => {
        if (!map.has(item.nome_beneficiario)) {
          map.set(item.nome_beneficiario, {
            nome: item.nome_beneficiario,
            instalacoes: new Set(),
            registros: []
          });
        }
        const profile = map.get(item.nome_beneficiario);
        profile.instalacoes.add(item.instalacao);
        profile.registros.push(item);
      });
      
      return Array.from(map.values()).map(profile => {
        // Ordena registros por data (mais recente primeiro)
        const registrosOrdenados = profile.registros.sort((a, b) => {
          const dateA = new Date(`${a.mes_ano}T00:00:00`);
          const dateB = new Date(`${b.mes_ano}T00:00:00`);
          return dateB - dateA;
        });
        
        // Pega o registro do último mês
        const ultimoRegistro = registrosOrdenados[0];
        
        // Calcula valores do ano atual (2025)
        const registrosAnoAtual = profile.registros.filter(item => {
          const itemYear = new Date(`${item.mes_ano}T00:00:00`).getFullYear();
          return itemYear === anoAtual;
        });
        
        const somaMensalidadeAno = registrosAnoAtual.reduce((sum, item) => sum + (item.valorMensalidade || 0), 0);
        const somaKwhContratadoAno = registrosAnoAtual.reduce((sum, item) => sum + (item.kWhDisponibilizadosMes || 0), 0);
        const valorMedioKwhAno = somaKwhContratadoAno > 0 ? somaMensalidadeAno / somaKwhContratadoAno : 0;
        const somaValorKwhEdpAno = registrosAnoAtual.reduce((sum, item) => sum + (item.valor_kwh_edp || 0), 0);
        const mediaKwhEdpAno = registrosAnoAtual.length > 0 ? somaValorKwhEdpAno / registrosAnoAtual.length : 0;
        const somaKwhRecebidoAno = registrosAnoAtual.reduce((sum, item) => sum + (item.edp_total_kwh || 0), 0);
        const diferencaKwhAno = somaKwhRecebidoAno - somaKwhContratadoAno;
        const percentualDiferencaAno = somaKwhContratadoAno > 0 ? ((diferencaKwhAno / somaKwhContratadoAno) * 100) : 0;
        // M�dia do percentual_desconto_aplicado para o ano atual
        const somaPercentualAplicadoAno = registrosAnoAtual.reduce((sum, item) => sum + (item.percentual_desconto_aplicado || 0), 0);
        const mediaPercentualAplicadoAno = registrosAnoAtual.length > 0 ? somaPercentualAplicadoAno / registrosAnoAtual.length : 0;
        
        // Calcula valores por ano para os outros anos selecionados
        const anosComDados = {};
        selectedYears.forEach(year => {
          if (year !== anoAtual) {
            const registrosAno = profile.registros.filter(item => {
              const itemYear = new Date(`${item.mes_ano}T00:00:00`).getFullYear();
              return itemYear === year;
            });
            
            if (registrosAno.length > 0) {
              const somaMensalidade = registrosAno.reduce((sum, item) => sum + (item.valorMensalidade || 0), 0);
              const somaKwhContratado = registrosAno.reduce((sum, item) => sum + (item.kWhDisponibilizadosMes || 0), 0);
              const valorMedioKwh = somaKwhContratado > 0 ? somaMensalidade / somaKwhContratado : 0;
              const somaValorKwhEdp = registrosAno.reduce((sum, item) => sum + (item.valor_kwh_edp || 0), 0);
              const mediaKwhEdp = registrosAno.length > 0 ? somaValorKwhEdp / registrosAno.length : 0;
              const somaKwhRecebido = registrosAno.reduce((sum, item) => sum + (item.edp_total_kwh || 0), 0);
              const diferencaKwh = somaKwhRecebido - somaKwhContratado;
              const percentualDiferenca = somaKwhContratado > 0 ? ((diferencaKwh / somaKwhContratado) * 100) : 0;
              // M�dia do percentual_desconto_aplicado para o ano
              const somaPercentualAplicado = registrosAno.reduce((sum, item) => sum + (item.percentual_desconto_aplicado || 0), 0);
              const mediaPercentualAplicado = registrosAno.length > 0 ? somaPercentualAplicado / registrosAno.length : 0;
              
              anosComDados[year] = {
                somaMensalidade,
                somaKwhContratado,
                valorMedioKwh,
                mediaKwhEdp,
                somaKwhRecebido,
                diferencaKwh,
                percentualDiferenca,
                mediaPercentualAplicado
              };
            }
          }
        });
        
        return {
          nome: profile.nome,
          instalacoes: Array.from(profile.instalacoes).sort(),
          mensalidadeDistinct: ultimoRegistro?.valorMensalidade || 0,
          contratadoDistinct: ultimoRegistro?.kWhDisponibilizadosMes || 0,
          valorUnitario: ultimoRegistro?.valor_kwh || 0,
          valorKwhEdp: ultimoRegistro?.valor_kwh_edp || 0,
          percentDescEnergia: ultimoRegistro?.percent_desc_energia || 0,
          percentualDescontoAplicado: ultimoRegistro?.percentual_desconto_aplicado || 0,
          // Valores do ano atual (2025)
          somaMensalidadeAno,
          somaKwhContratadoAno,
          valorMedioKwhAno,
          mediaKwhEdpAno,
          somaKwhRecebidoAno,
          diferencaKwhAno,
          percentualDiferencaAno,
          mediaPercentualAplicadoAno,
          // Dados por ano para outros anos selecionados
          anosComDados: anosComDados,
          selectedYears: selectedYears,
          // Mant�m os registros para gerar gr�ficos
          registros: profile.registros
        };
      }).sort((a, b) => profileSort(a.nome, b.nome));
    }

    function profileSort(a, b) {
      return a.localeCompare(b, 'pt-BR', { sensitivity: 'base' });
    }

    function formatInstalacoes(instalacoes) {
      if (!instalacoes.length) return 'Sem instalação registrada';
      if (instalacoes.length === 1) return `Instalação ${instalacoes[0]}`;
      const preview = instalacoes.slice(0, 2).join(', ');
      const remaining = instalacoes.length - 2;
      return `Instalações ${preview}${remaining > 0 ? ` +${remaining}` : ''}`;
    }

    function updateBeneficiariosList() {
      // Atualiza a lista de beneficiários baseado nas instalações selecionadas
      // Se não houver instalações selecionadas, limpa a lista de beneficiários
      if (selectedFilters.instalacao.size === 0) {
        // Limpa a lista de beneficiários se não houver instalações selecionadas
        const benefFilterContainer = selectElements.beneficiario;
        if (benefFilterContainer) {
          benefFilterContainer.innerHTML = '<p style="text-align: center; color: var(--muted); padding: 20px;">Selecione pelo menos uma instalação para ver os beneficiários.</p>';
        }
        selectedBeneficiarios = new Set();
        benefProfiles = [];
        return;
      }
      
      const selectedYears = getSelectedYears();
      const selectedInstalacoes = selectedFilters.instalacao;
      benefProfiles = buildBeneficiaryProfiles(rawData, selectedYears, selectedInstalacoes);
      populateBenefCheckboxes(benefProfiles);
    }

    function populateBenefCheckboxes(profiles) {
      beneficiariosList = profiles.map(profile => profile.nome);
      selectedBeneficiarios = new Set();
      const benefFilterContainer = selectElements.beneficiario;
      benefFilterContainer.innerHTML = '';

      const allLabel = document.createElement('label');
      allLabel.className = 'checkbox-item checkbox-all';
      allLabel.style.cursor = 'pointer';
      const allInput = document.createElement('input');
      allInput.type = 'checkbox';
      allInput.id = 'benef-all';
      allInput.checked = false;
      allInput.style.pointerEvents = 'auto';
      allInput.style.cursor = 'pointer';
      allInput.addEventListener('change', (e) => {
        e.stopPropagation();
        const checked = allInput.checked;
        toggleBenefCheckboxes(checked);
        selectedBeneficiarios = checked ? new Set(beneficiariosList) : new Set();
        // N�o atualiza o dashboard automaticamente - aguarda o bot�o "Aplicar Filtros"
      });
      allLabel.addEventListener('mousedown', (e) => {
        if (e.target === allInput) return;
        e.preventDefault();
        e.stopPropagation();
        setTimeout(() => {
          allInput.checked = !allInput.checked;
          allInput.dispatchEvent(new Event('change', { bubbles: true }));
        }, 0);
      });
      
      allLabel.addEventListener('click', (e) => {
        if (e.target === allInput) return;
        e.preventDefault();
        e.stopPropagation();
        allInput.checked = !allInput.checked;
        allInput.dispatchEvent(new Event('change', { bubbles: true }));
      });
      const allMeta = document.createElement('div');
      allMeta.className = 'checkbox-meta';
      allMeta.style.pointerEvents = 'none';
      allMeta.innerHTML = `
        <div class="benef-primary">
          <strong>Todos os beneficiários</strong>
          <span>Visão geral</span>
        </div>
        <div class="benef-metrics">
          <span>Selecione para limpar filtros individuais</span>
        </div>
      `;
      allLabel.appendChild(allInput);
      allLabel.appendChild(allMeta);
      benefFilterContainer.appendChild(allLabel);

      profiles.forEach(profile => {
        const label = document.createElement('label');
        label.className = 'checkbox-item';
        label.style.cursor = 'pointer';
        label.style.position = 'relative';
        const input = document.createElement('input');
        input.type = 'checkbox';
        input.value = profile.nome;
        input.dataset.role = 'benef-option';
        input.checked = false;
        input.style.pointerEvents = 'auto';
        input.style.cursor = 'pointer';
        input.style.position = 'relative';
        input.style.zIndex = '10';
        
        // Event listener no input - atualiza o Set quando o checkbox muda
        input.addEventListener('change', (e) => {
          // Atualiza o Set de benefici�rios selecionados, mas n�o atualiza o dashboard
          if (input.checked) {
            selectedBeneficiarios.add(profile.nome);
          } else {
            selectedBeneficiarios.delete(profile.nome);
          }
          // Atualiza o estado do checkbox "Todos"
          setTimeout(() => updateAllCheckboxState(), 0);
        });
        
        // Event listener no label - para cliques em outras �reas (n�o no checkbox)
        label.addEventListener('click', (e) => {
          // Se o clique foi diretamente no input, deixa o comportamento padr�o funcionar
          if (e.target === input || e.target.closest('input[type="checkbox"]')) {
            return;
          }
          
          // Se o clique foi em um elemento interativo (como canvas, bot�o, etc), n�o faz nada
          if (e.target.closest('canvas, button, a, input, select, textarea')) {
            return;
          }
          
          // Verifica se h� texto selecionado - se sim, n�o alterna
          const selection = window.getSelection();
          if (selection && selection.toString().length > 0) {
            return;
          }
          
          // Para qualquer outro clique no label, alterna o checkbox
          e.preventDefault();
          e.stopPropagation();
          // Alterna o estado do checkbox
          input.checked = !input.checked;
          // Dispara o evento change para atualizar o Set
          input.dispatchEvent(new Event('change', { bubbles: true }));
        });
        
        const meta = document.createElement('div');
        meta.className = 'checkbox-meta';
        meta.innerHTML = `
          <div class="benef-primary">
            <strong>${profile.nome}</strong>
            <span>${formatInstalacoes(profile.instalacoes)}</span>
          </div>
          <div class="benef-metrics">
            ${(() => {
              const anoAtual = new Date().getFullYear();
              const selectedYears = profile.selectedYears || [];
              
              // Se nenhum ano foi selecionado, não mostra nada
              if (selectedYears.length === 0) {
                return '';
              }
              
              // Constrói a lista de anos: ano atual + outros anos selecionados
              const todosAnos = [];
              if (selectedYears.includes(anoAtual)) {
                todosAnos.push(anoAtual);
              }
              const outrosAnos = Object.keys(profile.anosComDados || {}).map(y => parseInt(y)).filter(y => selectedYears.includes(y)).sort((a, b) => b - a);
              todosAnos.push(...outrosAnos);
              
              return todosAnos.map(year => {
                let dadosAno;
                if (year === anoAtual) {
                  dadosAno = {
                    somaMensalidade: profile.somaMensalidadeAno,
                    somaKwhContratado: profile.somaKwhContratadoAno,
                    valorMedioKwh: profile.valorMedioKwhAno,
                    mediaKwhEdp: profile.mediaKwhEdpAno,
                    somaKwhRecebido: profile.somaKwhRecebidoAno,
                    diferencaKwh: profile.diferencaKwhAno,
                    percentualDiferenca: profile.percentualDiferencaAno,
                    mediaPercentualAplicado: profile.mediaPercentualAplicadoAno || 0
                  };
                } else {
                  dadosAno = profile.anosComDados[year];
                }
                
                if (!dadosAno) return '';
                
                // Calcula diferen�a entre M�dia kWh EDP e Valor M�dio kWh
                const diferencaKwhEdp = (dadosAno.mediaKwhEdp || 0) - (dadosAno.valorMedioKwh || 0);
                const percentualDiferencaKwhEdp = (dadosAno.valorMedioKwh || 0) > 0 
                  ? (diferencaKwhEdp / (dadosAno.valorMedioKwh || 1)) * 100 
                  : 0;
                
                // Calcula diferen�a entre kWh recebido e kWh do plano
                const diferencaKwhRecebido = (dadosAno.somaKwhRecebido || 0) - (dadosAno.somaKwhContratado || 0);
                
                return `
            <div class="benef-meta-row">
              <div class="benef-meta-content">
                ${year === anoAtual ? `
                <div class="benef-atualmente-container">
                  <div class="benef-atualmente-title">Atualmente</div>
                  <div class="benef-atualmente-boxes">
                    <div class="benef-box" style="flex: 1;">
                      <div class="benef-box-title">Plano de assinatura</div>
                      <div class="benef-box-item">
                        <span>Mensalidade:</span>
                        <strong>${currencyFormatter.format(profile.mensalidadeDistinct)}</strong>
                      </div>
                      <div class="benef-box-item">
                        <span>% Desc. Energia:</span>
                        <strong>15%</strong>
                      </div>
                      <div class="benef-box-item">
                        <span>% Participação Usina:</span>
                        <strong>${((profile.contratadoDistinct || 0) / 150000 * 100).toFixed(2)}%</strong>
                      </div>
                    </div>
                  </div>
                </div>
                ` : ''}
                <div class="benef-year-data-container">
                  <div class="benef-year-data-left">
                    <div class="benef-box">
                      <div class="benef-box-title">Valor Médio Total ${year}</div>
                      <div class="benef-box-item" style="display: none;">
                        <span>Soma Mensalidade:</span>
                        <strong>${currencyFormatter.format(dadosAno.somaMensalidade || 0)}</strong>
                      </div>
                      <div class="benef-box-item">
                        <span>Soma kWh Recebido:</span>
                        <strong>${numberFormatter.format(dadosAno.somaKwhRecebido || 0)}</strong>
                      </div>
                    </div>
                    ${diferencaKwhRecebido > 0 ? `
                    <div style="margin-top: 16px; padding: 20px; background: linear-gradient(135deg, rgba(34, 197, 94, 0.15) 0%, rgba(34, 197, 94, 0.08) 100%); border: 2px solid rgba(34, 197, 94, 0.4); border-radius: 12px; text-align: center; box-shadow: 0 4px 12px rgba(34, 197, 94, 0.2);">
                      <div style="font-size: 0.85rem; color: var(--muted); margin-bottom: 8px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em;">
                        Beneficiário Recebeu a Mais
                      </div>
                      <div style="font-size: 1.8rem; font-weight: 700; color: #15803d; margin-bottom: 4px;">
                        +${numberFormatter.format(diferencaKwhRecebido)} kWh
                      </div>
                      <div style="font-size: 0.75rem; color: var(--muted);">
                        Diferença entre recebido e contratado
                      </div>
                    </div>
                    ` : ''}
                  </div>
                  <div class="benef-year-data-right">
                    <div class="benef-box">
                      <div class="benef-box-title">Gráfico Mensal ${year}</div>
                      <canvas id="chart-${profile.nome.replace(/\s+/g, '-')}-${year}" style="width: 100%; max-height: 350px; height: 350px;"></canvas>
                      <div id="table-${profile.nome.replace(/\s+/g, '-')}-${year}" class="chart-table-container"></div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="benef-year-indicator">${year}</div>
            </div>
                `;
              }).join('');
            })()}
          </div>
        `;
        label.appendChild(input);
        label.appendChild(meta);
        benefFilterContainer.appendChild(label);
      });
      
      // Seleciona automaticamente todos os beneficiários após serem populados
      if (profiles.length > 0) {
        toggleBenefCheckboxes(true);
        const allCheckbox = document.getElementById('benef-all');
        if (allCheckbox) {
          allCheckbox.checked = true;
        }
      }
      
      // Registra plugin customizado para datalabels
      Chart.register({
        id: 'datalabels',
        afterDatasetsDraw: function(chart) {
          const ctx = chart.ctx;
          chart.data.datasets.forEach((dataset, datasetIndex) => {
            const meta = chart.getDatasetMeta(datasetIndex);
            meta.data.forEach((point, index) => {
              const value = dataset.data[index];
              if (value !== null && value !== undefined) {
                const x = point.x;
                const y = point.y;
                ctx.save();
                ctx.font = 'bold 8px Arial';
                ctx.textAlign = 'center';
                
                let label = '';
                let offset = 0;
                let textBaseline = 'bottom';
                
                if (dataset.yAxisID === 'y1') {
                  // Valor Pago (R$) - etiqueta acima do ponto (cor da linha)
                  ctx.fillStyle = dataset.borderColor;
                  label = currencyFormatter.format(value);
                  offset = -15;
                  textBaseline = 'bottom';
                } else {
                  // Recebido (kWh) - etiqueta abaixo do ponto com "kWh" (cor preta)
                  ctx.fillStyle = '#000000';
                  label = numberFormatter.format(value) + ' kWh';
                  offset = 15;
                  textBaseline = 'top';
                }
                
                ctx.textBaseline = textBaseline;
                ctx.fillText(label, x, y + offset);
                ctx.restore();
              }
            });
          });
        }
      });

      // Cria gr�ficos para todos os anos (incluindo o atual)
      setTimeout(() => {
        profiles.forEach(profile => {
          const anoAtual = new Date().getFullYear();
          const selectedYears = profile.selectedYears || [];
          
          // Se nenhum ano foi selecionado, não cria gráficos
          if (selectedYears.length === 0) {
            return;
          }
          
          // Inclui apenas os anos selecionados
          const todosAnos = [];
          if (selectedYears.includes(anoAtual)) {
            todosAnos.push(anoAtual);
          }
          const outrosAnos = Object.keys(profile.anosComDados || {}).map(y => parseInt(y)).filter(y => selectedYears.includes(y));
          todosAnos.push(...outrosAnos);
          const anosUnicos = [...new Set(todosAnos)];
          
          anosUnicos.forEach(yearNum => {
            const chartId = `chart-${profile.nome.replace(/\s+/g, '-')}-${yearNum}`;
            const tableId = `table-${profile.nome.replace(/\s+/g, '-')}-${yearNum}`;
            const canvas = document.getElementById(chartId);
            if (canvas) {
              const monthlyData = getMonthlyDataForYear(profile.registros, yearNum);
              if (monthlyData.meses.length > 0) {
                // Todos os gr�ficos mostram apenas Recebido e Valor Pago
                const datasets = [];
                
                // Recebido (kWh) - verde escuro
                datasets.push({
                  label: 'Recebido (kWh)',
                  data: monthlyData.recebido,
                  borderColor: '#15803d',
                  backgroundColor: 'rgba(21, 128, 61, 0.2)',
                  tension: 0.1,
                  pointRadius: 5,
                  pointHoverRadius: 7
                });
                
                // Valor Pago (R$) - sempre mostra
                datasets.push({
                  label: 'Valor Pago (R$)',
                  data: monthlyData.valorPago,
                  borderColor: 'rgb(54, 162, 235)',
                  backgroundColor: 'rgba(54, 162, 235, 0.2)',
                  tension: 0.1,
                  yAxisID: 'y1',
                  borderWidth: 2,
                  pointRadius: 5,
                  pointHoverRadius: 7
                });
                
                new Chart(canvas, {
                  type: 'line',
                  data: {
                    labels: monthlyData.meses,
                    datasets: datasets
                  },
                  options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                      legend: {
                        display: true,
                        position: 'bottom'
                      },
                      tooltip: {
                        enabled: true,
                        callbacks: {
                          label: function(context) {
                            let label = context.dataset.label || '';
                            if (label) {
                              label += ': ';
                            }
                            if (context.dataset.yAxisID === 'y1') {
                              label += currencyFormatter.format(context.parsed.y);
                            } else {
                              label += numberFormatter.format(context.parsed.y) + ' kWh';
                            }
                            return label;
                          }
                        }
                      }
                    },
                    scales: {
                      y: {
                        type: 'linear',
                        display: true,
                        position: 'left',
                        title: {
                          display: false
                        },
                        ticks: {
                          display: false,
                          callback: function(value) {
                            return numberFormatter.format(value);
                          }
                        }
                      },
                      y1: {
                        type: 'linear',
                        display: true,
                        position: 'right',
                        title: {
                          display: false
                        },
                        ticks: {
                          display: false,
                          callback: function(value) {
                            return currencyFormatter.format(value);
                          }
                        },
                        grid: {
                          drawOnChartArea: false
                        }
                      }
                    }
                  }
                });
                
                // Cria tabela com os dados mensais - captura vari�veis para usar no setTimeout
                const tableIdForTable = tableId;
                const monthlyDataForTable = monthlyData;
                setTimeout(() => {
                  const tableContainer = document.getElementById(tableIdForTable);
                  if (tableContainer) {
                    if (monthlyDataForTable.meses.length > 0) {
                      let tableHTML = '<table class="chart-table"><thead><tr><th>Mês</th><th>kWh</th><th>R$</th></tr></thead><tbody>';
                      monthlyDataForTable.meses.forEach((mes, index) => {
                        const kwh = monthlyDataForTable.recebido[index] || 0;
                        const valor = monthlyDataForTable.valorPago[index] || 0;
                        tableHTML += `<tr><td>${mes}</td><td>${numberFormatter.format(kwh)}</td><td>${currencyFormatter.format(valor)}</td></tr>`;
                      });
                      tableHTML += '</tbody></table>';
                      tableContainer.innerHTML = tableHTML;
                    }
                  } else {
                    // Tenta novamente ap�s mais tempo se n�o encontrou
                    setTimeout(() => {
                      const retryContainer = document.getElementById(tableIdForTable);
                      if (retryContainer && monthlyDataForTable.meses.length > 0) {
                        let tableHTML = '<table class="chart-table"><thead><tr><th>Mês</th><th>kWh</th><th>R$</th></tr></thead><tbody>';
                        monthlyDataForTable.meses.forEach((mes, index) => {
                          const kwh = monthlyDataForTable.recebido[index] || 0;
                          const valor = monthlyDataForTable.valorPago[index] || 0;
                          tableHTML += `<tr><td>${mes}</td><td>${numberFormatter.format(kwh)}</td><td>${currencyFormatter.format(valor)}</td></tr>`;
                        });
                        tableHTML += '</tbody></table>';
                        retryContainer.innerHTML = tableHTML;
                      }
                    }, 500);
                  }
                }, 500);
              }
            }
          });
        });
      }, 100);
    }

    function toggleBenefCheckboxes(state) {
      selectElements.beneficiario
        .querySelectorAll('input[data-role="benef-option"]')
        .forEach(cb => {
          cb.checked = state;
          // Atualiza o Set de benefici�rios selecionados
          if (state) {
            selectedBeneficiarios.add(cb.value);
          } else {
            selectedBeneficiarios.delete(cb.value);
          }
        });
    }
    
    function updateAllCheckboxState() {
      const allCheckbox = document.getElementById('benef-all');
      if (!allCheckbox) return;
      const allOptions = selectElements.beneficiario.querySelectorAll('input[data-role="benef-option"]');
      const checkedCount = Array.from(allOptions).filter(cb => cb.checked).length;
      allCheckbox.checked = checkedCount === allOptions.length && allOptions.length > 0;
      allCheckbox.indeterminate = checkedCount > 0 && checkedCount < allOptions.length;
    }

    function resetBenefCheckboxes() {
      if (!beneficiariosList.length) return;
      const allCheckbox = document.getElementById('benef-all');
      if (allCheckbox) allCheckbox.checked = false;
      toggleBenefCheckboxes(false);
      selectedBeneficiarios = new Set();
    }

    function formatMesLabel(value) {
      const date = new Date(`${value}T00:00:00`);
      const month = String(date.getMonth() + 1).padStart(2, '0');
      const year = date.getFullYear();
      return `${month}/${year}`;
    }

    function getFilters() {
      // Log do estado dos Sets ANTES de criar o objeto filters
      console.log('getFilters - Estado dos Sets ANTES:', {
        ano: selectedFilters.ano.size,
        mes: selectedFilters.mes.size,
        instalacao: selectedFilters.instalacao.size,
        valores: {
          mes: Array.from(selectedFilters.mes),
          instalacao: Array.from(selectedFilters.instalacao)
        }
      });
      
      const filters = {
        parceiro: selectElements.parceiro.value,
        ano: selectedFilters.ano,
        mes: selectedFilters.mes,
        instalacao: selectedFilters.instalacao
      };
      console.log('getFilters chamado:', {
        ano: filters.ano.size,
        mes: filters.mes.size,
        instalacao: filters.instalacao.size,
        valores: {
          ano: Array.from(filters.ano),
          mes: Array.from(filters.mes),
          instalacao: Array.from(filters.instalacao)
        }
      });
      return filters;
    }

    function applyFilters(data, filters) {
      // ANO é obrigatório - deve ter pelo menos um item selecionado
      // MÊS é opcional (filtro oculto) - se não tiver seleção, mostra todos os meses
      // INSTALAÇÃO é opcional - se não tiver seleção, mostra tudo; se tiver, filtra
      // BENEFICIÁRIOS são mostrados automaticamente baseado nos outros filtros
      if (filters.ano.size === 0) {
        console.log('applyFilters: Filtros obrigatórios sem seleção', {
          ano: filters.ano.size
        });
        return [];
      }
      
      console.log('applyFilters: Filtros aplicados', {
        ano: Array.from(filters.ano),
        mes: Array.from(filters.mes),
        instalacao: Array.from(filters.instalacao)
      });
      
      const filtered = data.filter(item => {
        if (filters.parceiro && item.parceiro !== filters.parceiro) return false;
        // Filtra por ano (obrigatório)
        if (filters.ano.size && !filters.ano.has(String(item.ano))) return false;
        // Filtra por mês (opcional - se não tiver seleção, mostra todos os meses)
        if (filters.mes.size > 0) {
          const itemMes = String(item.mes_ano || '');
          if (!filters.mes.has(itemMes)) return false;
        }
        // Filtra por instalação (opcional - se não tiver seleção, mostra tudo)
        if (filters.instalacao.size > 0) {
          const itemInstalacao = String(item.instalacao || '');
          if (!filters.instalacao.has(itemInstalacao)) return false;
        }
        // Beneficiários são mostrados automaticamente baseado nos filtros acima
        return true;
      });
      
      console.log('applyFilters: Resultado', {
        total: data.length,
        filtrado: filtered.length
      });
      
      return filtered;
    }

    function summarize(data) {
      const months = data.length;
      const totalContratado = data.reduce((sum, item) => sum + item.kWhDisponibilizadosMes, 0);
      const totalRecebido = data.reduce((sum, item) => sum + item.edp_total_kwh, 0);
      const totalDiferenca = data.reduce((sum, item) => sum + item.edp_dif_recebidos_x_contratado, 0);
      const totalMensalidade = data.reduce((sum, item) => sum + item.valorMensalidade, 0);
      const mediaContratada = months ? totalContratado / months : 0;
      const mediaRecebida = months ? totalRecebido / months : 0;

      const totalPositiva = data.reduce(
        (sum, item) => sum + Math.max(0, item.edp_dif_recebidos_x_contratado || 0),
        0
      );

      return {
        months,
        totalContratado,
        totalRecebido,
        totalDiferenca,
        totalPositiva,
        totalMensalidade,
        mediaContratada,
        mediaRecebida,
        aderencia: mediaContratada ? (mediaRecebida / mediaContratada) * 100 : 0
      };
    }

    function updateDiffCard(summary) {
      // Só mostra o card se a soma dos positivos for maior que 0
      if (diffCard) {
        const diferencaPositiva = Math.max(0, summary.totalPositiva || 0);
        if (diferencaPositiva > 0 && summary.totalRecebido > 0) {
          diffCard.style.display = 'flex';
          if (diffValue) {
            diffValue.textContent = `+${numberFormatter.format(diferencaPositiva)} kWh`;
          }
          diffCard.dataset.state = 'positive';
        } else {
          diffCard.style.display = 'none';
        }
      }
    }

    function updateYearSummary(data) {
      if (!data || data.length === 0) {
        if (yearSummaryCard) yearSummaryCard.hidden = true;
        if (diffCard) diffCard.style.display = 'none';
        if (diffDetailContainer) diffDetailContainer.style.display = 'none';
        return;
      }

      // Usa todos os dados filtrados (n�o apenas ano atual)
      // Soma kWh contratados (kWhDisponibilizadosMes)
      const somaContratado = data.reduce((sum, item) => sum + (item.kWhDisponibilizadosMes || 0), 0);
      
      // Soma kWh recebidos (edp_total_kwh)
      const somaRecebido = data.reduce((sum, item) => sum + (item.edp_total_kwh || 0), 0);
      
      // Diferen�a
      const diferenca = somaRecebido - somaContratado;
      
      // Percentual da diferen�a
      const percentualDiferenca = somaContratado > 0 ? ((diferenca / somaContratado) * 100) : 0;
      
      // Média do valor_kwh_edp do período filtrado
      const somaValorKwhEdp = data.reduce((sum, item) => sum + (item.valor_kwh_edp || 0), 0);
      const mediaValorKwhEdp = data.length > 0 ? somaValorKwhEdp / data.length : 0;

      // Atualiza os elementos
      if (yearRecebido) {
        yearRecebido.textContent = numberFormatter.format(somaRecebido);
      }
      if (yearSummaryCard) {
        yearSummaryCard.hidden = false;
      }
      
      // Só mostra o card "Recebido acima do contratado" se a soma dos positivos for maior que 0
      if (diffCard) {
        const diferencaPositiva = data.reduce(
          (sum, item) => sum + Math.max(0, item.edp_dif_recebidos_x_contratado || 0),
          0
        );
        if (diferencaPositiva > 0 && somaRecebido > 0) {
          diffCard.style.display = 'flex';
          if (diffValue) {
            diffValue.textContent = `+${numberFormatter.format(diferencaPositiva)} kWh`;
          }
          diffCard.setAttribute('data-state', 'positive');
        } else {
          diffCard.style.display = 'none';
        }
      }

      // Preenche a tabela de anos com recebimento acima do contratado
      if (diffDetailContainer && diffDetailBody) {
        const positivos = data.filter(item => (item.edp_dif_recebidos_x_contratado || 0) > 0);

        if (!positivos.length) {
          diffDetailContainer.style.display = 'none';
          diffDetailBody.innerHTML = '';
        } else {
          diffDetailContainer.style.display = 'block';
          // Agrupa por ano e soma o excedente de cada ano
          const porAno = {};
          positivos.forEach(item => {
            const ano = new Date(`${item.mes_ano}T00:00:00`).getFullYear();
            const diff = item.edp_dif_recebidos_x_contratado || 0;
            porAno[ano] = (porAno[ano] || 0) + diff;
          });

          const linhas = Object.keys(porAno)
            .sort((a, b) => parseInt(a) - parseInt(b))
            .map(ano => {
              const valor = porAno[ano];
              return `
                <tr>
                  <td>${ano}</td>
                  <td style="text-align: right; color: var(--positive); font-weight: 600;">
                    +${numberFormatter.format(valor)} kWh
                  </td>
                </tr>
              `;
            }).join('');

          diffDetailBody.innerHTML = linhas;
        }
      }
    }

    function updateSummaryCards(data) {
      // Fun��o removida - as caixas "Valor M�dio kWh" e "Valores Totais" foram removidas
    }

    function updateInsights(summary) {
      // Ajusta Índice de entrega: se menor que 0, mostra 0%
      const indiceEntrega = Math.max(0, summary.aderencia || 0);
      
      // Ajusta Diferença acumulada: se <= 0, mostra 0 (considera apenas excedentes positivos)
      const diferencaAcumulada = Math.max(0, summary.totalPositiva || 0);
      
      const cards = [
        {
          label: 'Meses analisados',
          value: summary.months,
          detail: summary.months >= 12 ? 'Janela completa de 12 meses' : 'Ainda sem 12 meses completos'
        },
        {
          label: 'Média recebida (kWh)',
          value: numberFormatter.format(summary.mediaRecebida),
          detail: summary.mediaRecebida >= summary.mediaContratada ? 'Acima da meta contratada' : ''
        },
        {
          label: 'Diferença acumulada',
          value: `${diferencaAcumulada > 0 ? '+' : ''}${numberFormatter.format(diferencaAcumulada)} kWh`,
          detail: diferencaAcumulada > 0 ? 'Excedente recebido' : 'Sem excedente'
        },
      ];

      insightsGrid.innerHTML = cards.map(card => {
        // Aplica cor para "Diferença acumulada" - verde se > 0, caso contrário sem cor especial
        const valueStyle = card.label === 'Diferença acumulada' 
          ? `style="color: ${diferencaAcumulada > 0 ? 'var(--positive)' : 'var(--text)'}"`
          : '';
        
        return `
        <div class="insight-card">
          <span>${card.label}</span>
          <strong ${valueStyle}>${card.value}</strong>
          <p>${card.detail}</p>
        </div>
      `;
      }).join('');
    }

    function updateTable(data) {
      // Filtra os dados: remove linhas onde "kWh Recebido a mais do Previsto" é 0
      // Esta regra é aplicada APENAS na tabela de dados (grid) da seção 03
      // Linhas com diferença <= 0 não serão exibidas
      const dadosFiltrados = data.filter(item => {
        const diferenca = item.edp_dif_recebidos_x_contratado || 0;
        // Mantém apenas linhas com diferença > 0 (oculta linhas com 0)
        return diferenca > 0;
      });
      
      tableBody.innerHTML = dadosFiltrados.map(item => {
        // Calcula diferen�a: se <= 0, mostra 0; se > 0, mostra em verde com +
        const diferenca = item.edp_dif_recebidos_x_contratado || 0;
        const diferencaExibida = diferenca > 0 ? diferenca : 0;
        const diferencaStyle = diferenca > 0 ? 'style="color: var(--positive)"' : '';
        const diferencaTexto = diferenca > 0 ? `+${numberFormatter.format(diferencaExibida)} kWh` : '0 kWh';
        
        return `
        <tr>
          <td>${formatMesLabel(item.mes_ano)}</td>
          <td>${item.instalacao}</td>
          <td>${item.nome_beneficiario}</td>
          <td>${numberFormatter.format(item.edp_total_kwh)} kWh</td>
          <td ${diferencaStyle} style="text-align: center;">
            ${diferencaTexto}
          </td>
          <td>${currencyFormatter.format(item.valorMensalidade)}</td>
          <td>15%</td>
        </tr>
      `;
      }).join('');

      const hasData = dadosFiltrados.length > 0;
      tableBody.parentElement.style.display = hasData ? 'table' : 'none';
      emptyState.hidden = hasData;
    }

    function buildChart(data) {
      const ctx = document.getElementById('energiaChart').getContext('2d');

      // Agrupa dados por ano e soma os valores quando há múltiplos beneficiários no mesmo mês
      const dadosPorAno = {};
      data.forEach(item => {
        const date = new Date(`${item.mes_ano}T00:00:00`);
        const ano = date.getFullYear();
        const mes = date.getMonth(); // 0-11
        
        if (!dadosPorAno[ano]) {
          dadosPorAno[ano] = {
            contratado: new Array(12).fill(null),
            recebido: new Array(12).fill(null)
          };
        }
        
        // Soma os valores em vez de sobrescrever (para múltiplos beneficiários no mesmo mês)
        // Converte null para 0 na soma, mas mantém null se não houver dados
        const valorContratadoAtual = dadosPorAno[ano].contratado[mes] === null ? 0 : dadosPorAno[ano].contratado[mes];
        const valorRecebidoAtual = dadosPorAno[ano].recebido[mes] === null ? 0 : dadosPorAno[ano].recebido[mes];
        dadosPorAno[ano].contratado[mes] = valorContratadoAtual + (item.kWhDisponibilizadosMes || 0);
        dadosPorAno[ano].recebido[mes] = valorRecebidoAtual + (item.edp_total_kwh || 0);
      });

      // Labels dos meses (jan, fev, etc)
      const mesesLabels = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
      
      // Cria datasets para cada ano
      const datasets = [];
      const anos = Object.keys(dadosPorAno).sort();
      
      // Cores bem contrastantes para diferentes anos (apenas recebido)
      const coresAnos = [
        'rgba(239, 68, 68, 0.95)',    // vermelho
        'rgba(34, 197, 94, 0.95)',    // verde
        'rgba(59, 130, 246, 0.95)',   // azul
        'rgba(234, 179, 8, 0.95)',    // amarelo
        'rgba(217, 70, 239, 0.95)',   // roxo
        'rgba(16, 185, 129, 0.95)',   // verde água
        'rgba(249, 115, 22, 0.95)',   // laranja
        'rgba(15, 118, 110, 0.95)',   // teal escuro
      ];

      anos.forEach((ano, indexAno) => {
        // Cor específica para 2023: roxa forte
        let cor;
        if (parseInt(ano) === 2023) {
          cor = 'rgba(138, 43, 226, 0.95)'; // Azul-violeta (roxa forte)
        } else {
          cor = coresAnos[indexAno % coresAnos.length];
        }
        
        // Linha de kWh recebido para este ano (apenas recebido)
        datasets.push({
          label: `${ano}`,
          data: dadosPorAno[ano].recebido,
          borderColor: cor,
          backgroundColor: cor.replace('0.95', '0.18'),
          tension: 0.35,
          borderWidth: 3,
          pointRadius: 4,
          fill: false
        });
      });

      return new Chart(ctx, {
        type: 'line',
        data: {
          labels: mesesLabels,
          datasets: datasets
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: {
            mode: 'index',
            intersect: false
          },
          plugins: {
            legend: {
              display: true,
              labels: {
                color: '#0f2a24'
              }
            },
            tooltip: {
              enabled: true,
              callbacks: {
                label: context => `${context.dataset.label}: ${numberFormatter.format(context.parsed.y)} kWh`
              }
            },
            datalabels: {
              display: false
            }
          },
          scales: {
            x: {
              ticks: { color: '#0f2a24' },
              grid: { display: false }
            },
            y: {
              ticks: {
                color: '#0f2a24',
                callback: value => `${numberFormatter.format(value)}`
              },
              grid: {
                color: 'rgba(15, 42, 36, 0.1)'
              }
            }
          }
        }
      });
    }

    let energiaChart = null;

    function updateChart(chart, data) {
      // Agrupa dados por ano e soma os valores quando há múltiplos beneficiários no mesmo mês
      const dadosPorAno = {};
      data.forEach(item => {
        const date = new Date(`${item.mes_ano}T00:00:00`);
        const ano = date.getFullYear();
        const mes = date.getMonth(); // 0-11
        
        if (!dadosPorAno[ano]) {
          dadosPorAno[ano] = {
            contratado: new Array(12).fill(null),
            recebido: new Array(12).fill(null)
          };
        }
        
        // Soma os valores em vez de sobrescrever (para múltiplos beneficiários no mesmo mês)
        // Converte null para 0 na soma, mas mantém null se não houver dados
        const valorContratadoAtual = dadosPorAno[ano].contratado[mes] === null ? 0 : dadosPorAno[ano].contratado[mes];
        const valorRecebidoAtual = dadosPorAno[ano].recebido[mes] === null ? 0 : dadosPorAno[ano].recebido[mes];
        dadosPorAno[ano].contratado[mes] = valorContratadoAtual + (item.kWhDisponibilizadosMes || 0);
        dadosPorAno[ano].recebido[mes] = valorRecebidoAtual + (item.edp_total_kwh || 0);
      });

      // Labels dos meses (jan, fev, etc)
      const mesesLabels = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
      
      // Cores bem contrastantes para diferentes anos (apenas recebido)
      const coresAnos = [
        'rgba(239, 68, 68, 0.95)',    // vermelho
        'rgba(34, 197, 94, 0.95)',    // verde
        'rgba(59, 130, 246, 0.95)',   // azul
        'rgba(234, 179, 8, 0.95)',    // amarelo
        'rgba(217, 70, 239, 0.95)',   // roxo
        'rgba(16, 185, 129, 0.95)',   // verde água
        'rgba(249, 115, 22, 0.95)',   // laranja
        'rgba(15, 118, 110, 0.95)',   // teal escuro
      ];

      // Atualiza labels
      chart.data.labels = mesesLabels;
      
      // Recria datasets
      const datasets = [];
      const anos = Object.keys(dadosPorAno).sort();
      
      anos.forEach((ano, indexAno) => {
        // Cor específica para 2023: roxa forte
        let cor;
        if (parseInt(ano) === 2023) {
          cor = 'rgba(138, 43, 226, 0.95)'; // Azul-violeta (roxa forte)
        } else {
          cor = coresAnos[indexAno % coresAnos.length];
        }
        
        // Linha de kWh recebido para este ano (apenas recebido)
        datasets.push({
          label: `${ano}`,
          data: dadosPorAno[ano].recebido,
          borderColor: cor,
          backgroundColor: cor.replace('0.95', '0.18'),
          tension: 0.35,
          borderWidth: 3,
          pointRadius: 4,
          fill: false
        });
      });
      
      chart.data.datasets = datasets;
      // Habilita tooltip, desabilita datalabels, mas mant�m legenda
      if (chart.options.plugins) {
        chart.options.plugins.tooltip = { 
          enabled: true,
          callbacks: {
            label: context => `${context.dataset.label}: ${numberFormatter.format(context.parsed.y)} kWh`
          }
        };
        chart.options.plugins.legend = { display: true, labels: { color: '#0f2a24' } };
        chart.options.plugins.datalabels = { display: false };
      }
      chart.update();
    }

    function hasActiveFilters(filters) {
      return Boolean(
        filters.parceiro ||
        filters.ano.size ||
        filters.mes.size ||
        filters.instalacao.size ||
        filters.beneficiarios.size
      );
    }

    // Fun��o para normalizar valores de total_kwh_gerado (remove pontos de milhar, converte vírgula para ponto)
    function normalizeKwhValue(value) {
      if (typeof value === 'string') {
        let str = value.trim();
        // Remove espaços
        str = str.replace(/\s/g, '');
        
        // Se tiver vírgula, assume que é separador decimal (formato brasileiro)
        if (str.includes(',')) {
          // Remove pontos (separadores de milhares) e converte vírgula para ponto
          return parseFloat(str.replace(/\./g, '').replace(',', '.')) || 0;
        }
        
        // Se tiver ponto mas não vírgula, verifica se é separador de milhares ou decimal
        if (str.includes('.')) {
          const partes = str.split('.');
          // Se tiver múltiplas partes, verifica se são separadores de milhares
          if (partes.length >= 2) {
            const ultimaParte = partes[partes.length - 1];
            // Se a última parte tem exatamente 3 dígitos e todas as partes têm 3 dígitos ou menos, é separador de milhares
            // Exemplo: "134.641" -> ["134", "641"] -> ambas têm 3 dígitos -> separador de milhares
            // Exemplo: "146.000" -> ["146", "000"] -> última tem 3, todas têm <= 3 -> separador de milhares
            // Exemplo: "1.748.258" -> ["1", "748", "258"] -> última tem 3, todas têm <= 3 -> separador de milhares
            if (ultimaParte.length === 3 && partes.every(p => p.length > 0 && p.length <= 3)) {
              // Remove todos os pontos (são separadores de milhares)
              return parseFloat(str.replace(/\./g, '')) || 0;
            }
            // Se a última parte tem mais de 3 dígitos, provavelmente é separador decimal
            // Exemplo: "1234.5678" -> separador decimal
            if (ultimaParte.length > 3) {
              return parseFloat(str) || 0;
            }
            // Se a última parte tem menos de 3 dígitos e há apenas 2 partes, pode ser separador decimal
            // Exemplo: "123.45" -> separador decimal (45 centésimos)
            // Exemplo: "123.4" -> separador decimal
            if (ultimaParte.length < 3 && partes.length === 2) {
              // Provavelmente é separador decimal
              return parseFloat(str) || 0;
            }
          }
          // Caso padrão: trata como separador decimal
          return parseFloat(str) || 0;
        }
        
        // Sem pontos nem vírgulas, converte direto
        return parseFloat(str) || 0;
      }
      return parseFloat(value) || 0;
    }

    // Fun��o para carregar dados da usina
    // Para carregar de um endpoint no futuro, substitua esta fun��o por:
    // async function loadUsinaData() {
    //   const response = await fetch('https://seu-endpoint.com/api/dados');
    //   const json = await response.json();
    //   return normalizeData(json.geral_usina || []);
    // }
    function loadUsinaData() {
      try {
        const dataElement = document.getElementById('dashboard-data');
        if (dataElement && dataElement.textContent.trim()) {
          const jsonData = JSON.parse(dataElement.textContent);
          const usinaData = jsonData.geral_usina || [];
          return normalizeData(usinaData);
        }
      } catch (e) {
        console.error('Erro ao carregar dados da usina do elemento JSON:', e);
      }
      // Fallback: retorna array vazio se n�o conseguir carregar
      return [];
    }

    function buildUsinaChart(data) {
      const ctx = document.getElementById('usinaChart').getContext('2d');

      // Normaliza e agrupa dados por ano
      const dadosPorAno = {};
      data.forEach(item => {
        const mesAno = item.mes_ano; // formato "YYYY-MM"
        const partes = mesAno.split('-');
        const ano = parseInt(partes[0]);
        const mes = parseInt(partes[1]) - 1; // 0-11 para JavaScript Date
        
        if (!dadosPorAno[ano]) {
          dadosPorAno[ano] = new Array(12).fill(null);
        }
        
        const kwhGerado = normalizeKwhValue(item.total_kwh_gerado);
        dadosPorAno[ano][mes] = kwhGerado;
      });

      // Labels dos meses (jan, fev, etc)
      const mesesLabels = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
      
      // Cria datasets para cada ano
      const datasets = [];
      const anos = Object.keys(dadosPorAno).sort();
      
      // Cores para diferentes anos - cores mais distintas e contrastantes
      const coresAnos = [
        'rgba(239, 68, 68, 1)',      // 2023 - Vermelho
        'rgba(34, 197, 94, 1)',      // 2024 - Verde
        'rgba(59, 130, 246, 1)',     // 2025 - Azul
        'rgba(168, 85, 247, 1)',     // Outros - Roxo
        'rgba(249, 115, 22, 1)',     // Laranja
        'rgba(236, 72, 153, 1)',     // Rosa
        'rgba(14, 165, 233, 1)',     // Azul claro
        'rgba(34, 197, 94, 1)',      // Verde claro
      ];

      anos.forEach((ano, indexAno) => {
        // Cor específica para 2023: roxa forte
        let cor;
        if (parseInt(ano) === 2023) {
          cor = 'rgba(138, 43, 226, 1)'; // Azul-violeta (roxa forte)
        } else {
          const corIndex = indexAno % coresAnos.length;
          cor = coresAnos[corIndex];
        }
        
        datasets.push({
          label: `${ano}`,
          data: dadosPorAno[ano],
          borderColor: cor,
          backgroundColor: cor.replace('1)', '0.2)'),
          tension: 0.35,
          borderWidth: 3,
          pointRadius: 4,
          fill: false
        });
      });

      return new Chart(ctx, {
        type: 'line',
        data: {
          labels: mesesLabels,
          datasets: datasets
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: {
            mode: 'index',
            intersect: false
          },
          plugins: {
            legend: {
              display: true,
              position: 'top',
              labels: {
                color: '#0f2a24',
                font: {
                  size: 12,
                  weight: '600'
                },
                padding: 15,
                usePointStyle: true
              }
            },
            tooltip: {
              enabled: true,
              callbacks: {
                label: context => `${context.dataset.label}: ${formatKwh(context.parsed.y)}`
              }
            },
            datalabels: {
              display: false
            }
          },
          scales: {
            x: {
              ticks: { color: '#0f2a24' },
              grid: { display: false }
            },
            y: {
              ticks: {
                display: false
              },
              grid: {
                color: 'rgba(15, 42, 36, 0.1)'
              }
            }
          }
        }
      });
    }

    let usinaChart = null;
    let usinaTrendChart = null; // Gr�fico de tend�ncia da usina

    function updateUsinaChart(chart, data) {
      // Normaliza e agrupa dados por ano
      const dadosPorAno = {};
      data.forEach(item => {
        const mesAno = item.mes_ano; // formato "YYYY-MM"
        const partes = mesAno.split('-');
        const ano = parseInt(partes[0]);
        const mes = parseInt(partes[1]) - 1; // 0-11 para JavaScript Date
        
        if (!dadosPorAno[ano]) {
          dadosPorAno[ano] = new Array(12).fill(null);
        }
        
        const kwhGerado = normalizeKwhValue(item.total_kwh_gerado);
        dadosPorAno[ano][mes] = kwhGerado;
      });

      // Atualiza datasets
      const anos = Object.keys(dadosPorAno).sort();
      // Cores para diferentes anos - cores mais distintas e contrastantes
      const coresAnos = [
        'rgba(239, 68, 68, 1)',      // 2023 - Vermelho
        'rgba(34, 197, 94, 1)',      // 2024 - Verde
        'rgba(59, 130, 246, 1)',     // 2025 - Azul
        'rgba(168, 85, 247, 1)',     // Outros - Roxo
        'rgba(249, 115, 22, 1)',     // Laranja
        'rgba(236, 72, 153, 1)',     // Rosa
        'rgba(14, 165, 233, 1)',     // Azul claro
        'rgba(34, 197, 94, 1)',      // Verde claro
      ];

      const datasets = anos.map((ano, indexAno) => {
        // Cor específica para 2023: roxa forte
        let cor;
        if (parseInt(ano) === 2023) {
          cor = 'rgba(138, 43, 226, 1)'; // Azul-violeta (roxa forte)
        } else {
          const corIndex = indexAno % coresAnos.length;
          cor = coresAnos[corIndex];
        }
        
        return {
          label: `${ano}`,
          data: dadosPorAno[ano],
          borderColor: cor,
          backgroundColor: cor.replace('1)', '0.2)'),
          tension: 0.35,
          borderWidth: 3,
          pointRadius: 4,
          fill: false
        };
      });

      chart.data.datasets = datasets;
      // Garante que legenda, datalabels e tooltip permane�am desabilitados
      if (chart.options.plugins) {
        chart.options.plugins.legend = {
          display: true,
          position: 'top',
          labels: {
            color: '#0f2a24',
            font: {
              size: 12,
              weight: '600'
            },
            padding: 15,
            usePointStyle: true
          }
        };
        chart.options.plugins.datalabels = { display: false };
        chart.options.plugins.tooltip = {
          enabled: true,
          callbacks: {
            label: context => `${context.dataset.label}: ${formatKwh(context.parsed.y)}`
          }
        };
      }
      chart.update();
    }

    function buildUsinaTable(data) {
      const tableHead = document.getElementById('usinaTableHead');
      const tableBody = document.getElementById('usinaTableBody');
      
      if (!tableHead || !tableBody) return;
      
      // Normaliza e agrupa dados por ano e mês
      const dadosPorAno = {};
      const todosValores = [];
      
      data.forEach(item => {
        const mesAno = item.mes_ano; // formato "YYYY-MM"
        const partes = mesAno.split('-');
        const ano = parseInt(partes[0]);
        const mes = parseInt(partes[1]) - 1; // 0-11 para JavaScript Date
        
        if (!dadosPorAno[ano]) {
          dadosPorAno[ano] = new Array(12).fill(null);
        }
        
        const kwhGerado = normalizeKwhValue(item.total_kwh_gerado);
        dadosPorAno[ano][mes] = kwhGerado;
        if (kwhGerado !== null && kwhGerado !== undefined) {
          todosValores.push(kwhGerado);
        }
      });
      
      // Limiares ajustados para a escala real dos dados (centenas de kWh)
      const thresholdVerdeClaro = 150; // Limite para verde clarinho (~150 kWh)
      const thresholdVerdeForte = 170; // Limite para verde mais forte (~170 kWh)
      const thresholdAmarelo = 130;    // Limite para amarelo fraco (~130 kWh)
      
      // Fun��o para calcular a cor baseada no valor
      function getHeatmapColor(value) {
        // Valores nulos, muito baixos ou absurdamente altos ficam cinza
        if (value === null || value === undefined || value <= 0 || value > 1000000) {
          return 'rgba(200, 200, 200, 0.3)'; // Cinza para valores inválidos
        }
        
        // Abaixo de 130: vai emvermelhando (vermelho mais forte)
        if (value < thresholdAmarelo) {
          // Gradiente vermelho: quanto menor, mais vermelho
          const normalized = Math.min(1, value / thresholdAmarelo); // 0 a 1 dentro do range vermelho
          const red = 239;
          const green = Math.round(68 - (68 - 20) * (1 - normalized)); // 20 a 68
          const blue = Math.round(68 - (68 - 20) * (1 - normalized)); // 20 a 68
          const alpha = 0.3 + (0.4 * normalized); // 0.3 a 0.7
          return `rgba(${red}, ${green}, ${blue}, ${alpha})`;
        }
        
        // Entre 130 e 150: amarelo fraco
        if (value < thresholdVerdeClaro) {
          // Normaliza entre 0 e 1 (onde 0 = 130k e 1 = 150k)
          const normalized = (value - thresholdAmarelo) / (thresholdVerdeClaro - thresholdAmarelo);
          // Interpola entre vermelho (130k) e amarelo fraco (150k)
          // Vermelho: rgba(239, 68, 68, ...)
          // Amarelo fraco: rgba(255, 235, 150, ...) - amarelo bem suave
          const red = Math.round(239 + (255 - 239) * normalized); // 239 a 255
          const green = Math.round(68 + (235 - 68) * normalized); // 68 a 235
          const blue = Math.round(68 + (150 - 68) * normalized); // 68 a 150
          const alpha = 0.4 + (0.3 * normalized); // 0.4 a 0.7
          return `rgba(${red}, ${green}, ${blue}, ${alpha})`;
        }
        
        // Entre 150 e 155: verde bem clarinho
        if (value < thresholdVerdeForte) {
          // Normaliza entre 0 e 1 (onde 0 = 150k e 1 = 155k)
          const normalized = (value - thresholdVerdeClaro) / (thresholdVerdeForte - thresholdVerdeClaro);
          // Interpola entre amarelo fraco (150k) e verde clarinho (155k)
          // Amarelo fraco: rgba(255, 235, 150, ...)
          // Verde clarinho: rgba(200, 255, 200, ...) - verde bem suave
          const red = Math.round(255 - (255 - 200) * normalized); // 255 a 200
          const green = Math.round(235 + (255 - 235) * normalized); // 235 a 255
          const blue = Math.round(150 + (200 - 150) * normalized); // 150 a 200
          const alpha = 0.5 + (0.2 * normalized); // 0.5 a 0.7
          return `rgba(${red}, ${green}, ${blue}, ${alpha})`;
        }
        
        // Acima de 155: vai esverdeando (verde mais forte)
        // Normaliza o valor entre 0 e 1 (onde 0 = 155k e 1 = 180k)
        const maxValido = 180000;
        const normalized = (value - thresholdVerdeForte) / (maxValido - thresholdVerdeForte);
        
        // Interpola entre verde clarinho (155k) e verde forte (180k)
        // Verde clarinho: rgba(200, 255, 200, ...)
        // Verde forte: rgba(34, 197, 94, ...)
        const red = Math.round(200 - (200 - 34) * normalized); // 200 a 34
        const green = Math.round(255 - (255 - 197) * normalized); // 255 a 197
        const blue = Math.round(200 - (200 - 94) * normalized); // 200 a 94
        const alpha = 0.6 + (0.4 * normalized); // Mais opaco para valores maiores
        
        return `rgba(${red}, ${green}, ${blue}, ${alpha})`;
      }
      
      // Labels dos meses
      const mesesLabels = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
      
      // Cria o cabe�alho da tabela
      let headerHTML = '<tr><th style="padding: 12px; text-align: left; background: #f8f9fa; border: 1px solid #dee2e6; font-weight: 600;">Ano</th>';
      mesesLabels.forEach(mes => {
        headerHTML += `<th style="padding: 12px; text-align: center; background: #f8f9fa; border: 1px solid #dee2e6; font-weight: 600;">${mes}</th>`;
      });
      headerHTML += '</tr>';
      tableHead.innerHTML = headerHTML;
      
      // Cria as linhas da tabela
      const anos = Object.keys(dadosPorAno).sort((a, b) => parseInt(b) - parseInt(a)); // Mais recente primeiro
      let bodyHTML = '';
      
      anos.forEach(ano => {
        bodyHTML += `<tr><td style="padding: 12px; text-align: left; background: #f8f9fa; border: 1px solid #dee2e6; font-weight: 600;">${ano}</td>`;
        
        dadosPorAno[ano].forEach((valor, mesIndex) => {
          const cor = getHeatmapColor(valor);
          const valorFormatado = valor !== null && valor !== undefined ? Math.round(valor).toLocaleString('pt-BR') : '-';
          bodyHTML += `<td style="padding: 12px; text-align: center; border: 1px solid #dee2e6; background-color: ${cor}; font-weight: 500;">${valorFormatado}</td>`;
        });
        
        bodyHTML += '</tr>';
      });
      
      tableBody.innerHTML = bodyHTML;
    }

    function buildExecutiveDashboard(beneficiariosData, usinaData) {
      const kpiContainer = document.getElementById('executiveKPIs');
      if (!kpiContainer) return;
      
      // Calcula KPIs da usina - considera valores positivos e descarta apenas outliers absurdos
      // Aumenta o limite para permitir valores maiores (até 10 milhões por mês)
      const usinaValida = (usinaData || []).filter(item => {
        const kwh = normalizeKwhValue(item.total_kwh_gerado);
        return kwh !== null && kwh !== undefined && kwh > 0 && kwh < 10000000;
      });
      
      const totalGeradoUsina = usinaValida.reduce((sum, item) => sum + normalizeKwhValue(item.total_kwh_gerado), 0);
      const mediaGeracaoUsina = usinaValida.length > 0 ? totalGeradoUsina / usinaValida.length : 0;
      
      // Encontra melhor e pior mês da usina
      let melhorMesUsina = null;
      let melhorMesValor = 0;
      let piorMesUsina = null;
      let piorMesValor = Infinity;
      
      usinaValida.forEach(item => {
        const kwh = normalizeKwhValue(item.total_kwh_gerado);
        if (kwh > melhorMesValor) {
          melhorMesValor = kwh;
          const partes = item.mes_ano.split('-');
          const mes = partes[1].padStart(2, '0');
          melhorMesUsina = `${mes}/${partes[0]}`;
        }
        if (kwh < piorMesValor) {
          piorMesValor = kwh;
          const partes = item.mes_ano.split('-');
          const mes = partes[1].padStart(2, '0');
          piorMesUsina = `${mes}/${partes[0]}`;
        }
      });
      
      const kpis = [
        {
          title: 'Total Gerado Usina',
          value: formatKwh(totalGeradoUsina),
          unit: '',
          color: 'var(--accent)'
        },
        {
          title: 'Média Geração Usina',
          value: formatKwh(mediaGeracaoUsina),
          unit: '',
          color: 'var(--accent)'
        },
        {
          title: 'Melhor Mês Usina',
          value: melhorMesUsina || 'N/A',
          unit: melhorMesUsina ? `(${formatKwh(melhorMesValor)})` : '',
          color: 'var(--positive)'
        },
        {
          title: 'Pior Mês Usina',
          value: piorMesUsina || 'N/A',
          unit: piorMesUsina ? `(${formatKwh(piorMesValor)})` : '',
          color: 'var(--negative)'
        }
      ];
      
      let html = '';
      kpis.forEach(kpi => {
        html += `
          <div class="executive-kpi-card" style="
            background: white;
            border: 2px solid ${kpi.color};
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s, box-shadow 0.2s;
          ">
            <div style="font-size: 0.9rem; color: #666; margin-bottom: 8px; font-weight: 500;">${kpi.title}</div>
            <div style="display: flex; align-items: baseline; gap: 8px; flex-wrap: wrap;">
              <div style="font-size: 2rem; font-weight: 700; color: ${kpi.color};">
                ${kpi.value}
              </div>
              ${kpi.unit ? `<span style="font-size: 1rem; color: #666;">${kpi.unit}</span>` : ''}
              ${kpi.percentage ? `<span style="font-size: 0.9rem; color: ${kpi.color}; font-weight: 600;">${kpi.percentage}</span>` : ''}
            </div>
          </div>
        `;
      });
      
      kpiContainer.innerHTML = html;
    }

    function buildUsinaPerformance(data) {
      const container = document.getElementById('usinaPerformanceContainer');
      if (!container) return;
      
      // Filtra apenas valores válidos (maiores que zero, descartando outliers absurdos)
      const dadosValidos = data.filter(item => {
        const kwh = normalizeKwhValue(item.total_kwh_gerado);
        return kwh !== null && kwh !== undefined && kwh > 0 && kwh < 1000000;
      });
      
      if (dadosValidos.length === 0) {
        container.innerHTML = '<p style="color: #666; padding: 16px;">Nenhum dado válido para análise.</p>';
        return;
      }
      
      // Agrupa por ano
      const dadosPorAno = {};
      dadosValidos.forEach(item => {
        const ano = item.ano;
        if (!dadosPorAno[ano]) {
          dadosPorAno[ano] = [];
        }
        dadosPorAno[ano].push({
          mesAno: item.mes_ano,
          kwhGerado: normalizeKwhValue(item.total_kwh_gerado)
        });
      });
      
      // Calcula m�tricas de performance
      const anos = Object.keys(dadosPorAno).sort((a, b) => parseInt(b) - parseInt(a));
      const performanceMetrics = [];
      
      anos.forEach(ano => {
        const registros = dadosPorAno[ano];
        const valores = registros.map(r => r.kwhGerado);
        const soma = valores.reduce((sum, v) => sum + v, 0);
        const media = soma / valores.length;
        const max = Math.max(...valores);
        const min = Math.min(...valores);
        const variacao = max - min;
        const coeficienteVariacao = media > 0 ? (variacao / media) * 100 : 0;
        
        // Crescimento em rela��o ao ano anterior
        const anoAnterior = parseInt(ano) - 1;
        let crescimento = null;
        if (dadosPorAno[anoAnterior]) {
          const somaAnoAnterior = dadosPorAno[anoAnterior].reduce((sum, r) => sum + r.kwhGerado, 0);
          crescimento = somaAnoAnterior > 0 ? ((soma - somaAnoAnterior) / somaAnoAnterior) * 100 : 0;
        }
        
        performanceMetrics.push({
          ano,
          soma,
          media,
          max,
          min,
          variacao,
          coeficienteVariacao,
          crescimento,
          meses: registros.length
        });
      });
      
      // Gera HTML
      let html = `
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
      `;
      
      performanceMetrics.forEach(metric => {
        html += `
          <div class="summary-card" style="flex: 1 1 300px; min-width: 280px;">
          <div class="summary-card-title">Análise ${metric.ano}</div>
            <div class="summary-card-content">
              <div class="summary-item">
                <span>Total Gerado:</span>
                <strong>${formatKwh(metric.soma)}</strong>
              </div>
              <div class="summary-item">
                <span>Média Mensal:</span>
                <strong>${formatKwh(metric.media)}</strong>
              </div>
              <div class="summary-item">
                <span>Máximo:</span>
                <strong style="color: var(--positive);">${formatKwh(metric.max)}</strong>
              </div>
              <div class="summary-item">
                <span>Mínimo:</span>
                <strong style="color: var(--negative);">${formatKwh(metric.min)}</strong>
              </div>
              <div class="summary-item">
                <span>Variação:</span>
                <strong>${formatKwh(metric.variacao)}</strong>
              </div>
              <div class="summary-item">
                <span>Coef. Variação:</span>
                <strong>${metric.coeficienteVariacao.toFixed(2)}%</strong>
              </div>
              ${metric.crescimento !== null ? `
                <div class="summary-item" style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #e5e7eb;">
                  <span>Crescimento vs ${metric.ano - 1}:</span>
                  <strong style="color: ${metric.crescimento >= 0 ? 'var(--positive)' : 'var(--negative)'};">
                    ${metric.crescimento >= 0 ? '+' : ''}${metric.crescimento.toFixed(2)}%
                  </strong>
                </div>
              ` : ''}
            </div>
          </div>
        `;
      });
      
      html += `</div>`;
      
      // Adiciona gr�fico de tend�ncia
      html += `
        <div style="margin-top: 32px;">
          <h3 style="font-size: 1.1rem; font-weight: 600; margin-bottom: 16px; color: var(--text);">
            Tendência de Geração (Média Mensal por Ano)
          </h3>
          <div class="chart-container" style="height: 300px;">
            <canvas id="usinaTrendChart" aria-label="Gráfico tendência geração usina" role="img"></canvas>
          </div>
        </div>
      `;
      
      container.innerHTML = html;
      
      // Cria gr�fico de tend�ncia
      setTimeout(() => {
        const ctx = document.getElementById('usinaTrendChart');
        if (ctx) {
          // Destr�i gr�fico anterior se existir
          if (usinaTrendChart) {
            usinaTrendChart.destroy();
            usinaTrendChart = null;
          }
          
          const trendData = performanceMetrics.map(m => ({
            ano: m.ano,
            media: m.media
          })).sort((a, b) => parseInt(a.ano) - parseInt(b.ano));
          
          usinaTrendChart = new Chart(ctx.getContext('2d'), {
            type: 'line',
            data: {
              labels: trendData.map(d => d.ano),
              datasets: [{
                label: 'Média Mensal (kWh)',
                data: trendData.map(d => d.media),
                borderColor: 'rgba(15, 155, 156, 1)',
                backgroundColor: 'rgba(15, 155, 156, 0.2)',
                tension: 0.4,
                borderWidth: 3,
                pointRadius: 6,
                pointBackgroundColor: 'rgba(15, 155, 156, 1)',
                fill: true
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: {
                  labels: {
                    color: '#0f2a24'
                  }
                },
                tooltip: {
                  callbacks: {
                    label: context => {
                      return `M�dia: ${formatKwh(context.parsed.y)}`;
                    }
                  }
                }
              },
              scales: {
                x: {
                  ticks: { color: '#0f2a24' },
                  grid: { display: false }
                },
                y: {
                  ticks: {
                    color: '#0f2a24',
                    callback: value => {
                      return formatKwh(value);
                    }
                  },
                  grid: {
                    color: 'rgba(15, 42, 36, 0.1)'
                  }
                }
              }
            }
          });
        }
      }, 100);
    }

    function buildUsinaSummary(data) {
      const yearSummaryContainer = document.getElementById('usinaYearSummary');
      const generalSummaryContainer = document.getElementById('usinaGeneralSummary');
      
      if (!yearSummaryContainer || !generalSummaryContainer) return;
      
      // Filtra apenas valores válidos (maiores que zero, descartando outliers absurdos)
      const dadosValidos = data.filter(item => {
        const kwhGerado = normalizeKwhValue(item.total_kwh_gerado);
        return kwhGerado !== null && kwhGerado !== undefined && kwhGerado > 0 && kwhGerado < 1000000;
      });
      
      if (dadosValidos.length === 0) {
        yearSummaryContainer.innerHTML = '<p style="color: #666; padding: 16px;">Nenhum dado válido para exibir.</p>';
        generalSummaryContainer.innerHTML = '';
        return;
      }
      
      // Agrupa por ano
      const dadosPorAno = {};
      const mesesLabels = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
      
      dadosValidos.forEach(item => {
        const mesAno = item.mes_ano;
        const partes = mesAno.split('-');
        const ano = parseInt(partes[0]);
        const mes = parseInt(partes[1]) - 1;
        const kwhGerado = normalizeKwhValue(item.total_kwh_gerado);
        
        if (!dadosPorAno[ano]) {
          dadosPorAno[ano] = [];
        }
        
        dadosPorAno[ano].push({
          mes,
          mesAno,
          kwhGerado,
          mesLabel: mesesLabels[mes]
        });
      });
      
      // Calcula estatísticas por ano
      const statsPorAno = {};
      Object.keys(dadosPorAno).sort((a, b) => parseInt(b) - parseInt(a)).forEach(ano => {
        const registros = dadosPorAno[ano];
        const valores = registros.map(r => r.kwhGerado);
        const soma = valores.reduce((sum, v) => sum + v, 0);
        const media = soma / valores.length;
        
        // Encontra melhor e pior m�s
        const melhorMes = registros.reduce((max, r) => r.kwhGerado > max.kwhGerado ? r : max, registros[0]);
        const piorMes = registros.reduce((min, r) => r.kwhGerado < min.kwhGerado ? r : min, registros[0]);
        
        statsPorAno[ano] = {
          media,
          melhorMes: melhorMes.mesLabel,
          melhorMesValor: melhorMes.kwhGerado,
          melhorMesAno: melhorMes.mesAno,
          piorMes: piorMes.mesLabel,
          piorMesValor: piorMes.kwhGerado,
          piorMesAno: piorMes.mesAno,
          total: soma
        };
      });
      
      // Gera caixas por ano
      let yearHTML = '';
      Object.keys(statsPorAno).forEach(ano => {
        const stats = statsPorAno[ano];
        yearHTML += `
          <div class="summary-card" style="flex: 1 1 300px; min-width: 280px; max-width: 400px;">
            <div class="summary-card-title">Ano ${ano}</div>
            <div class="summary-card-content">
              <div class="summary-item">
                <span>Média Gerada:</span>
                <strong>${formatKwh(stats.media)}</strong>
              </div>
              <div class="summary-item">
                <span>Total Gerado:</span>
                <strong>${formatKwh(stats.total)}</strong>
              </div>
              <div class="summary-item" style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #e5e7eb;">
                <span>Melhor Mês:</span>
                <strong style="color: var(--positive);">${stats.melhorMes} - ${formatKwh(stats.melhorMesValor)}</strong>
              </div>
              <div class="summary-item">
                <span>Pior Mês:</span>
                <strong style="color: var(--negative);">${stats.piorMes} - ${formatKwh(stats.piorMesValor)}</strong>
              </div>
            </div>
          </div>
        `;
      });
      yearSummaryContainer.innerHTML = yearHTML;
      
      // Calcula estat�sticas gerais
      // Ano que mais gerou (soma total)
      let anoMaisGerou = null;
      let maxTotalAno = 0;
      Object.keys(statsPorAno).forEach(ano => {
        if (statsPorAno[ano].total > maxTotalAno) {
          maxTotalAno = statsPorAno[ano].total;
          anoMaisGerou = ano;
        }
      });
      
      // Melhor mês/ano (maior geração individual)
      let melhorMesAno = null;
      let melhorMesAnoValor = 0;
      dadosValidos.forEach(item => {
        const kwhGerado = normalizeKwhValue(item.total_kwh_gerado);
        if (kwhGerado > melhorMesAnoValor) {
          melhorMesAnoValor = kwhGerado;
          const partes = item.mes_ano.split('-');
          melhorMesAno = {
            mes: mesesLabels[parseInt(partes[1]) - 1],
            ano: partes[0],
            mesAno: item.mes_ano
          };
        }
      });
      
      // Pior mês/ano (menor geração individual)
      let piorMesAno = null;
      let piorMesAnoValor = Infinity;
      dadosValidos.forEach(item => {
        const kwhGerado = normalizeKwhValue(item.total_kwh_gerado);
        if (kwhGerado < piorMesAnoValor) {
          piorMesAnoValor = kwhGerado;
          const partes = item.mes_ano.split('-');
          piorMesAno = {
            mes: mesesLabels[parseInt(partes[1]) - 1],
            ano: partes[0],
            mesAno: item.mes_ano
          };
        }
      });
      
      // Gera caixas gerais
      let generalHTML = '';
      
      if (anoMaisGerou) {
        generalHTML += `
          <div class="summary-card" style="flex: 1 1 300px; min-width: 280px; max-width: 400px;">
            <div class="summary-card-title">Ano que Mais Gerou</div>
            <div class="summary-card-content">
              <div class="summary-item">
                <span>Ano:</span>
                <strong style="color: var(--positive); font-size: 1.2em;">${anoMaisGerou}</strong>
              </div>
              <div class="summary-item">
                <span>Total Gerado:</span>
                <strong>${formatKwh(maxTotalAno)}</strong>
              </div>
            </div>
          </div>
        `;
      }
      
      if (melhorMesAno) {
        generalHTML += `
          <div class="summary-card" style="flex: 1 1 300px; min-width: 280px; max-width: 400px;">
            <div class="summary-card-title">Melhor Mês/Ano</div>
            <div class="summary-card-content">
              <div class="summary-item">
                <span>Período:</span>
                <strong style="color: var(--positive); font-size: 1.2em;">${melhorMesAno.mes}/${melhorMesAno.ano}</strong>
              </div>
              <div class="summary-item">
                <span>Geração:</span>
                <strong>${formatKwh(melhorMesAnoValor)}</strong>
              </div>
            </div>
          </div>
        `;
      }
      
      if (piorMesAno) {
        generalHTML += `
          <div class="summary-card" style="flex: 1 1 300px; min-width: 280px; max-width: 400px;">
            <div class="summary-card-title">Pior Mês/Ano</div>
            <div class="summary-card-content">
              <div class="summary-item">
                <span>Período:</span>
                <strong style="color: var(--negative); font-size: 1.2em;">${piorMesAno.mes}/${piorMesAno.ano}</strong>
              </div>
              <div class="summary-item">
                <span>Geração:</span>
                <strong>${formatKwh(piorMesAnoValor)}</strong>
              </div>
            </div>
          </div>
        `;
      }
      
      generalSummaryContainer.innerHTML = generalHTML;
    }

    function showAwaitingSelection() {
      if (diffCard) diffCard.style.display = 'none';
      insightsGrid.innerHTML = '';
      tableBody.innerHTML = '';
      tableBody.parentElement.style.display = 'none';
      emptyState.hidden = false;
      emptyState.textContent = 'Selecione um beneficiário ou aplique filtros para visualizar.';
      if (yearSummaryCard) yearSummaryCard.hidden = true;
      if (energiaChart) {
        updateChart(energiaChart, []);
      }
      // Se��es da usina sempre exibidas (n�o dependem dos filtros)
      const usinaData = loadUsinaData();
      if (!usinaChart) {
        usinaChart = buildUsinaChart(usinaData);
      } else {
        updateUsinaChart(usinaChart, usinaData);
      }
      buildUsinaTable(usinaData);
      buildUsinaSummary(usinaData);
      buildUsinaPerformance(usinaData);
      buildExecutiveDashboard([], usinaData);
    }

    function refreshDashboard() {
      const filters = getFilters();
      const hasFilters = hasActiveFilters(filters);

      // Se n�o houver filtros selecionados, mostra mensagem de aguardo
      if (!hasFilters) {
        showAwaitingSelection();
        // Mas sempre atualiza as se��es da usina (independente de filtros)
        const usinaData = loadUsinaData();
        if (!usinaChart) {
          usinaChart = buildUsinaChart(usinaData);
        } else {
          updateUsinaChart(usinaChart, usinaData);
        }
        buildUsinaTable(usinaData);
        buildUsinaSummary(usinaData);
        buildUsinaPerformance(usinaData);
        buildExecutiveDashboard([], usinaData);
        return;
      }

      // Aplica filtros e processa dados
      const filtered = applyFilters(rawData, filters);
      
      // Reconstr�i os perfis de benefici�rios com TODOS os dados (n�o apenas os filtrados)
      // para que a lista de benefici�rios mostre todas as op��es dispon�veis
      const selectedYears = getSelectedYears();
      // Só popula beneficiários se houver instalações selecionadas
      if (selectedFilters.instalacao.size > 0) {
        const selectedInstalacoes = selectedFilters.instalacao;
        benefProfiles = buildBeneficiaryProfiles(rawData, selectedYears, selectedInstalacoes);
        populateBenefCheckboxes(benefProfiles);
      } else {
        // Se não houver instalações selecionadas, limpa a lista de beneficiários
        const benefFilterContainer = selectElements.beneficiario;
        if (benefFilterContainer) {
          benefFilterContainer.innerHTML = '<p style="text-align: center; color: var(--muted); padding: 20px;">Selecione pelo menos uma instalação para ver os beneficiários.</p>';
        }
        selectedBeneficiarios = new Set();
        benefProfiles = [];
      }

      if (filtered.length === 0) {
        updateDiffCard({ totalDiferenca: 0, totalRecebido: 0 });
        insightsGrid.innerHTML = '';
        tableBody.innerHTML = '';
        emptyState.hidden = false;
        emptyState.textContent = 'Nenhum registro encontrado para os filtros selecionados.';
        if (yearSummaryCard) yearSummaryCard.hidden = true;
        energiaChart && updateChart(energiaChart, []);
        // Se��es da usina sempre exibidas (n�o dependem dos filtros)
        const usinaDataEmpty = loadUsinaData();
        if (!usinaChart) {
          usinaChart = buildUsinaChart(usinaDataEmpty);
        } else {
          updateUsinaChart(usinaChart, usinaDataEmpty);
        }
        buildUsinaTable(usinaDataEmpty);
        buildUsinaSummary(usinaDataEmpty);
        buildUsinaPerformance(usinaDataEmpty);
        buildExecutiveDashboard([], usinaDataEmpty);
        return;
      }

      const summary = summarize(filtered);
      updateDiffCard(summary);
      updateInsights(summary);
      updateTable(filtered);
      updateYearSummary(filtered);
      updateSummaryCards(filtered);
      
      // Inicializa ou atualiza o gr�fico
      if (!energiaChart) {
        energiaChart = buildChart(filtered);
      } else {
        updateChart(energiaChart, filtered);
      }
      
      // Carrega e exibe dados da usina (sempre exibido, independente dos filtros)
      const usinaData = loadUsinaData();
      if (!usinaChart) {
        usinaChart = buildUsinaChart(usinaData);
      } else {
        updateUsinaChart(usinaChart, usinaData);
      }
      // Atualiza a tabela com mapa de calor
      buildUsinaTable(usinaData);
      // Atualiza as caixas de resumo
      buildUsinaSummary(usinaData);
      // Atualiza an�lise de performance
      buildUsinaPerformance(usinaData);
      
      // Atualiza dashboard executivo
      buildExecutiveDashboard(filtered, usinaData);
      
      // Mostra a tabela se estava oculta
      tableBody.parentElement.style.display = 'table';
      emptyState.hidden = true;
    }

      // Popula filtros (parceiro, ano, mês, instalação, beneficiário)
      populateFilters(rawData);
      
      // Log para verificar estado dos Sets após populateFilters
      console.log('Após populateFilters:', {
        ano: selectedFilters.ano.size,
        mes: selectedFilters.mes.size,
        instalacao: selectedFilters.instalacao.size,
        valores: {
          mes: Array.from(selectedFilters.mes),
          instalacao: Array.from(selectedFilters.instalacao)
        }
      });

      // Seleciona automaticamente todos os anos na primeira carga
      const anoFilter = selectElements.ano;
      if (anoFilter && anoFilter.list) {
        const anoCheckboxes = anoFilter.list.querySelectorAll('input[type="checkbox"]');
        anoCheckboxes.forEach(cb => {
          cb.checked = true;
          selectedFilters.ano.add(String(cb.value));
        });
        if (anoFilter.all) {
          anoFilter.all.checked = true;
        }
        console.log('Anos inicializados:', Array.from(selectedFilters.ano));
      }

      // Carrega o dashboard já com os filtros aplicados
      // Os beneficiários serão selecionados automaticamente em populateBenefCheckboxes
      refreshDashboard();
      
      // Adiciona event listener ao bot�o "Aplicar Filtros"
      
      // Inicializa o gr�fico da usina (sempre exibido, independente dos filtros)
      const usinaData = loadUsinaData();
      usinaChart = buildUsinaChart(usinaData);
      buildUsinaTable(usinaData);
      buildUsinaSummary(usinaData);
      buildUsinaPerformance(usinaData);
      
      // Atualiza dashboard executivo
      buildExecutiveDashboard(rawData, usinaData);

      // Adiciona event listeners APÓS a inicialização dos filtros
      // Usa setTimeout para garantir que os valores já foram adicionados aos Sets
      setTimeout(() => {
        filtersForm.addEventListener('input', refreshDashboard);
        filtersForm.addEventListener('change', refreshDashboard);
      }, 100);
    }

    // ============================================
    // SEÇÃO 07 - CONTAS DE ENERGIA EDP
    // ============================================
    
    // Lista de PDFs disponíveis (será preenchida dinamicamente)
    const pdfFiles = [
      '1485359_SET_2025.pdf', '1485359_OUT_2025.pdf', '1485359_NOV_2025.pdf',
      '596654_SET_2025.pdf', '596654_OUT_2025.pdf', '596654_NOV_2025.pdf',
      '1506204_SET_2025.pdf', '1506204_OUT_2025.pdf', '1506204_NOV_2025.pdf',
      '634374_SET_2025.pdf', '634374_OUT_2025.pdf', '634374_NOV_2025.pdf',
      '506279_AGO_2025.pdf', '506279_SET_2025.pdf', '506279_NOV_2025.pdf',
      '1990889_SET_2025.pdf', '1990889_OUT_2025.pdf', '1990889_NOV_2025.pdf',
      '1921756_ABR_2024.pdf', '1921756_MAI_2024.pdf', '1921756_NOV_2025.pdf',
      '1921762_ABR_2024.pdf', '1921762_MAI_2024.pdf', '1921762_NOV_2025.pdf',
      '158059_SET_2025.pdf', '158059_NOV_2025.pdf', '158059_OUT_2025.pdf',
      '506281_SET_2025.pdf', '506281_OUT_2025.pdf', '506281_NOV_2025.pdf'
    ];

    // Função para extrair número de instalação do nome do arquivo
    function getInstalacaoFromFilename(filename) {
      const match = filename.match(/^(\d+)_/);
      return match ? match[1] : null;
    }

    // Função para formatar nome do arquivo para exibição
    function formatPdfName(filename) {
      // Remove extensão e número de instalação
      const withoutExt = filename.replace('.pdf', '');
      const parts = withoutExt.split('_');
      if (parts.length >= 2) {
        const mes = parts[1];
        const ano = parts[2] || '';
        const meses = {
          'JAN': 'Janeiro', 'FEV': 'Fevereiro', 'MAR': 'Março', 'ABR': 'Abril',
          'MAI': 'Maio', 'JUN': 'Junho', 'JUL': 'Julho', 'AGO': 'Agosto',
          'SET': 'Setembro', 'OUT': 'Outubro', 'NOV': 'Novembro', 'DEZ': 'Dezembro'
        };
        const mesNome = meses[mes] || mes;
        return `${mesNome} ${ano}`;
      }
      return filename;
    }

    // Função para agrupar PDFs por instalação
    function groupPdfsByInstalacao(pdfs) {
      const grouped = {};
      pdfs.forEach(pdf => {
        const instalacao = getInstalacaoFromFilename(pdf);
        if (instalacao) {
          if (!grouped[instalacao]) {
            grouped[instalacao] = [];
          }
          grouped[instalacao].push(pdf);
        }
      });
      return grouped;
    }

    // Função para obter nome do beneficiário pela instalação
    function getBeneficiarioByInstalacao(instalacao, data) {
      const beneficiario = data.find(b => {
        const instalacoes = Array.isArray(b.instalacao) ? b.instalacao : [b.instalacao];
        return instalacoes.includes(instalacao);
      });
      return beneficiario ? beneficiario.nome_beneficiario : `Instalação ${instalacao}`;
    }

    // Função para visualizar PDF (acessível globalmente)
    window.viewPdf = function(filename) {
      const modal = document.getElementById('pdfModal');
      const viewer = document.getElementById('pdfViewer');
      const pdfPath = `PDF/${filename}`;
      viewer.src = pdfPath;
      modal.style.display = 'block';
      document.body.style.overflow = 'hidden';
    };

    // Função para baixar PDF (acessível globalmente)
    window.downloadPdf = function(filename) {
      const pdfPath = `PDF/${filename}`;
      const link = document.createElement('a');
      link.href = pdfPath;
      link.download = filename;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    };

    // Função para construir a seção de Contas EDP
    // IMPORTANTE: Esta seção sempre mostra TODOS os PDFs disponíveis, 
    // independente dos filtros aplicados no dashboard
    function buildContasEdpSection() {
      try {
        const container = document.getElementById('contasEdpContainer');
        if (!container) {
          console.error('Container contasEdpContainer não encontrado!');
          return;
        }

        // Carrega TODOS os dados dos beneficiários (não filtrados)
        // Isso garante que todos os PDFs sejam sempre exibidos
        const rawData = loadDashboardData();
        
        if (!rawData || rawData.length === 0) {
          container.innerHTML = '<p style="text-align: center; color: var(--muted); padding: 40px;">Nenhum dado disponível para exibir contas.</p>';
          return;
        }

        // Verifica se pdfFiles está definido
        if (!pdfFiles || pdfFiles.length === 0) {
          container.innerHTML = '<p style="text-align: center; color: var(--muted); padding: 40px;">Nenhum PDF disponível.</p>';
          return;
        }

        // Agrupa PDFs por instalação
        const pdfsByInstalacao = groupPdfsByInstalacao(pdfFiles);

        // Agrupa beneficiários por instalação (garantindo que seja string)
        const beneficiariosByInstalacao = {};
        rawData.forEach(item => {
          // Converte para string para garantir comparação correta
          const instalacao = String(item.instalacao || '').trim();
          if (instalacao && !beneficiariosByInstalacao[instalacao]) {
            beneficiariosByInstalacao[instalacao] = {
              nome: item.nome_beneficiario || `Instalação ${instalacao}`,
              instalacao: instalacao
            };
          }
        });

        // Cria cards para cada beneficiário que tem PDFs
        const cards = [];
        Object.keys(pdfsByInstalacao).forEach(instalacao => {
          // Garante que a instalação seja string para comparação
          const instalacaoStr = String(instalacao).trim();
          const beneficiario = beneficiariosByInstalacao[instalacaoStr];
          const nome = beneficiario ? beneficiario.nome : `Instalação ${instalacaoStr}`;
          const pdfs = pdfsByInstalacao[instalacao].sort();

          const card = `
            <div class="pdf-benef-card">
              <div class="pdf-benef-header">
                <div class="benef-primary">
                  <strong>${nome}</strong>
                  <span>Instalação ${instalacaoStr}</span>
                </div>
              </div>
              <div class="pdf-list">
                ${pdfs.map(pdf => {
                  const pdfName = formatPdfName(pdf);
                  // Escapa aspas no nome do arquivo para evitar problemas no HTML
                  const pdfEscaped = pdf.replace(/'/g, "\\'").replace(/"/g, '&quot;');
                  return `
                    <div class="pdf-item">
                      <span class="pdf-item-name">${pdfName}</span>
                      <div class="pdf-item-actions">
                        <button class="pdf-btn" onclick="viewPdf('${pdfEscaped}')" title="Visualizar PDF">
                          Visualizar
                        </button>
                      </div>
                    </div>
                  `;
                }).join('')}
              </div>
            </div>
          `;
          cards.push(card);
        });

        if (cards.length === 0) {
          container.innerHTML = '<p style="text-align: center; color: var(--muted); padding: 40px;">Nenhum PDF disponível para as instalações encontradas.</p>';
        } else {
          container.innerHTML = cards.join('');
        }
      } catch (error) {
        console.error('Erro ao construir seção de Contas EDP:', error);
        const container = document.getElementById('contasEdpContainer');
        if (container) {
          container.innerHTML = '<p style="text-align: center; color: var(--muted); padding: 40px;">Erro ao carregar contas. Verifique o console para mais detalhes.</p>';
        }
      }
    }

    // Função global para fechar o modal (acessível via onclick)
    window.closePdfModal = function() {
      const modal = document.getElementById('pdfModal');
      if (modal) {
        modal.style.display = 'none';
        document.body.style.overflow = '';
        const viewer = document.getElementById('pdfViewer');
        if (viewer) {
          viewer.src = '';
        }
      }
    };

    // Configura modal de PDF
    function setupPdfModal() {
      const modal = document.getElementById('pdfModal');
      const closeBtn = document.getElementById('closePdfModal');

      // Função para fechar o modal
      function closeModal() {
        if (modal) {
          modal.style.display = 'none';
          document.body.style.overflow = '';
          const viewer = document.getElementById('pdfViewer');
          if (viewer) {
            viewer.src = '';
          }
        }
      }

      if (closeBtn) {
        // Adiciona event listener diretamente ao botão
        closeBtn.onclick = function(e) {
          e.preventDefault();
          e.stopPropagation();
          closeModal();
          return false;
        };
      }

      // Fecha modal ao clicar fora (mas não no botão ou no iframe)
      if (modal) {
        modal.addEventListener('click', function(e) {
          // Fecha apenas se clicar diretamente no modal (background), não nos filhos
          if (e.target === modal) {
            closeModal();
          }
        });
      }

      // Fecha modal com ESC
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && modal && modal.style.display === 'block') {
          closeModal();
        }
      });
    }

    // Inicializa o dashboard quando o DOM estiver pronto
    console.log('Script carregado. Estado do DOM:', document.readyState);
    
    function initializeAll() {
      initDashboard();
      setupPdfModal();
      // Aguarda um pouco para garantir que o initDashboard terminou e os dados estão carregados
      setTimeout(() => {
        try {
          buildContasEdpSection();
        } catch (error) {
          console.error('Erro ao inicializar seção de Contas EDP:', error);
          // Tenta novamente após mais um segundo
          setTimeout(() => {
            buildContasEdpSection();
          }, 1000);
        }
      }, 1000);
    }
    
    if (document.readyState === 'loading') {
      console.log('Aguardando DOMContentLoaded...');
      document.addEventListener('DOMContentLoaded', function() {
        console.log('DOMContentLoaded disparado. Inicializando dashboard...');
        initializeAll();
      });
    } else {
      // DOM já está pronto
      console.log('DOM já está pronto. Inicializando dashboard imediatamente...');
      initializeAll();
    }
    
    // Também tenta carregar quando a página estiver completamente carregada
    window.addEventListener('load', function() {
      setTimeout(() => {
        const container = document.getElementById('contasEdpContainer');
        if (container && (!container.innerHTML || container.innerHTML.includes('serão inseridos aqui'))) {
          console.log('Tentando carregar Contas EDP novamente após load...');
          buildContasEdpSection();
        }
      }, 1500);
    });

    // Função para scroll suave ao topo da página
    function scrollToTop() {
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    }
  </script>
  
  <!-- Botão Topo antes do footer -->
  <div style="text-align: center; padding: 20px 24px;">
    <button class="btn-topo" onclick="scrollToTop()">⬆️ Topo</button>
  </div>
  
  <footer style="text-align: center; padding: 40px 24px 24px;">
    <img src="logo_sisgdsolar.png" alt="SISGDSOLAR - Energia Limpa Inteligente" class="footer-logo">
  </footer>
</body>
</html>