<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard de Energia - UAINE Group</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --bg: #f4fbf7;
      --card: #ffffff;
      --card-alt: #e9f6ef;
      --border: #c6e4d6;
      --accent: #0f9b9c;
      --accent-strong: #0d7c83;
      --positive: #22c55e;
      --negative: #ef4444;
      --text: #0f2a24;
      --muted: #5f7468;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: radial-gradient(120% 120% at 50% 0%, #b9f3d5 0%, var(--bg) 60%);
      color: var(--text);
      min-height: 100vh;
      padding: 24px;
    }

    header {
      max-width: 1200px;
      margin: 0 auto 32px auto;
      text-align: center;
    }

    header h1 {
      margin: 0;
      font-size: 2.25rem;
      font-weight: 700;
    }

    .header-metric {
      margin: 12px auto 0 auto;
      max-width: 720px;
      color: var(--muted);
      font-weight: 600;
      letter-spacing: 0.03em;
    }

    main {
      max-width: 1200px;
      margin: 0 auto 80px auto;
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    section {
      background: rgba(255, 255, 255, 0.95);
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 24px;
      box-shadow: 0 25px 70px rgba(15, 41, 36, 0.12);
      backdrop-filter: blur(8px);
    }

    .section-title {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 18px;
      font-size: 1.1rem;
      font-weight: 600;
    }

    .section-title span {
      width: 34px;
      height: 34px;
      border-radius: 10px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background: rgba(15, 155, 156, 0.18);
      color: var(--accent);
      font-weight: 700;
    }

    .filters-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 16px;
    }

    .field-full {
      grid-column: 1 / -1;
    }

    .field-full select {
      width: 100%;
    }

    .checkbox-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
      background: var(--card-alt);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px;
      max-height: 320px;
      overflow-y: auto;
    }

    .checkbox-item {
      display: flex;
      gap: 12px;
      padding: 12px;
      border: 1px solid rgba(15, 155, 156, 0.12);
      border-radius: 12px;
      background: #fff;
      box-shadow: 0 6px 18px rgba(15, 41, 36, 0.08);
    }

    .checkbox-item.checkbox-all {
      align-items: center;
      justify-content: start;
      font-weight: 600;
      gap: 10px;
    }

    .checkbox-item input {
      accent-color: var(--accent);
      width: 18px;
      height: 18px;
      flex-shrink: 0;
      margin-top: 4px;
    }

    .checkbox-meta {
      display: flex;
      flex-direction: column;
      gap: 6px;
      width: 100%;
    }

    .benef-primary {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.95rem;
      color: var(--text);
    }

    .benef-primary span {
      font-size: 0.85rem;
      color: var(--muted);
    }

    .benef-metrics {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 4px 12px;
      font-size: 0.82rem;
      color: var(--muted);
    }

    .benef-metrics strong {
      color: var(--text);
    }

    .data-context {
      font-size: 0.85rem;
      color: var(--muted);
      margin: 8px 0 18px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .data-context::before {
      content: '';
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: var(--accent);
      display: inline-block;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    label {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.04em;
      color: var(--muted);
    }

    select, input {
      background: var(--card-alt);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 10px 12px;
      color: var(--text);
      font-size: 0.95rem;
      transition: border 0.2s ease, box-shadow 0.2s ease;
    }

    select:focus, input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 2px rgba(15, 155, 156, 0.2);
    }

    button {
      background: linear-gradient(120deg, var(--accent), #4ade80);
      border: none;
      border-radius: 12px;
      color: #fff;
      font-weight: 600;
      font-size: 0.95rem;
      padding: 12px 18px;
      cursor: pointer;
      margin-top: 8px;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 12px 30px rgba(15, 155, 156, 0.3);
    }

    .highlight-card {
      display: flex;
      flex-direction: column;
      gap: 8px;
      padding: 20px;
      border-radius: 16px;
      background: linear-gradient(135deg, #e4fff5 0%, #ffffff 60%);
      border: 1px solid var(--border);
      margin-bottom: 16px;
    }

    .highlight-card[data-state="positive"] {
      border-color: rgba(34, 197, 94, 0.6);
      box-shadow: 0 10px 32px rgba(34, 197, 94, 0.2);
    }

    .highlight-card[data-state="negative"] {
      border-color: rgba(239, 68, 68, 0.5);
      box-shadow: 0 10px 32px rgba(239, 68, 68, 0.18);
    }

    .highlight-card small {
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-weight: 600;
      color: var(--muted);
    }

    .highlight-card strong {
      font-size: 2rem;
      letter-spacing: -0.02em;
    }

    .highlight-card p {
      margin: 0;
      color: var(--muted);
    }

    .chart-container {
      position: relative;
      width: 100%;
      min-height: 320px;
    }

    .insights-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(190px, 1fr));
      gap: 16px;
    }

    .insight-card {
      background: linear-gradient(135deg, #fcfffd 0%, #e8f8f1 80%);
      border: 1px solid rgba(15, 155, 156, 0.12);
      border-radius: 14px;
      padding: 20px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      align-items: center;
      text-align: center;
      gap: 10px;
      min-height: 150px;
    }

    .insight-card span {
      font-size: 0.8rem;
      color: var(--muted);
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }

    .insight-card strong {
      font-size: 1.6rem;
      font-weight: 600;
    }

    .insight-card p {
      margin: 0;
      font-size: 0.85rem;
      color: var(--muted);
    }

    .table-wrapper {
      margin-top: 20px;
      border-radius: 14px;
      border: 1px solid var(--border);
      overflow: hidden;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.9rem;
    }

    thead {
      background: var(--card-alt);
    }

    th, td {
      padding: 12px 14px;
      text-align: left;
      border-bottom: 1px solid rgba(15, 42, 36, 0.08);
    }

    tbody tr:hover {
      background: rgba(15, 155, 156, 0.12);
    }

    .empty-state {
      text-align: center;
      padding: 40px 0;
      color: var(--muted);
    }

    @media (max-width: 640px) {
      body {
        padding: 16px;
      }
      section {
        padding: 18px;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Analítica de Energia Contratada vs Recebida</h1>
    <p id="instalacoesIndicator" class="header-metric">Instalações monitoradas: 0</p>
  </header>

  <main>
    <section>
      <div class="section-title">
        <span>01</span>
        <div>Filtros inteligentes</div>
      </div>
      <form id="filters" class="filters-grid">
        <div class="field">
          <label for="anoFilter">Ano</label>
          <select id="anoFilter">
            <option value="">Todos</option>
          </select>
        </div>
        <div class="field">
          <label for="semestreFilter">Semestre</label>
          <select id="semestreFilter">
            <option value="">Todos</option>
          </select>
        </div>
        <div class="field">
          <label for="mesFilter">Mês / Ano</label>
          <select id="mesFilter">
            <option value="">Todos</option>
          </select>
        </div>
        <div class="field">
          <label for="instalacaoFilter">Instalação</label>
          <select id="instalacaoFilter">
            <option value="">Todas</option>
          </select>
        </div>
        <div class="field field-full">
          <label for="benefFilter">Beneficiário</label>
          <div id="benefFilter" class="checkbox-list"></div>
        </div>
        <button type="reset">Limpar filtros</button>
      </form>
    </section>

    <section>
      <div class="highlight-card" id="diffCard" data-state="positive">
        <small>Balanço recebido x contratado</small>
        <strong id="diffValue">0 kWh</strong>
        <p id="diffLegend">Nenhum filtro aplicado</p>
      </div>
          <p class="data-context" data-benef-usage>Selecione beneficiários para visualizar os dados.</p>
      <div class="section-title">
        <span>02</span>
        <div>Distribuição mensal</div>
      </div>
      <div class="chart-container">
        <canvas id="energiaChart" aria-label="Gráfico contratado vs recebido" role="img"></canvas>
      </div>
          <p class="data-context" data-benef-usage>Selecione beneficiários para visualizar os dados.</p>
    </section>

    <section>
      <div class="section-title">
        <span>03</span>
        <div>Insights-chave (12 meses)</div>
      </div>
          <p class="data-context" data-benef-usage>Selecione beneficiários para visualizar os dados.</p>
      <div class="insights-grid" id="insightsGrid">
        <!-- preenchido via JS -->
      </div>
          <p class="data-context" data-benef-usage>Selecione beneficiários para visualizar os dados.</p>
      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>Mês/Ano</th>
              <th>Instalação</th>
              <th>Beneficiário</th>
                      <th>kWh contratado</th>
              <th>kWh recebido</th>
              <th>Diferença</th>
              <th>Mensalidade (R$)</th>
            </tr>
          </thead>
          <tbody id="tableBody">
            <!-- preenchido via JS -->
          </tbody>
        </table>
        <div class="empty-state" id="emptyState" hidden>
          Nenhum registro encontrado para os filtros selecionados.
        </div>
      </div>
    </section>
  </main>

  <script>
    const rawData = [{"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-01-01", "instalacao": "506279", "cpf_cnpj_beneficiario": "39275789000129", "nome_beneficiario": "PIZZARIA D´AMPEZZO LTDA", "kWhDisponibilizadosMes": 2050.0, "valorMensalidade": 2133.72, "edp_total_kwh": 2314, "edp_dif_recebidos_x_contratado": 264.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-01-01", "instalacao": "506281", "cpf_cnpj_beneficiario": "27320134000146", "nome_beneficiario": "BAR E RESTAURANTE PIRAO LTDA ME", "kWhDisponibilizadosMes": 6495.0, "valorMensalidade": 6574.0, "edp_total_kwh": 7091, "edp_dif_recebidos_x_contratado": 596.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-01-01", "instalacao": "596654", "cpf_cnpj_beneficiario": "36224796000103", "nome_beneficiario": "UGO RESTAURANTE LTDA", "kWhDisponibilizadosMes": 500.0, "valorMensalidade": 459.38, "edp_total_kwh": 4643, "edp_dif_recebidos_x_contratado": 4143.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-01-01", "instalacao": "634374", "cpf_cnpj_beneficiario": "07688213000105", "nome_beneficiario": "SCM-COMERCIO DE PRESENTES LTDA", "kWhDisponibilizadosMes": 1355.0, "valorMensalidade": 1396.21, "edp_total_kwh": 1503, "edp_dif_recebidos_x_contratado": 148.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-01-01", "instalacao": "1506204", "cpf_cnpj_beneficiario": "16642060000148", "nome_beneficiario": "RESTAURANTE CANTO DA PRAIA LTDA ME", "kWhDisponibilizadosMes": 8500.0, "valorMensalidade": 8276.88, "edp_total_kwh": 8904, "edp_dif_recebidos_x_contratado": 404.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-01-01", "instalacao": "1921756", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 3780.0, "valorMensalidade": 3809.72, "edp_total_kwh": 4113, "edp_dif_recebidos_x_contratado": 333.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-01-01", "instalacao": "1921762", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 2076.0, "valorMensalidade": 2076.03, "edp_total_kwh": 2240, "edp_dif_recebidos_x_contratado": 164.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-01-01", "instalacao": "1990889", "cpf_cnpj_beneficiario": "39741461000150", "nome_beneficiario": "DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA", "kWhDisponibilizadosMes": 1090.0, "valorMensalidade": 1101.9, "edp_total_kwh": 1194, "edp_dif_recebidos_x_contratado": 104.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-02-01", "instalacao": "506279", "cpf_cnpj_beneficiario": "39275789000129", "nome_beneficiario": "PIZZARIA D´AMPEZZO LTDA", "kWhDisponibilizadosMes": 2050.0, "valorMensalidade": 2133.72, "edp_total_kwh": 2113, "edp_dif_recebidos_x_contratado": 63.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-02-01", "instalacao": "506281", "cpf_cnpj_beneficiario": "27320134000146", "nome_beneficiario": "BAR E RESTAURANTE PIRAO LTDA ME", "kWhDisponibilizadosMes": 6495.0, "valorMensalidade": 6574.0, "edp_total_kwh": 6476, "edp_dif_recebidos_x_contratado": -19.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-02-01", "instalacao": "596654", "cpf_cnpj_beneficiario": "36224796000103", "nome_beneficiario": "UGO RESTAURANTE LTDA", "kWhDisponibilizadosMes": 500.0, "valorMensalidade": 459.38, "edp_total_kwh": 4241, "edp_dif_recebidos_x_contratado": 3741.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-02-01", "instalacao": "634374", "cpf_cnpj_beneficiario": "07688213000105", "nome_beneficiario": "SCM-COMERCIO DE PRESENTES LTDA", "kWhDisponibilizadosMes": 1355.0, "valorMensalidade": 1396.21, "edp_total_kwh": 1373, "edp_dif_recebidos_x_contratado": 18.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-02-01", "instalacao": "1485359", "cpf_cnpj_beneficiario": "52805088000112", "nome_beneficiario": "BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA", "kWhDisponibilizadosMes": 7300.0, "valorMensalidade": 7295.02, "edp_total_kwh": 10596, "edp_dif_recebidos_x_contratado": 3296.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-02-01", "instalacao": "1506204", "cpf_cnpj_beneficiario": "16642060000148", "nome_beneficiario": "RESTAURANTE CANTO DA PRAIA LTDA ME", "kWhDisponibilizadosMes": 8500.0, "valorMensalidade": 8276.88, "edp_total_kwh": 8132, "edp_dif_recebidos_x_contratado": -368.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-02-01", "instalacao": "1921756", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 3780.0, "valorMensalidade": 3809.72, "edp_total_kwh": 3756, "edp_dif_recebidos_x_contratado": -24.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-02-01", "instalacao": "1921762", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 2076.0, "valorMensalidade": 2076.03, "edp_total_kwh": 2046, "edp_dif_recebidos_x_contratado": -30.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-02-01", "instalacao": "1990889", "cpf_cnpj_beneficiario": "39741461000150", "nome_beneficiario": "DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA", "kWhDisponibilizadosMes": 1090.0, "valorMensalidade": 1101.9, "edp_total_kwh": 1090, "edp_dif_recebidos_x_contratado": 0.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-03-01", "instalacao": "506279", "cpf_cnpj_beneficiario": "39275789000129", "nome_beneficiario": "PIZZARIA D´AMPEZZO LTDA", "kWhDisponibilizadosMes": 2050.0, "valorMensalidade": 2133.72, "edp_total_kwh": 2775, "edp_dif_recebidos_x_contratado": 725.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-03-01", "instalacao": "506281", "cpf_cnpj_beneficiario": "27320134000146", "nome_beneficiario": "BAR E RESTAURANTE PIRAO LTDA ME", "kWhDisponibilizadosMes": 6495.0, "valorMensalidade": 6574.0, "edp_total_kwh": 8502, "edp_dif_recebidos_x_contratado": 2007.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-03-01", "instalacao": "596654", "cpf_cnpj_beneficiario": "36224796000103", "nome_beneficiario": "UGO RESTAURANTE LTDA", "kWhDisponibilizadosMes": 500.0, "valorMensalidade": 459.38, "edp_total_kwh": 5567, "edp_dif_recebidos_x_contratado": 5067.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-03-01", "instalacao": "634374", "cpf_cnpj_beneficiario": "07688213000105", "nome_beneficiario": "SCM-COMERCIO DE PRESENTES LTDA", "kWhDisponibilizadosMes": 1355.0, "valorMensalidade": 1396.21, "edp_total_kwh": 1802, "edp_dif_recebidos_x_contratado": 447.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-03-01", "instalacao": "1485359", "cpf_cnpj_beneficiario": "52805088000112", "nome_beneficiario": "BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA", "kWhDisponibilizadosMes": 7300.0, "valorMensalidade": 7295.02, "edp_total_kwh": 13910, "edp_dif_recebidos_x_contratado": 6610.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-03-01", "instalacao": "1506204", "cpf_cnpj_beneficiario": "16642060000148", "nome_beneficiario": "RESTAURANTE CANTO DA PRAIA LTDA ME", "kWhDisponibilizadosMes": 8500.0, "valorMensalidade": 8276.88, "edp_total_kwh": 10676, "edp_dif_recebidos_x_contratado": 2176.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-03-01", "instalacao": "1921756", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 3780.0, "valorMensalidade": 3809.72, "edp_total_kwh": 4931, "edp_dif_recebidos_x_contratado": 1151.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-03-01", "instalacao": "1921762", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 2076.0, "valorMensalidade": 2076.03, "edp_total_kwh": 2686, "edp_dif_recebidos_x_contratado": 610.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-03-01", "instalacao": "1990889", "cpf_cnpj_beneficiario": "39741461000150", "nome_beneficiario": "DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA", "kWhDisponibilizadosMes": 1090.0, "valorMensalidade": 1101.9, "edp_total_kwh": 1431, "edp_dif_recebidos_x_contratado": 341.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-04-01", "instalacao": "506279", "cpf_cnpj_beneficiario": "39275789000129", "nome_beneficiario": "PIZZARIA D´AMPEZZO LTDA", "kWhDisponibilizadosMes": 2050.0, "valorMensalidade": 2133.72, "edp_total_kwh": 2456, "edp_dif_recebidos_x_contratado": 406.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-04-01", "instalacao": "506281", "cpf_cnpj_beneficiario": "27320134000146", "nome_beneficiario": "BAR E RESTAURANTE PIRAO LTDA ME", "kWhDisponibilizadosMes": 6495.0, "valorMensalidade": 6574.0, "edp_total_kwh": 7527, "edp_dif_recebidos_x_contratado": 1032.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-04-01", "instalacao": "596654", "cpf_cnpj_beneficiario": "36224796000103", "nome_beneficiario": "UGO RESTAURANTE LTDA", "kWhDisponibilizadosMes": 500.0, "valorMensalidade": 459.38, "edp_total_kwh": 4929, "edp_dif_recebidos_x_contratado": 4429.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-04-01", "instalacao": "634374", "cpf_cnpj_beneficiario": "07688213000105", "nome_beneficiario": "SCM-COMERCIO DE PRESENTES LTDA", "kWhDisponibilizadosMes": 1355.0, "valorMensalidade": 1396.21, "edp_total_kwh": 1596, "edp_dif_recebidos_x_contratado": 241.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-04-01", "instalacao": "1485359", "cpf_cnpj_beneficiario": "52805088000112", "nome_beneficiario": "BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA", "kWhDisponibilizadosMes": 7300.0, "valorMensalidade": 7295.02, "edp_total_kwh": 12315, "edp_dif_recebidos_x_contratado": 5015.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-04-01", "instalacao": "1506204", "cpf_cnpj_beneficiario": "16642060000148", "nome_beneficiario": "RESTAURANTE CANTO DA PRAIA LTDA ME", "kWhDisponibilizadosMes": 8500.0, "valorMensalidade": 8276.88, "edp_total_kwh": 9452, "edp_dif_recebidos_x_contratado": 952.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-04-01", "instalacao": "1921756", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 3780.0, "valorMensalidade": 3809.72, "edp_total_kwh": 4366, "edp_dif_recebidos_x_contratado": 586.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-04-01", "instalacao": "1921762", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 2076.0, "valorMensalidade": 2076.03, "edp_total_kwh": 2378, "edp_dif_recebidos_x_contratado": 302.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-04-01", "instalacao": "1990889", "cpf_cnpj_beneficiario": "39741461000150", "nome_beneficiario": "DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA", "kWhDisponibilizadosMes": 1090.0, "valorMensalidade": 1101.9, "edp_total_kwh": 1267, "edp_dif_recebidos_x_contratado": 177.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-05-01", "instalacao": "506279", "cpf_cnpj_beneficiario": "39275789000129", "nome_beneficiario": "PIZZARIA D´AMPEZZO LTDA", "kWhDisponibilizadosMes": 2050.0, "valorMensalidade": 2133.72, "edp_total_kwh": 2039, "edp_dif_recebidos_x_contratado": -11.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-05-01", "instalacao": "506281", "cpf_cnpj_beneficiario": "27320134000146", "nome_beneficiario": "BAR E RESTAURANTE PIRAO LTDA ME", "kWhDisponibilizadosMes": 6495.0, "valorMensalidade": 6574.0, "edp_total_kwh": 6474, "edp_dif_recebidos_x_contratado": -21.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-05-01", "instalacao": "596654", "cpf_cnpj_beneficiario": "36224796000103", "nome_beneficiario": "UGO RESTAURANTE LTDA", "kWhDisponibilizadosMes": 500.0, "valorMensalidade": 459.38, "edp_total_kwh": 494, "edp_dif_recebidos_x_contratado": -6.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-05-01", "instalacao": "634374", "cpf_cnpj_beneficiario": "07688213000105", "nome_beneficiario": "SCM-COMERCIO DE PRESENTES LTDA", "kWhDisponibilizadosMes": 1355.0, "valorMensalidade": 1396.21, "edp_total_kwh": 1344, "edp_dif_recebidos_x_contratado": -11.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-05-01", "instalacao": "1485359", "cpf_cnpj_beneficiario": "52805088000112", "nome_beneficiario": "BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA", "kWhDisponibilizadosMes": 7300.0, "valorMensalidade": 7295.02, "edp_total_kwh": 7277, "edp_dif_recebidos_x_contratado": -23.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-05-01", "instalacao": "1506204", "cpf_cnpj_beneficiario": "16642060000148", "nome_beneficiario": "RESTAURANTE CANTO DA PRAIA LTDA ME", "kWhDisponibilizadosMes": 8500.0, "valorMensalidade": 8276.88, "edp_total_kwh": 8467, "edp_dif_recebidos_x_contratado": -33.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-05-01", "instalacao": "1921756", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 3780.0, "valorMensalidade": 3809.72, "edp_total_kwh": 3770, "edp_dif_recebidos_x_contratado": -10.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-05-01", "instalacao": "1921762", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 2076.0, "valorMensalidade": 2076.03, "edp_total_kwh": 2070, "edp_dif_recebidos_x_contratado": -6.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-05-01", "instalacao": "1990889", "cpf_cnpj_beneficiario": "39741461000150", "nome_beneficiario": "DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA", "kWhDisponibilizadosMes": 1090.0, "valorMensalidade": 1101.9, "edp_total_kwh": 1081, "edp_dif_recebidos_x_contratado": -9.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-06-01", "instalacao": "506279", "cpf_cnpj_beneficiario": "39275789000129", "nome_beneficiario": "PIZZARIA D´AMPEZZO LTDA", "kWhDisponibilizadosMes": 2050.0, "valorMensalidade": 2133.72, "edp_total_kwh": 1660, "edp_dif_recebidos_x_contratado": -390.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-06-01", "instalacao": "506281", "cpf_cnpj_beneficiario": "27320134000146", "nome_beneficiario": "BAR E RESTAURANTE PIRAO LTDA ME", "kWhDisponibilizadosMes": 6495.0, "valorMensalidade": 6574.0, "edp_total_kwh": 5238, "edp_dif_recebidos_x_contratado": -1257.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-06-01", "instalacao": "596654", "cpf_cnpj_beneficiario": "36224796000103", "nome_beneficiario": "UGO RESTAURANTE LTDA", "kWhDisponibilizadosMes": 500.0, "valorMensalidade": 459.38, "edp_total_kwh": 399, "edp_dif_recebidos_x_contratado": -101.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-06-01", "instalacao": "634374", "cpf_cnpj_beneficiario": "07688213000105", "nome_beneficiario": "SCM-COMERCIO DE PRESENTES LTDA", "kWhDisponibilizadosMes": 1355.0, "valorMensalidade": 1396.21, "edp_total_kwh": 1094, "edp_dif_recebidos_x_contratado": -261.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-06-01", "instalacao": "1485359", "cpf_cnpj_beneficiario": "52805088000112", "nome_beneficiario": "BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA", "kWhDisponibilizadosMes": 7300.0, "valorMensalidade": 7295.02, "edp_total_kwh": 5895, "edp_dif_recebidos_x_contratado": -1405.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-06-01", "instalacao": "1506204", "cpf_cnpj_beneficiario": "16642060000148", "nome_beneficiario": "RESTAURANTE CANTO DA PRAIA LTDA ME", "kWhDisponibilizadosMes": 8500.0, "valorMensalidade": 8276.88, "edp_total_kwh": 6860, "edp_dif_recebidos_x_contratado": -1640.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-06-01", "instalacao": "1921756", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 3780.0, "valorMensalidade": 3809.72, "edp_total_kwh": 3050, "edp_dif_recebidos_x_contratado": -730.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-06-01", "instalacao": "1921762", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 2076.0, "valorMensalidade": 2076.03, "edp_total_kwh": 1673, "edp_dif_recebidos_x_contratado": -403.0}, {"ano": 2024, "semestre": "Semestre_1_2024", "mes_ano": "2024-06-01", "instalacao": "1990889", "cpf_cnpj_beneficiario": "39741461000150", "nome_beneficiario": "DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA", "kWhDisponibilizadosMes": 1090.0, "valorMensalidade": 1101.9, "edp_total_kwh": 875, "edp_dif_recebidos_x_contratado": -215.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-07-01", "instalacao": "506279", "cpf_cnpj_beneficiario": "39275789000129", "nome_beneficiario": "PIZZARIA D´AMPEZZO LTDA", "kWhDisponibilizadosMes": 2050.0, "valorMensalidade": 2133.72, "edp_total_kwh": 1745, "edp_dif_recebidos_x_contratado": -305.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-07-01", "instalacao": "506281", "cpf_cnpj_beneficiario": "27320134000146", "nome_beneficiario": "BAR E RESTAURANTE PIRAO LTDA ME", "kWhDisponibilizadosMes": 6495.0, "valorMensalidade": 6574.0, "edp_total_kwh": 5506, "edp_dif_recebidos_x_contratado": -989.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-07-01", "instalacao": "596654", "cpf_cnpj_beneficiario": "36224796000103", "nome_beneficiario": "UGO RESTAURANTE LTDA", "kWhDisponibilizadosMes": 500.0, "valorMensalidade": 459.38, "edp_total_kwh": 419, "edp_dif_recebidos_x_contratado": -81.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-07-01", "instalacao": "634374", "cpf_cnpj_beneficiario": "07688213000105", "nome_beneficiario": "SCM-COMERCIO DE PRESENTES LTDA", "kWhDisponibilizadosMes": 1355.0, "valorMensalidade": 1396.21, "edp_total_kwh": 1150, "edp_dif_recebidos_x_contratado": -205.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-07-01", "instalacao": "1485359", "cpf_cnpj_beneficiario": "52805088000112", "nome_beneficiario": "BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA", "kWhDisponibilizadosMes": 7300.0, "valorMensalidade": 7295.02, "edp_total_kwh": 6197, "edp_dif_recebidos_x_contratado": -1103.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-07-01", "instalacao": "1506204", "cpf_cnpj_beneficiario": "16642060000148", "nome_beneficiario": "RESTAURANTE CANTO DA PRAIA LTDA ME", "kWhDisponibilizadosMes": 8500.0, "valorMensalidade": 8276.88, "edp_total_kwh": 7211, "edp_dif_recebidos_x_contratado": -1289.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-07-01", "instalacao": "1921756", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 3780.0, "valorMensalidade": 3809.72, "edp_total_kwh": 3206, "edp_dif_recebidos_x_contratado": -574.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-07-01", "instalacao": "1921762", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 2076.0, "valorMensalidade": 2076.03, "edp_total_kwh": 1758, "edp_dif_recebidos_x_contratado": -318.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-07-01", "instalacao": "1990889", "cpf_cnpj_beneficiario": "39741461000150", "nome_beneficiario": "DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA", "kWhDisponibilizadosMes": 1090.0, "valorMensalidade": 1101.9, "edp_total_kwh": 920, "edp_dif_recebidos_x_contratado": -170.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-08-01", "instalacao": "506279", "cpf_cnpj_beneficiario": "39275789000129", "nome_beneficiario": "PIZZARIA D´AMPEZZO LTDA", "kWhDisponibilizadosMes": 2050.0, "valorMensalidade": 2133.72, "edp_total_kwh": 1931, "edp_dif_recebidos_x_contratado": -119.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-08-01", "instalacao": "506281", "cpf_cnpj_beneficiario": "27320134000146", "nome_beneficiario": "BAR E RESTAURANTE PIRAO LTDA ME", "kWhDisponibilizadosMes": 6495.0, "valorMensalidade": 6574.0, "edp_total_kwh": 6094, "edp_dif_recebidos_x_contratado": -401.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-08-01", "instalacao": "596654", "cpf_cnpj_beneficiario": "36224796000103", "nome_beneficiario": "UGO RESTAURANTE LTDA", "kWhDisponibilizadosMes": 500.0, "valorMensalidade": 459.38, "edp_total_kwh": 464, "edp_dif_recebidos_x_contratado": -36.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-08-01", "instalacao": "634374", "cpf_cnpj_beneficiario": "07688213000105", "nome_beneficiario": "SCM-COMERCIO DE PRESENTES LTDA", "kWhDisponibilizadosMes": 1355.0, "valorMensalidade": 1396.21, "edp_total_kwh": 1272, "edp_dif_recebidos_x_contratado": -83.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-08-01", "instalacao": "1485359", "cpf_cnpj_beneficiario": "52805088000112", "nome_beneficiario": "BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA", "kWhDisponibilizadosMes": 7300.0, "valorMensalidade": 7295.02, "edp_total_kwh": 6858, "edp_dif_recebidos_x_contratado": -442.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-08-01", "instalacao": "1506204", "cpf_cnpj_beneficiario": "16642060000148", "nome_beneficiario": "RESTAURANTE CANTO DA PRAIA LTDA ME", "kWhDisponibilizadosMes": 8500.0, "valorMensalidade": 8276.88, "edp_total_kwh": 7981, "edp_dif_recebidos_x_contratado": -519.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-08-01", "instalacao": "1921756", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 3780.0, "valorMensalidade": 3809.72, "edp_total_kwh": 3548, "edp_dif_recebidos_x_contratado": -232.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-08-01", "instalacao": "1921762", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 2076.0, "valorMensalidade": 2076.03, "edp_total_kwh": 1946, "edp_dif_recebidos_x_contratado": -130.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-08-01", "instalacao": "1990889", "cpf_cnpj_beneficiario": "39741461000150", "nome_beneficiario": "DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA", "kWhDisponibilizadosMes": 1090.0, "valorMensalidade": 1101.9, "edp_total_kwh": 1018, "edp_dif_recebidos_x_contratado": -72.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-09-01", "instalacao": "1485359", "cpf_cnpj_beneficiario": "52805088000112", "nome_beneficiario": "BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA", "kWhDisponibilizadosMes": 7300.0, "valorMensalidade": 7295.02, "edp_total_kwh": 7122, "edp_dif_recebidos_x_contratado": -178.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-09-01", "instalacao": "1506204", "cpf_cnpj_beneficiario": "16642060000148", "nome_beneficiario": "RESTAURANTE CANTO DA PRAIA LTDA ME", "kWhDisponibilizadosMes": 8500.0, "valorMensalidade": 8276.88, "edp_total_kwh": 8281, "edp_dif_recebidos_x_contratado": -219.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-09-01", "instalacao": "1921756", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 3780.0, "valorMensalidade": 3809.72, "edp_total_kwh": 3692, "edp_dif_recebidos_x_contratado": -88.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-09-01", "instalacao": "1921762", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 2076.0, "valorMensalidade": 2076.03, "edp_total_kwh": 2024, "edp_dif_recebidos_x_contratado": -52.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-09-01", "instalacao": "1990889", "cpf_cnpj_beneficiario": "39741461000150", "nome_beneficiario": "DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA", "kWhDisponibilizadosMes": 1090.0, "valorMensalidade": 1101.9, "edp_total_kwh": 1066, "edp_dif_recebidos_x_contratado": -24.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-09-01", "instalacao": "506281", "cpf_cnpj_beneficiario": "27320134000146", "nome_beneficiario": "BAR E RESTAURANTE PIRAO LTDA ME", "kWhDisponibilizadosMes": 6495.0, "valorMensalidade": 6574.0, "edp_total_kwh": 6334, "edp_dif_recebidos_x_contratado": -161.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-09-01", "instalacao": "596654", "cpf_cnpj_beneficiario": "36224796000103", "nome_beneficiario": "UGO RESTAURANTE LTDA", "kWhDisponibilizadosMes": 500.0, "valorMensalidade": 459.38, "edp_total_kwh": 494, "edp_dif_recebidos_x_contratado": -6.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-09-01", "instalacao": "634374", "cpf_cnpj_beneficiario": "07688213000105", "nome_beneficiario": "SCM-COMERCIO DE PRESENTES LTDA", "kWhDisponibilizadosMes": 1355.0, "valorMensalidade": 1396.21, "edp_total_kwh": 1313, "edp_dif_recebidos_x_contratado": -42.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-09-01", "instalacao": "506279", "cpf_cnpj_beneficiario": "39275789000129", "nome_beneficiario": "PIZZARIA D´AMPEZZO LTDA", "kWhDisponibilizadosMes": 2050.0, "valorMensalidade": 2133.72, "edp_total_kwh": 1993, "edp_dif_recebidos_x_contratado": -57.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-10-01", "instalacao": "1485359", "cpf_cnpj_beneficiario": "52805088000112", "nome_beneficiario": "BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA", "kWhDisponibilizadosMes": 7300.0, "valorMensalidade": 7295.02, "edp_total_kwh": 6356, "edp_dif_recebidos_x_contratado": -944.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-10-01", "instalacao": "1506204", "cpf_cnpj_beneficiario": "16642060000148", "nome_beneficiario": "RESTAURANTE CANTO DA PRAIA LTDA ME", "kWhDisponibilizadosMes": 8500.0, "valorMensalidade": 8276.88, "edp_total_kwh": 7397, "edp_dif_recebidos_x_contratado": -1103.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-10-01", "instalacao": "1921756", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 3780.0, "valorMensalidade": 3809.72, "edp_total_kwh": 3289, "edp_dif_recebidos_x_contratado": -491.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-10-01", "instalacao": "1921762", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 2076.0, "valorMensalidade": 2076.03, "edp_total_kwh": 1804, "edp_dif_recebidos_x_contratado": -272.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-10-01", "instalacao": "1990889", "cpf_cnpj_beneficiario": "39741461000150", "nome_beneficiario": "DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA", "kWhDisponibilizadosMes": 1090.0, "valorMensalidade": 1101.9, "edp_total_kwh": 943, "edp_dif_recebidos_x_contratado": -147.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-10-01", "instalacao": "506279", "cpf_cnpj_beneficiario": "39275789000129", "nome_beneficiario": "PIZZARIA D´AMPEZZO LTDA", "kWhDisponibilizadosMes": 2050.0, "valorMensalidade": 2133.72, "edp_total_kwh": 1790, "edp_dif_recebidos_x_contratado": -260.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-10-01", "instalacao": "506281", "cpf_cnpj_beneficiario": "27320134000146", "nome_beneficiario": "BAR E RESTAURANTE PIRAO LTDA ME", "kWhDisponibilizadosMes": 6495.0, "valorMensalidade": 6574.0, "edp_total_kwh": 5648, "edp_dif_recebidos_x_contratado": -847.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-10-01", "instalacao": "596654", "cpf_cnpj_beneficiario": "36224796000103", "nome_beneficiario": "UGO RESTAURANTE LTDA", "kWhDisponibilizadosMes": 500.0, "valorMensalidade": 459.38, "edp_total_kwh": 430, "edp_dif_recebidos_x_contratado": -70.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-10-01", "instalacao": "634374", "cpf_cnpj_beneficiario": "07688213000105", "nome_beneficiario": "SCM-COMERCIO DE PRESENTES LTDA", "kWhDisponibilizadosMes": 1355.0, "valorMensalidade": 1396.21, "edp_total_kwh": 1179, "edp_dif_recebidos_x_contratado": -176.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-11-01", "instalacao": "506279", "cpf_cnpj_beneficiario": "39275789000129", "nome_beneficiario": "PIZZARIA D´AMPEZZO LTDA", "kWhDisponibilizadosMes": 2050.0, "valorMensalidade": 2133.72, "edp_total_kwh": 1471, "edp_dif_recebidos_x_contratado": -579.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-11-01", "instalacao": "506281", "cpf_cnpj_beneficiario": "27320134000146", "nome_beneficiario": "BAR E RESTAURANTE PIRAO LTDA ME", "kWhDisponibilizadosMes": 6495.0, "valorMensalidade": 6574.0, "edp_total_kwh": 4641, "edp_dif_recebidos_x_contratado": -1854.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-11-01", "instalacao": "596654", "cpf_cnpj_beneficiario": "36224796000103", "nome_beneficiario": "UGO RESTAURANTE LTDA", "kWhDisponibilizadosMes": 500.0, "valorMensalidade": 459.38, "edp_total_kwh": 353, "edp_dif_recebidos_x_contratado": -147.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-11-01", "instalacao": "634374", "cpf_cnpj_beneficiario": "07688213000105", "nome_beneficiario": "SCM-COMERCIO DE PRESENTES LTDA", "kWhDisponibilizadosMes": 1355.0, "valorMensalidade": 1396.21, "edp_total_kwh": 969, "edp_dif_recebidos_x_contratado": -386.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-11-01", "instalacao": "1485359", "cpf_cnpj_beneficiario": "52805088000112", "nome_beneficiario": "BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA", "kWhDisponibilizadosMes": 7300.0, "valorMensalidade": 7295.02, "edp_total_kwh": 5222, "edp_dif_recebidos_x_contratado": -2078.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-11-01", "instalacao": "1506204", "cpf_cnpj_beneficiario": "16642060000148", "nome_beneficiario": "RESTAURANTE CANTO DA PRAIA LTDA ME", "kWhDisponibilizadosMes": 8500.0, "valorMensalidade": 8276.88, "edp_total_kwh": 6078, "edp_dif_recebidos_x_contratado": -2422.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-11-01", "instalacao": "1921756", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 3780.0, "valorMensalidade": 3809.72, "edp_total_kwh": 2702, "edp_dif_recebidos_x_contratado": -1078.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-11-01", "instalacao": "1921762", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 2076.0, "valorMensalidade": 2076.03, "edp_total_kwh": 1482, "edp_dif_recebidos_x_contratado": -594.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-11-01", "instalacao": "1990889", "cpf_cnpj_beneficiario": "39741461000150", "nome_beneficiario": "DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA", "kWhDisponibilizadosMes": 1090.0, "valorMensalidade": 1101.9, "edp_total_kwh": 775, "edp_dif_recebidos_x_contratado": -315.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-03-01", "instalacao": "506279", "cpf_cnpj_beneficiario": "39275789000129", "nome_beneficiario": "PIZZARIA D´AMPEZZO LTDA", "kWhDisponibilizadosMes": 2050.0, "valorMensalidade": 2133.72, "edp_total_kwh": 2298, "edp_dif_recebidos_x_contratado": 248.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-03-01", "instalacao": "506281", "cpf_cnpj_beneficiario": "27320134000146", "nome_beneficiario": "BAR E RESTAURANTE PIRAO LTDA ME", "kWhDisponibilizadosMes": 6495.0, "valorMensalidade": 6574.0, "edp_total_kwh": 7263, "edp_dif_recebidos_x_contratado": 768.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-03-01", "instalacao": "596654", "cpf_cnpj_beneficiario": "36224796000103", "nome_beneficiario": "UGO RESTAURANTE LTDA", "kWhDisponibilizadosMes": 500.0, "valorMensalidade": 459.38, "edp_total_kwh": 553, "edp_dif_recebidos_x_contratado": 53.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-03-01", "instalacao": "634374", "cpf_cnpj_beneficiario": "07688213000105", "nome_beneficiario": "SCM-COMERCIO DE PRESENTES LTDA", "kWhDisponibilizadosMes": 1355.0, "valorMensalidade": 1396.21, "edp_total_kwh": 1509, "edp_dif_recebidos_x_contratado": 154.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-03-01", "instalacao": "1485359", "cpf_cnpj_beneficiario": "52805088000112", "nome_beneficiario": "BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA", "kWhDisponibilizadosMes": 7300.0, "valorMensalidade": 7295.02, "edp_total_kwh": 8169, "edp_dif_recebidos_x_contratado": 869.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-03-01", "instalacao": "1506204", "cpf_cnpj_beneficiario": "16642060000148", "nome_beneficiario": "RESTAURANTE CANTO DA PRAIA LTDA ME", "kWhDisponibilizadosMes": 8500.0, "valorMensalidade": 8276.88, "edp_total_kwh": 9511, "edp_dif_recebidos_x_contratado": 1011.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-03-01", "instalacao": "1921756", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 3780.0, "valorMensalidade": 3809.72, "edp_total_kwh": 4227, "edp_dif_recebidos_x_contratado": 447.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-03-01", "instalacao": "1921762", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 2076.0, "valorMensalidade": 2076.03, "edp_total_kwh": 2315, "edp_dif_recebidos_x_contratado": 239.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-03-01", "instalacao": "1990889", "cpf_cnpj_beneficiario": "39741461000150", "nome_beneficiario": "DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA", "kWhDisponibilizadosMes": 1090.0, "valorMensalidade": 1101.9, "edp_total_kwh": 1224, "edp_dif_recebidos_x_contratado": 134.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-02-01", "instalacao": "506279", "cpf_cnpj_beneficiario": "39275789000129", "nome_beneficiario": "PIZZARIA D´AMPEZZO LTDA", "kWhDisponibilizadosMes": 2050.0, "valorMensalidade": 2133.72, "edp_total_kwh": 2122, "edp_dif_recebidos_x_contratado": 72.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-02-01", "instalacao": "506281", "cpf_cnpj_beneficiario": "27320134000146", "nome_beneficiario": "BAR E RESTAURANTE PIRAO LTDA ME", "kWhDisponibilizadosMes": 6495.0, "valorMensalidade": 6574.0, "edp_total_kwh": 6719, "edp_dif_recebidos_x_contratado": 224.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-02-01", "instalacao": "596654", "cpf_cnpj_beneficiario": "36224796000103", "nome_beneficiario": "UGO RESTAURANTE LTDA", "kWhDisponibilizadosMes": 500.0, "valorMensalidade": 459.38, "edp_total_kwh": 510, "edp_dif_recebidos_x_contratado": 10.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-02-01", "instalacao": "634374", "cpf_cnpj_beneficiario": "07688213000105", "nome_beneficiario": "SCM-COMERCIO DE PRESENTES LTDA", "kWhDisponibilizadosMes": 1355.0, "valorMensalidade": 1396.21, "edp_total_kwh": 1404, "edp_dif_recebidos_x_contratado": 49.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-02-01", "instalacao": "1485359", "cpf_cnpj_beneficiario": "52805088000112", "nome_beneficiario": "BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA", "kWhDisponibilizadosMes": 7300.0, "valorMensalidade": 7295.02, "edp_total_kwh": 7565, "edp_dif_recebidos_x_contratado": 265.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-02-01", "instalacao": "1506204", "cpf_cnpj_beneficiario": "16642060000148", "nome_beneficiario": "RESTAURANTE CANTO DA PRAIA LTDA ME", "kWhDisponibilizadosMes": 8500.0, "valorMensalidade": 8276.88, "edp_total_kwh": 8809, "edp_dif_recebidos_x_contratado": 309.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-02-01", "instalacao": "1921756", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 3780.0, "valorMensalidade": 3809.72, "edp_total_kwh": 3910, "edp_dif_recebidos_x_contratado": 130.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-02-01", "instalacao": "1921762", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 2076.0, "valorMensalidade": 2076.03, "edp_total_kwh": 2154, "edp_dif_recebidos_x_contratado": 78.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-02-01", "instalacao": "1990889", "cpf_cnpj_beneficiario": "39741461000150", "nome_beneficiario": "DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA", "kWhDisponibilizadosMes": 1090.0, "valorMensalidade": 1101.9, "edp_total_kwh": 1133, "edp_dif_recebidos_x_contratado": 43.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-01-01", "instalacao": "506279", "cpf_cnpj_beneficiario": "39275789000129", "nome_beneficiario": "PIZZARIA D´AMPEZZO LTDA", "kWhDisponibilizadosMes": 2050.0, "valorMensalidade": 2133.72, "edp_total_kwh": 1828, "edp_dif_recebidos_x_contratado": -222.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-01-01", "instalacao": "506281", "cpf_cnpj_beneficiario": "27320134000146", "nome_beneficiario": "BAR E RESTAURANTE PIRAO LTDA ME", "kWhDisponibilizadosMes": 6495.0, "valorMensalidade": 6574.0, "edp_total_kwh": 5787, "edp_dif_recebidos_x_contratado": -708.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-01-01", "instalacao": "596654", "cpf_cnpj_beneficiario": "36224796000103", "nome_beneficiario": "UGO RESTAURANTE LTDA", "kWhDisponibilizadosMes": 500.0, "valorMensalidade": 459.38, "edp_total_kwh": 439, "edp_dif_recebidos_x_contratado": -61.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-01-01", "instalacao": "634374", "cpf_cnpj_beneficiario": "07688213000105", "nome_beneficiario": "SCM-COMERCIO DE PRESENTES LTDA", "kWhDisponibilizadosMes": 1355.0, "valorMensalidade": 1396.21, "edp_total_kwh": 1209, "edp_dif_recebidos_x_contratado": -146.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-01-01", "instalacao": "1485359", "cpf_cnpj_beneficiario": "52805088000112", "nome_beneficiario": "BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA", "kWhDisponibilizadosMes": 7300.0, "valorMensalidade": 7295.02, "edp_total_kwh": 6516, "edp_dif_recebidos_x_contratado": -784.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-01-01", "instalacao": "1506204", "cpf_cnpj_beneficiario": "16642060000148", "nome_beneficiario": "RESTAURANTE CANTO DA PRAIA LTDA ME", "kWhDisponibilizadosMes": 8500.0, "valorMensalidade": 8276.88, "edp_total_kwh": 7588, "edp_dif_recebidos_x_contratado": -912.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-01-01", "instalacao": "1921756", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 3780.0, "valorMensalidade": 3809.72, "edp_total_kwh": 3368, "edp_dif_recebidos_x_contratado": -412.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-01-01", "instalacao": "1921762", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 2076.0, "valorMensalidade": 2076.03, "edp_total_kwh": 1855, "edp_dif_recebidos_x_contratado": -221.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-01-01", "instalacao": "1990889", "cpf_cnpj_beneficiario": "39741461000150", "nome_beneficiario": "DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA", "kWhDisponibilizadosMes": 1090.0, "valorMensalidade": 1101.9, "edp_total_kwh": 976, "edp_dif_recebidos_x_contratado": -114.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-12-01", "instalacao": "506279", "cpf_cnpj_beneficiario": "39275789000129", "nome_beneficiario": "PIZZARIA D´AMPEZZO LTDA", "kWhDisponibilizadosMes": 2050.0, "valorMensalidade": 2133.72, "edp_total_kwh": 1950, "edp_dif_recebidos_x_contratado": -100.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-12-01", "instalacao": "506281", "cpf_cnpj_beneficiario": "27320134000146", "nome_beneficiario": "BAR E RESTAURANTE PIRAO LTDA ME", "kWhDisponibilizadosMes": 6495.0, "valorMensalidade": 6574.0, "edp_total_kwh": 6191, "edp_dif_recebidos_x_contratado": -304.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-12-01", "instalacao": "596654", "cpf_cnpj_beneficiario": "36224796000103", "nome_beneficiario": "UGO RESTAURANTE LTDA", "kWhDisponibilizadosMes": 500.0, "valorMensalidade": 459.38, "edp_total_kwh": 472, "edp_dif_recebidos_x_contratado": -28.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-12-01", "instalacao": "634374", "cpf_cnpj_beneficiario": "07688213000105", "nome_beneficiario": "SCM-COMERCIO DE PRESENTES LTDA", "kWhDisponibilizadosMes": 1355.0, "valorMensalidade": 1396.21, "edp_total_kwh": 1285, "edp_dif_recebidos_x_contratado": -70.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-12-01", "instalacao": "1485359", "cpf_cnpj_beneficiario": "52805088000112", "nome_beneficiario": "BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA", "kWhDisponibilizadosMes": 7300.0, "valorMensalidade": 7295.02, "edp_total_kwh": 6959, "edp_dif_recebidos_x_contratado": -341.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-12-01", "instalacao": "1506204", "cpf_cnpj_beneficiario": "16642060000148", "nome_beneficiario": "RESTAURANTE CANTO DA PRAIA LTDA ME", "kWhDisponibilizadosMes": 8500.0, "valorMensalidade": 8276.88, "edp_total_kwh": 8097, "edp_dif_recebidos_x_contratado": -403.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-12-01", "instalacao": "1921756", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 3780.0, "valorMensalidade": 3809.72, "edp_total_kwh": 3605, "edp_dif_recebidos_x_contratado": -175.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-12-01", "instalacao": "1921762", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 2076.0, "valorMensalidade": 2076.03, "edp_total_kwh": 1979, "edp_dif_recebidos_x_contratado": -97.0}, {"ano": 2024, "semestre": "Semestre_2_2024", "mes_ano": "2024-12-01", "instalacao": "1990889", "cpf_cnpj_beneficiario": "39741461000150", "nome_beneficiario": "DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA", "kWhDisponibilizadosMes": 1090.0, "valorMensalidade": 1101.9, "edp_total_kwh": 1034, "edp_dif_recebidos_x_contratado": -56.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-04-01", "instalacao": "1990889", "cpf_cnpj_beneficiario": "39741461000150", "nome_beneficiario": "DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA", "kWhDisponibilizadosMes": 1090.0, "valorMensalidade": 1101.9, "edp_total_kwh": 951, "edp_dif_recebidos_x_contratado": -139.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-04-01", "instalacao": "506279", "cpf_cnpj_beneficiario": "39275789000129", "nome_beneficiario": "PIZZARIA D´AMPEZZO LTDA", "kWhDisponibilizadosMes": 2050.0, "valorMensalidade": 2133.72, "edp_total_kwh": 1784, "edp_dif_recebidos_x_contratado": -266.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-04-01", "instalacao": "1485359", "cpf_cnpj_beneficiario": "52805088000112", "nome_beneficiario": "BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA", "kWhDisponibilizadosMes": 7300.0, "valorMensalidade": 7295.02, "edp_total_kwh": 6344, "edp_dif_recebidos_x_contratado": -956.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-04-01", "instalacao": "596654", "cpf_cnpj_beneficiario": "36224796000103", "nome_beneficiario": "UGO RESTAURANTE LTDA", "kWhDisponibilizadosMes": 500.0, "valorMensalidade": 459.38, "edp_total_kwh": 429, "edp_dif_recebidos_x_contratado": -71.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-04-01", "instalacao": "1921756", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 3780.0, "valorMensalidade": 3809.72, "edp_total_kwh": 3283, "edp_dif_recebidos_x_contratado": -497.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-04-01", "instalacao": "506281", "cpf_cnpj_beneficiario": "27320134000146", "nome_beneficiario": "BAR E RESTAURANTE PIRAO LTDA ME", "kWhDisponibilizadosMes": 6495.0, "valorMensalidade": 6574.0, "edp_total_kwh": 5641, "edp_dif_recebidos_x_contratado": -854.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-04-01", "instalacao": "1921762", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 2076.0, "valorMensalidade": 2076.03, "edp_total_kwh": 1797, "edp_dif_recebidos_x_contratado": -279.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-04-01", "instalacao": "1506204", "cpf_cnpj_beneficiario": "16642060000148", "nome_beneficiario": "RESTAURANTE CANTO DA PRAIA LTDA ME", "kWhDisponibilizadosMes": 8500.0, "valorMensalidade": 8276.88, "edp_total_kwh": 7387, "edp_dif_recebidos_x_contratado": -1113.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-04-01", "instalacao": "634374", "cpf_cnpj_beneficiario": "07688213000105", "nome_beneficiario": "SCM-COMERCIO DE PRESENTES LTDA", "kWhDisponibilizadosMes": 1355.0, "valorMensalidade": 1396.21, "edp_total_kwh": 1172, "edp_dif_recebidos_x_contratado": -183.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-05-01", "instalacao": "506279", "cpf_cnpj_beneficiario": "39275789000129", "nome_beneficiario": "PIZZARIA D´AMPEZZO LTDA", "kWhDisponibilizadosMes": 2050.0, "valorMensalidade": 2133.72, "edp_total_kwh": 1602, "edp_dif_recebidos_x_contratado": -448.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-05-01", "instalacao": "596654", "cpf_cnpj_beneficiario": "36224796000103", "nome_beneficiario": "UGO RESTAURANTE LTDA", "kWhDisponibilizadosMes": 500.0, "valorMensalidade": 459.38, "edp_total_kwh": 386, "edp_dif_recebidos_x_contratado": -114.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-05-01", "instalacao": "506281", "cpf_cnpj_beneficiario": "27320134000146", "nome_beneficiario": "BAR E RESTAURANTE PIRAO LTDA ME", "kWhDisponibilizadosMes": 6495.0, "valorMensalidade": 6574.0, "edp_total_kwh": 5066, "edp_dif_recebidos_x_contratado": -1429.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-05-01", "instalacao": "634374", "cpf_cnpj_beneficiario": "07688213000105", "nome_beneficiario": "SCM-COMERCIO DE PRESENTES LTDA", "kWhDisponibilizadosMes": 1355.0, "valorMensalidade": 1396.21, "edp_total_kwh": 1053, "edp_dif_recebidos_x_contratado": -302.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-05-01", "instalacao": "1506204", "cpf_cnpj_beneficiario": "16642060000148", "nome_beneficiario": "RESTAURANTE CANTO DA PRAIA LTDA ME", "kWhDisponibilizadosMes": 8500.0, "valorMensalidade": 8276.88, "edp_total_kwh": 6634, "edp_dif_recebidos_x_contratado": -1866.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-05-01", "instalacao": "1921762", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 2076.0, "valorMensalidade": 2076.03, "edp_total_kwh": 1614, "edp_dif_recebidos_x_contratado": -462.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-05-01", "instalacao": "1990889", "cpf_cnpj_beneficiario": "39741461000150", "nome_beneficiario": "DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA", "kWhDisponibilizadosMes": 1090.0, "valorMensalidade": 1101.9, "edp_total_kwh": 854, "edp_dif_recebidos_x_contratado": -236.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-05-01", "instalacao": "1921756", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 3780.0, "valorMensalidade": 3809.72, "edp_total_kwh": 2948, "edp_dif_recebidos_x_contratado": -832.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-05-01", "instalacao": "1485359", "cpf_cnpj_beneficiario": "52805088000112", "nome_beneficiario": "BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA", "kWhDisponibilizadosMes": 7300.0, "valorMensalidade": 7295.02, "edp_total_kwh": 5697, "edp_dif_recebidos_x_contratado": -1603.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-06-01", "instalacao": "1506204", "cpf_cnpj_beneficiario": "16642060000148", "nome_beneficiario": "RESTAURANTE CANTO DA PRAIA LTDA ME", "kWhDisponibilizadosMes": 8500.0, "valorMensalidade": 8276.88, "edp_total_kwh": 7115, "edp_dif_recebidos_x_contratado": -1385.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-06-01", "instalacao": "506281", "cpf_cnpj_beneficiario": "27320134000146", "nome_beneficiario": "BAR E RESTAURANTE PIRAO LTDA ME", "kWhDisponibilizadosMes": 6495.0, "valorMensalidade": 6574.0, "edp_total_kwh": 5434, "edp_dif_recebidos_x_contratado": -1061.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-06-01", "instalacao": "634374", "cpf_cnpj_beneficiario": "07688213000105", "nome_beneficiario": "SCM-COMERCIO DE PRESENTES LTDA", "kWhDisponibilizadosMes": 1355.0, "valorMensalidade": 1396.21, "edp_total_kwh": 1129, "edp_dif_recebidos_x_contratado": -226.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-06-01", "instalacao": "1921762", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 2076.0, "valorMensalidade": 2076.03, "edp_total_kwh": 1731, "edp_dif_recebidos_x_contratado": -345.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-06-01", "instalacao": "1990889", "cpf_cnpj_beneficiario": "39741461000150", "nome_beneficiario": "DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA", "kWhDisponibilizadosMes": 1090.0, "valorMensalidade": 1101.9, "edp_total_kwh": 916, "edp_dif_recebidos_x_contratado": -174.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-06-01", "instalacao": "1485359", "cpf_cnpj_beneficiario": "52805088000112", "nome_beneficiario": "BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA", "kWhDisponibilizadosMes": 7300.0, "valorMensalidade": 7295.02, "edp_total_kwh": 6111, "edp_dif_recebidos_x_contratado": -1189.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-06-01", "instalacao": "1921756", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 3780.0, "valorMensalidade": 3809.72, "edp_total_kwh": 3162, "edp_dif_recebidos_x_contratado": -618.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-06-01", "instalacao": "596654", "cpf_cnpj_beneficiario": "36224796000103", "nome_beneficiario": "UGO RESTAURANTE LTDA", "kWhDisponibilizadosMes": 500.0, "valorMensalidade": 459.38, "edp_total_kwh": 414, "edp_dif_recebidos_x_contratado": -86.0}, {"ano": 2025, "semestre": "Semestre_1_2025", "mes_ano": "2025-06-01", "instalacao": "506279", "cpf_cnpj_beneficiario": "39275789000129", "nome_beneficiario": "PIZZARIA D´AMPEZZO LTDA", "kWhDisponibilizadosMes": 2050.0, "valorMensalidade": 2133.72, "edp_total_kwh": 1719, "edp_dif_recebidos_x_contratado": -331.0}, {"ano": 2025, "semestre": "Semestre_2_2025", "mes_ano": "2025-07-01", "instalacao": "596654", "cpf_cnpj_beneficiario": "36224796000103", "nome_beneficiario": "UGO RESTAURANTE LTDA", "kWhDisponibilizadosMes": 500.0, "valorMensalidade": 459.38, "edp_total_kwh": 430, "edp_dif_recebidos_x_contratado": -70.0}, {"ano": 2025, "semestre": "Semestre_2_2025", "mes_ano": "2025-07-01", "instalacao": "506279", "cpf_cnpj_beneficiario": "39275789000129", "nome_beneficiario": "PIZZARIA D´AMPEZZO LTDA", "kWhDisponibilizadosMes": 2050.0, "valorMensalidade": 2133.72, "edp_total_kwh": 1789, "edp_dif_recebidos_x_contratado": -261.0}, {"ano": 2025, "semestre": "Semestre_2_2025", "mes_ano": "2025-07-01", "instalacao": "1921756", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 3780.0, "valorMensalidade": 3809.72, "edp_total_kwh": 3291, "edp_dif_recebidos_x_contratado": -489.0}, {"ano": 2025, "semestre": "Semestre_2_2025", "mes_ano": "2025-07-01", "instalacao": "1485359", "cpf_cnpj_beneficiario": "52805088000112", "nome_beneficiario": "BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA", "kWhDisponibilizadosMes": 7300.0, "valorMensalidade": 7295.02, "edp_total_kwh": 6360, "edp_dif_recebidos_x_contratado": -940.0}, {"ano": 2025, "semestre": "Semestre_2_2025", "mes_ano": "2025-07-01", "instalacao": "1506204", "cpf_cnpj_beneficiario": "16642060000148", "nome_beneficiario": "RESTAURANTE CANTO DA PRAIA LTDA ME", "kWhDisponibilizadosMes": 8500.0, "valorMensalidade": 8276.88, "edp_total_kwh": 7404, "edp_dif_recebidos_x_contratado": -1096.0}, {"ano": 2025, "semestre": "Semestre_2_2025", "mes_ano": "2025-07-01", "instalacao": "506281", "cpf_cnpj_beneficiario": "27320134000146", "nome_beneficiario": "BAR E RESTAURANTE PIRAO LTDA ME", "kWhDisponibilizadosMes": 6495.0, "valorMensalidade": 6574.0, "edp_total_kwh": 5654, "edp_dif_recebidos_x_contratado": -841.0}, {"ano": 2025, "semestre": "Semestre_2_2025", "mes_ano": "2025-07-01", "instalacao": "634374", "cpf_cnpj_beneficiario": "07688213000105", "nome_beneficiario": "SCM-COMERCIO DE PRESENTES LTDA", "kWhDisponibilizadosMes": 1355.0, "valorMensalidade": 1396.21, "edp_total_kwh": 1175, "edp_dif_recebidos_x_contratado": -180.0}, {"ano": 2025, "semestre": "Semestre_2_2025", "mes_ano": "2025-07-01", "instalacao": "1921762", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 2076.0, "valorMensalidade": 2076.03, "edp_total_kwh": 1802, "edp_dif_recebidos_x_contratado": -274.0}, {"ano": 2025, "semestre": "Semestre_2_2025", "mes_ano": "2025-07-01", "instalacao": "1990889", "cpf_cnpj_beneficiario": "39741461000150", "nome_beneficiario": "DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA", "kWhDisponibilizadosMes": 1090.0, "valorMensalidade": 1101.9, "edp_total_kwh": 953, "edp_dif_recebidos_x_contratado": -137.0}, {"ano": 2025, "semestre": "Semestre_2_2025", "mes_ano": "2025-08-01", "instalacao": "506279", "cpf_cnpj_beneficiario": "39275789000129", "nome_beneficiario": "PIZZARIA D´AMPEZZO LTDA", "kWhDisponibilizadosMes": 2050.0, "valorMensalidade": 2133.72, "edp_total_kwh": 1904, "edp_dif_recebidos_x_contratado": -146.0}, {"ano": 2025, "semestre": "Semestre_2_2025", "mes_ano": "2025-08-01", "instalacao": "506281", "cpf_cnpj_beneficiario": "27320134000146", "nome_beneficiario": "BAR E RESTAURANTE PIRAO LTDA ME", "kWhDisponibilizadosMes": 6495.0, "valorMensalidade": 6574.0, "edp_total_kwh": 6020, "edp_dif_recebidos_x_contratado": -475.0}, {"ano": 2025, "semestre": "Semestre_2_2025", "mes_ano": "2025-08-01", "instalacao": "596654", "cpf_cnpj_beneficiario": "36224796000103", "nome_beneficiario": "UGO RESTAURANTE LTDA", "kWhDisponibilizadosMes": 500.0, "valorMensalidade": 459.38, "edp_total_kwh": 458, "edp_dif_recebidos_x_contratado": -42.0}, {"ano": 2025, "semestre": "Semestre_2_2025", "mes_ano": "2025-08-01", "instalacao": "634374", "cpf_cnpj_beneficiario": "07688213000105", "nome_beneficiario": "SCM-COMERCIO DE PRESENTES LTDA", "kWhDisponibilizadosMes": 1355.0, "valorMensalidade": 1396.21, "edp_total_kwh": 1251, "edp_dif_recebidos_x_contratado": -104.0}, {"ano": 2025, "semestre": "Semestre_2_2025", "mes_ano": "2025-08-01", "instalacao": "1485359", "cpf_cnpj_beneficiario": "52805088000112", "nome_beneficiario": "BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA", "kWhDisponibilizadosMes": 7300.0, "valorMensalidade": 7295.02, "edp_total_kwh": 6770, "edp_dif_recebidos_x_contratado": -530.0}, {"ano": 2025, "semestre": "Semestre_2_2025", "mes_ano": "2025-08-01", "instalacao": "1506204", "cpf_cnpj_beneficiario": "16642060000148", "nome_beneficiario": "RESTAURANTE CANTO DA PRAIA LTDA ME", "kWhDisponibilizadosMes": 8500.0, "valorMensalidade": 8276.88, "edp_total_kwh": 7883, "edp_dif_recebidos_x_contratado": -617.0}, {"ano": 2025, "semestre": "Semestre_2_2025", "mes_ano": "2025-08-01", "instalacao": "1921756", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 3780.0, "valorMensalidade": 3809.72, "edp_total_kwh": 3503, "edp_dif_recebidos_x_contratado": -277.0}, {"ano": 2025, "semestre": "Semestre_2_2025", "mes_ano": "2025-08-01", "instalacao": "1921762", "cpf_cnpj_beneficiario": "02016402792", "nome_beneficiario": "GEDALIAS ROSA", "kWhDisponibilizadosMes": 2076.0, "valorMensalidade": 2076.03, "edp_total_kwh": 1918, "edp_dif_recebidos_x_contratado": -158.0}, {"ano": 2025, "semestre": "Semestre_2_2025", "mes_ano": "2025-08-01", "instalacao": "1990889", "cpf_cnpj_beneficiario": "39741461000150", "nome_beneficiario": "DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA", "kWhDisponibilizadosMes": 1090.0, "valorMensalidade": 1101.9, "edp_total_kwh": 1014, "edp_dif_recebidos_x_contratado": -76.0}]


    const filtersForm = document.getElementById('filters');
    const diffCard = document.getElementById('diffCard');
    const diffValue = document.getElementById('diffValue');
    const diffLegend = document.getElementById('diffLegend');
    const tableBody = document.getElementById('tableBody');
    const emptyState = document.getElementById('emptyState');
    const insightsGrid = document.getElementById('insightsGrid');
    const instalacoesIndicator = document.getElementById('instalacoesIndicator');
    const benefFilterContainer = document.getElementById('benefFilter');
    const benefUsageIndicators = document.querySelectorAll('[data-benef-usage]');

    const selectElements = {
      ano: document.getElementById('anoFilter'),
      semestre: document.getElementById('semestreFilter'),
      mes: document.getElementById('mesFilter'),
      instalacao: document.getElementById('instalacaoFilter')
    };

    const monthFormatter = new Intl.DateTimeFormat('pt-BR', { month: 'short', year: 'numeric' });
    const currencyFormatter = new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL', maximumFractionDigits: 0 });
    const numberFormatter = new Intl.NumberFormat('pt-BR', { maximumFractionDigits: 0 });
    const currencyPerKwhFormatter = new Intl.NumberFormat('pt-BR', {
      style: 'currency',
      currency: 'BRL',
      minimumFractionDigits: 2,
      maximumFractionDigits: 2
    });


    let energiaChart = null;
    let beneficiariosList = [];
    let selectedBeneficiarios = new Set();
    let benefProfiles = [];

    function updateInstalacoesIndicator(data) {
      const total = new Set(data.map(item => item.instalacao)).size;
      instalacoesIndicator.textContent = `Instalações monitoradas: ${total}`;
    }

    function populateFilters(data) {
      const sets = {
        ano: new Set(),
        semestre: new Set(),
        mes: new Set(),
        instalacao: new Set(),
        beneficiario: new Set()
      };

      data.forEach(item => {
        sets.ano.add(item.ano);
        sets.semestre.add(item.semestre);
        sets.mes.add(item.mes_ano);
        sets.instalacao.add(item.instalacao);
        sets.beneficiario.add(item.nome_beneficiario);
      });

      const sortedMes = Array.from(sets.mes).sort();

      populateSelect(selectElements.ano, Array.from(sets.ano).sort());
      populateSelect(selectElements.semestre, Array.from(sets.semestre).sort());
      populateSelect(selectElements.mes, sortedMes, formatMesLabel);
      populateSelect(selectElements.instalacao, Array.from(sets.instalacao).sort(), undefined, 'Todas');

      benefProfiles = buildBeneficiaryProfiles(data);
      populateBenefCheckboxes(benefProfiles);
    }

    function populateSelect(select, values, formatFn, defaultLabel = 'Todos') {
      const defaultOption = document.createElement('option');
      defaultOption.value = '';
      defaultOption.textContent = defaultLabel;
      select.innerHTML = '';
      select.appendChild(defaultOption);

      values.forEach(value => {
        const option = document.createElement('option');
        option.value = value;
        option.textContent = formatFn ? formatFn(value) : value;
        select.appendChild(option);
      });
    }

    function buildBeneficiaryProfiles(data) {
      const map = new Map();

      data.forEach(item => {
        if (!map.has(item.nome_beneficiario)) {
          map.set(item.nome_beneficiario, {
            nome: item.nome_beneficiario,
            instalacoes: new Set(),
            mensalidades: new Set(),
            contratados: new Set(),
            totalRecebido: 0,
            registros: 0
          });
        }

        const profile = map.get(item.nome_beneficiario);
        profile.instalacoes.add(item.instalacao);
        profile.mensalidades.add(item.valorMensalidade);
        profile.contratados.add(item.kWhDisponibilizadosMes);
        profile.totalRecebido += item.edp_total_kwh;
        profile.registros += 1;
      });

      return Array.from(map.values()).map(profile => {
        const mensalidades = Array.from(profile.mensalidades).sort((a, b) => a - b);
        const contratados = Array.from(profile.contratados).sort((a, b) => a - b);

        const mensalidadeDistinct = mensalidades.length
          ? mensalidades[0]
          : 0;
        const contratadoDistinct = contratados.length
          ? contratados[0]
          : 0;

        return {
          nome: profile.nome,
          instalacoes: Array.from(profile.instalacoes).sort(),
          mensalidadeDistinct,
          contratadoDistinct,
          recebidoMedio: profile.registros ? profile.totalRecebido / profile.registros : 0,
          valorUnitario: contratadoDistinct ? mensalidadeDistinct / contratadoDistinct : 0
        };
      }).sort((a, b) => profileSort(a.nome, b.nome));
    }

    function profileSort(a, b) {
      return a.localeCompare(b, 'pt-BR', { sensitivity: 'base' });
    }

    function formatInstalacoes(instalacoes) {
      if (!instalacoes.length) return 'Sem instalação registrada';
      if (instalacoes.length === 1) return `Instalação ${instalacoes[0]}`;
      const preview = instalacoes.slice(0, 2).join(', ');
      const remaining = instalacoes.length - 2;
      return `Instalações ${preview}${remaining > 0 ? ` +${remaining}` : ''}`;
    }

    function updateBenefUsage(count, hasSelection, awaitingSelection = false) {
      let text;
      if (awaitingSelection) {
        text = 'Selecione um beneficiário ou aplique filtros para visualizar os dados.';
      } else if (count === 0) {
        text = 'Nenhum beneficiário atende aos filtros atuais.';
      } else if (hasSelection) {
        text = count === 1
          ? 'Dados referentes a 1 beneficiário selecionado.'
          : `Dados referentes a ${count} beneficiários selecionados.`;
      } else {
        text = count === 1
          ? 'Dados gerais abrangendo 1 beneficiário.'
          : `Dados gerais abrangendo ${count} beneficiários.`;
      }

      benefUsageIndicators.forEach(node => {
        node.textContent = text;
      });
    }

    function hasActiveFilters(filters) {
      return Boolean(
        filters.ano ||
        filters.semestre ||
        filters.mes ||
        filters.instalacao ||
        filters.beneficiarios.size
      );
    }

    function showAwaitingSelection() {
      diffValue.textContent = '0 kWh';
      diffCard.dataset.state = 'positive';
      diffLegend.textContent = 'Selecione um beneficiário ou aplique filtros para visualizar os dados.';
      insightsGrid.innerHTML = '';
      tableBody.innerHTML = '';
      tableBody.parentElement.style.display = 'none';
      emptyState.hidden = false;
      emptyState.textContent = 'Selecione um beneficiário ou aplique filtros para visualizar.';
      energiaChart && updateChart(energiaChart, []);
    }

    function populateBenefCheckboxes(profiles) {
      beneficiariosList = profiles.map(profile => profile.nome);
      selectedBeneficiarios = new Set();
      benefFilterContainer.innerHTML = '';

      const allLabel = document.createElement('label');
      allLabel.className = 'checkbox-item checkbox-all';
      const allInput = document.createElement('input');
      allInput.type = 'checkbox';
      allInput.id = 'benef-all';
      allInput.checked = false;
      allInput.addEventListener('change', () => {
        const checked = allInput.checked;
        toggleBenefCheckboxes(checked);
        selectedBeneficiarios = checked ? new Set(beneficiariosList) : new Set();
        refreshDashboard();
      });
      const allMeta = document.createElement('div');
      allMeta.className = 'checkbox-meta';
      allMeta.innerHTML = `
        <div class="benef-primary">
          <strong>Todos os beneficiários</strong>
          <span>Visão geral</span>
        </div>
        <div class="benef-metrics">
          <span>Selecione para limpar filtros individuais</span>
        </div>
      `;

      allLabel.appendChild(allInput);
      allLabel.appendChild(allMeta);
      benefFilterContainer.appendChild(allLabel);

      profiles.forEach(profile => {
        const label = document.createElement('label');
        label.className = 'checkbox-item';
        const input = document.createElement('input');
        input.type = 'checkbox';
        input.value = profile.nome;
        input.dataset.role = 'benef-option';
        input.checked = false;
        input.addEventListener('change', () => {
          if (input.checked) {
            selectedBeneficiarios.add(profile.nome);
          } else {
            selectedBeneficiarios.delete(profile.nome);
          }
          const allCheckbox = document.getElementById('benef-all');
          if (allCheckbox) {
            allCheckbox.checked = selectedBeneficiarios.size === beneficiariosList.length;
          }
          refreshDashboard();
        });

        const meta = document.createElement('div');
        meta.className = 'checkbox-meta';
        meta.innerHTML = `
          <div class="benef-primary">
            <strong>${profile.nome}</strong>
            <span>${formatInstalacoes(profile.instalacoes)}</span>
          </div>
          <div class="benef-metrics">
            <span>Mensalidade contratada: <strong>${currencyFormatter.format(profile.mensalidadeDistinct)}</strong></span>
            <span>kWh contratados (plano): <strong>${numberFormatter.format(profile.contratadoDistinct)}</strong></span>
            <span>VALOR KWH: <strong>${currencyPerKwhFormatter.format(profile.valorUnitario)}</strong></span>
          </div>
        `;

        label.appendChild(input);
        label.appendChild(meta);
        benefFilterContainer.appendChild(label);
      });
    }

    function toggleBenefCheckboxes(state) {
      benefFilterContainer
        .querySelectorAll('input[data-role="benef-option"]')
        .forEach(cb => {
          cb.checked = state;
        });
    }

    function resetBenefCheckboxes() {
      if (!beneficiariosList.length) return;
      const allCheckbox = document.getElementById('benef-all');
      if (allCheckbox) allCheckbox.checked = false;
      toggleBenefCheckboxes(false);
      selectedBeneficiarios = new Set();
    }

    function formatMesLabel(value) {
      const date = new Date(`${value}T00:00:00`);
      return monthFormatter.format(date);
    }

    function getFilters() {
      return {
        ano: selectElements.ano.value,
        semestre: selectElements.semestre.value,
        mes: selectElements.mes.value,
        instalacao: selectElements.instalacao.value,
        beneficiarios: new Set(selectedBeneficiarios)
      };
    }

    function applyFilters(data, filters) {
      return data.filter(item => {
        if (filters.ano && String(item.ano) !== filters.ano) return false;
        if (filters.semestre && item.semestre !== filters.semestre) return false;
        if (filters.mes && item.mes_ano !== filters.mes) return false;
        if (filters.instalacao && item.instalacao !== filters.instalacao) return false;
        if (filters.beneficiarios.size && !filters.beneficiarios.has(item.nome_beneficiario)) return false;
        return true;
      });
    }

    function summarize(data) {
      const months = data.length;
      const totalContratado = data.reduce((sum, item) => sum + item.kWhDisponibilizadosMes, 0);
      const totalRecebido = data.reduce((sum, item) => sum + item.edp_total_kwh, 0);
      const totalDiferenca = data.reduce((sum, item) => sum + item.edp_dif_recebidos_x_contratado, 0);
      const totalMensalidade = data.reduce((sum, item) => sum + item.valorMensalidade, 0);
      const mediaContratada = months ? totalContratado / months : 0;
      const mediaRecebida = months ? totalRecebido / months : 0;

      return {
        months,
        totalContratado,
        totalRecebido,
        totalDiferenca,
        totalMensalidade,
        mediaContratada,
        mediaRecebida,
        aderencia: mediaContratada ? (mediaRecebida / mediaContratada) * 100 : 0
      };
    }

    function updateDiffCard(summary) {
      diffValue.textContent = `${summary.totalDiferenca >= 0 ? '+' : ''}${numberFormatter.format(summary.totalDiferenca)} kWh`;
      diffCard.dataset.state = summary.totalDiferenca >= 0 ? 'positive' : 'negative';
      diffLegend.textContent = summary.totalDiferenca >= 0
        ? 'Recebimento acima do contratado nos filtros selecionados.'
        : 'Recebimento abaixo do contratado nos filtros selecionados.';
    }

    function updateInsights(summary) {
      const cards = [
        {
          label: 'Meses analisados',
          value: summary.months,
          detail: summary.months >= 12 ? 'Janela completa de 12 meses' : 'Ainda sem 12 meses completos'
        },
        {
          label: 'kWh contratado',
          value: numberFormatter.format(summary.mediaContratada),
          detail: 'Meta mensal do plano de assinatura'
        },
        {
          label: 'Média recebida (kWh)',
          value: numberFormatter.format(summary.mediaRecebida),
          detail: summary.mediaRecebida >= summary.mediaContratada ? 'Acima da meta contratada' : 'Abaixo da meta contratada'
        },
        {
          label: 'Índice de entrega',
          value: `${summary.aderencia.toFixed(1)}%`,
          detail: summary.aderencia >= 100 ? 'Plano entregue na totalidade' : 'Ajustar recebimento para 100%'
        },
        {
          label: 'Diferença acumulada',
          value: `${summary.totalDiferenca >= 0 ? '+' : ''}${numberFormatter.format(summary.totalDiferenca)} kWh`,
          detail: summary.totalDiferenca >= 0 ? 'Excedente recebido' : 'Déficit acumulado'
        }
      ];

      insightsGrid.innerHTML = cards.map(card => `
        <div class="insight-card">
          <span>${card.label}</span>
          <strong>${card.value}</strong>
          <p>${card.detail}</p>
        </div>
      `).join('');
    }

    function updateTable(data) {
      tableBody.innerHTML = data.map(item => `
        <tr>
          <td>${formatMesLabel(item.mes_ano)}</td>
          <td>${item.instalacao}</td>
          <td>${item.nome_beneficiario}</td>
                  <td>${numberFormatter.format(item.kWhDisponibilizadosMes)} kWh</td>
          <td>${numberFormatter.format(item.edp_total_kwh)} kWh</td>
          <td style="color:${item.edp_dif_recebidos_x_contratado >= 0 ? 'var(--positive)' : 'var(--negative)'}">
            ${item.edp_dif_recebidos_x_contratado >= 0 ? '+' : ''}${numberFormatter.format(item.edp_dif_recebidos_x_contratado)} kWh
          </td>
          <td>${currencyFormatter.format(item.valorMensalidade)}</td>
        </tr>
      `).join('');

      const hasData = data.length > 0;
      tableBody.parentElement.style.display = hasData ? 'table' : 'none';
      emptyState.hidden = hasData;
      if (!hasData) {
        emptyState.textContent = 'Nenhum registro encontrado para os filtros selecionados.';
      }
    }

    function buildChart(data) {
      const ctx = document.getElementById('energiaChart').getContext('2d');

      return new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.map(item => formatMesLabel(item.mes_ano)),
          datasets: [
            {
              label: 'kWh contratado',
              data: data.map(item => item.kWhDisponibilizadosMes),
              borderColor: 'rgba(15, 155, 156, 0.9)',
              backgroundColor: 'rgba(15, 155, 156, 0.2)',
              tension: 0.35,
              borderWidth: 3,
              pointRadius: 4,
              fill: false
            },
            {
              label: 'kWh recebido',
              data: data.map(item => item.edp_total_kwh),
              borderColor: 'rgba(249, 115, 22, 0.9)',
              backgroundColor: 'rgba(249, 115, 22, 0.2)',
              tension: 0.35,
              borderWidth: 3,
              pointRadius: 4,
              fill: false
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: {
            mode: 'index',
            intersect: false
          },
          plugins: {
            legend: {
              labels: {
                color: '#0f2a24'
              }
            },
            tooltip: {
              callbacks: {
                label: context => `${context.dataset.label}: ${numberFormatter.format(context.parsed.y)} kWh`
              }
            }
          },
          scales: {
            x: {
              ticks: { color: '#0f2a24' },
              grid: { display: false }
            },
            y: {
              ticks: {
                color: '#0f2a24',
                callback: value => `${numberFormatter.format(value)}`
              },
              grid: {
                color: 'rgba(15, 42, 36, 0.1)'
              }
            }
          }
        }
      });
    }

    function updateChart(chart, data) {
      chart.data.labels = data.map(item => formatMesLabel(item.mes_ano));
      chart.data.datasets[0].data = data.map(item => item.kWhDisponibilizadosMes);
      chart.data.datasets[1].data = data.map(item => item.edp_total_kwh);
      chart.update();
    }

    function refreshDashboard() {
      if (!rawData.length) return;

      const filters = getFilters();
      const hasFilters = hasActiveFilters(filters);

      if (!hasFilters) {
        updateBenefUsage(beneficiariosList.length, false, true);
        showAwaitingSelection();
        return;
      }

      const filtered = applyFilters(rawData, filters);
      const beneficiariosFiltrados = new Set(filtered.map(item => item.nome_beneficiario)).size;
      const hasBenefSelection = filters.beneficiarios.size > 0;

      if (filtered.length === 0) {
        updateBenefUsage(beneficiariosFiltrados, hasBenefSelection);
        updateDiffCard({ totalDiferenca: 0 });
        diffLegend.textContent = 'Sem dados para os filtros aplicados.';
        insightsGrid.innerHTML = '';
        tableBody.innerHTML = '';
        tableBody.parentElement.style.display = 'none';
        emptyState.hidden = false;
        emptyState.textContent = 'Nenhum registro encontrado para os filtros selecionados.';
        energiaChart && updateChart(energiaChart, []);
        return;
      }

      const summary = summarize(filtered);
      updateBenefUsage(beneficiariosFiltrados, hasBenefSelection);
      updateDiffCard(summary);
      updateInsights(summary);
      updateTable(filtered);
      energiaChart && updateChart(energiaChart, filtered);
    }

    function initDashboard() {
      if (!rawData.length) {
        emptyState.hidden = false;
        emptyState.textContent = 'Dados embutidos não encontrados.';
        diffLegend.textContent = 'Sem dados carregados.';
        filtersForm.querySelectorAll('select, button').forEach(el => (el.disabled = true));
        return;
      }

      populateFilters(rawData);
      updateInstalacoesIndicator(rawData);
      energiaChart = buildChart(rawData);
      refreshDashboard();
    }

    filtersForm.addEventListener('input', refreshDashboard);
    filtersForm.addEventListener('change', refreshDashboard);
    filtersForm.addEventListener('reset', () => {
      setTimeout(() => {
        resetBenefCheckboxes();
        refreshDashboard();
      }, 0);
    });

    initDashboard();
  </script>
</body>
</html>

