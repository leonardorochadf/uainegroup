<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard de Energia - UAINE Group</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --bg: #f4fbf7;
      --card: #ffffff;
      --card-alt: #e9f6ef;
      --border: #c6e4d6;
      --accent: #0f9b9c;
      --accent-strong: #0d7c83;
      --positive: #22c55e;
      --negative: #ef4444;
      --text: #0f2a24;
      --muted: #5f7468;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: radial-gradient(120% 120% at 50% 0%, #b9f3d5 0%, var(--bg) 60%);
      color: var(--text);
      min-height: 100vh;
      padding: 24px;
    }

    header {
      max-width: 1200px;
      margin: 0 auto 32px auto;
      text-align: center;
    }

    .header-container {
      background: #ffffff;
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 32px 24px;
      box-shadow: 0 25px 70px rgba(15, 41, 36, 0.12);
      margin-bottom: 24px;
    }

    header h1 {
      margin: 0;
      font-size: 2.25rem;
      font-weight: 700;
      color: #22c55e;
      text-transform: uppercase;
    }

    .header-logo {
      display: block;
      margin: 16px auto;
      max-width: 200px;
      height: auto;
    }

    .header-metric {
      margin: 12px auto 0 auto;
      max-width: 720px;
      color: var(--muted);
      font-weight: 600;
      letter-spacing: 0.03em;
    }

    .footer-logo {
      display: block;
      margin: 40px auto 24px auto;
      max-width: 250px;
      height: auto;
      text-align: center;
    }

    main {
      max-width: 1200px;
      margin: 0 auto 80px auto;
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    section {
      background: rgba(255, 255, 255, 0.95);
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 24px;
      box-shadow: 0 25px 70px rgba(15, 41, 36, 0.12);
      backdrop-filter: blur(8px);
    }

    .section-title {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 18px;
      font-size: 1.1rem;
      font-weight: 600;
    }

    .section-title span {
      width: 34px;
      height: 34px;
      border-radius: 10px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background: rgba(15, 155, 156, 0.18);
      color: var(--accent);
      font-weight: 700;
    }

    .filters-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 16px;
    }

    .field-full {
      grid-column: 1 / -1;
    }

    .field-full select {
      width: 100%;
    }

    .checkbox-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
      background: var(--card-alt);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px;
      min-height: 200px;
      max-height: none;
    }

    .checkbox-filter-container {
      display: flex;
      flex-direction: column;
      gap: 8px;
      background: var(--card-alt);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 10px;
      max-height: 200px;
      overflow-y: auto;
    }

    .checkbox-filter-all {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 6px;
      font-weight: 600;
      font-size: 0.9rem;
      color: var(--accent);
      cursor: pointer;
      border-bottom: 1px solid var(--border);
      padding-bottom: 8px;
      margin-bottom: 4px;
    }

    .checkbox-filter-all input {
      accent-color: var(--accent);
      width: 16px;
      height: 16px;
      cursor: pointer;
    }

    .checkbox-filter-list {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .checkbox-filter-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 4px 6px;
      font-size: 0.85rem;
      cursor: pointer;
      border-radius: 4px;
      transition: background 0.2s;
    }

    .checkbox-filter-item:hover {
      background: rgba(15, 155, 156, 0.08);
    }

    .checkbox-filter-item input {
      accent-color: var(--accent);
      width: 16px;
      height: 16px;
      cursor: pointer;
    }

    .checkbox-filter-item label {
      cursor: pointer;
      flex: 1;
      user-select: none;
    }

    .checkbox-item {
      display: flex;
      gap: 12px;
      padding: 12px;
      border: 1px solid rgba(15, 155, 156, 0.12);
      border-radius: 12px;
      background: #fff;
      box-shadow: 0 6px 18px rgba(15, 41, 36, 0.08);
    }

    .checkbox-item.checkbox-all {
      align-items: center;
      justify-content: start;
      font-weight: 600;
      gap: 10px;
    }

    .checkbox-item input {
      accent-color: var(--accent);
      width: 18px;
      height: 18px;
      flex-shrink: 0;
      margin-top: 4px;
    }

    .checkbox-meta {
      display: flex;
      flex-direction: column;
      gap: 6px;
      width: 100%;
    }

    .benef-primary {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.95rem;
      color: var(--text);
    }

    .benef-primary span {
      font-size: 0.85rem;
      color: var(--muted);
    }

    .benef-metrics {
      display: block;
      width: 100%;
      margin-top: 8px;
    }
    

    .benef-boxes-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 12px;
      background: rgba(255, 255, 255, 0.5);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 12px;
      min-width: 0;
      overflow: visible;
    }

    .benef-atualmente-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 8px;
      background: rgba(255, 255, 255, 0.7);
      border: 2px solid var(--accent);
      border-radius: 12px;
      padding: 12px;
      min-width: 200px;
    }

    .benef-atualmente-title {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--accent);
      font-weight: 700;
      margin-bottom: 8px;
      border-bottom: 2px solid var(--accent);
      padding-bottom: 6px;
    }

    .benef-atualmente-boxes {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .benef-meta-row {
      display: flex;
      flex-direction: row;
      gap: 12px;
      align-items: stretch;
      width: 100%;
      margin-bottom: 20px;
      flex-shrink: 0;
      clear: both;
      position: relative;
      box-sizing: border-box;
    }
    
    .benef-meta-row:last-child {
      margin-bottom: 0;
    }
    
    .benef-meta-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 12px;
      min-width: 0;
      box-sizing: border-box;
    }
    
    .benef-year-data-container {
      display: flex;
      flex-direction: row;
      gap: 12px;
      align-items: flex-start;
      flex-wrap: nowrap;
      width: 100%;
      box-sizing: border-box;
    }
    
    .benef-year-data-left {
      display: flex;
      flex-direction: column;
      gap: 12px;
      flex: 0 0 25%;
      min-width: 0;
      box-sizing: border-box;
    }
    
    .benef-year-data-right {
      flex: 1 1 75%;
      min-width: 500px;
      max-width: 75%;
      box-sizing: border-box;
      display: flex;
      align-items: stretch;
    }
    
    .benef-year-data-right .benef-box {
      width: 100%;
      display: flex;
      flex-direction: column;
      height: auto;
      max-height: 400px;
    }
    
    .benef-year-data-right canvas {
      width: 100% !important;
      max-height: 350px !important;
      height: 350px !important;
      min-height: 350px;
    }
    
    .benef-meta {
      display: flex;
      flex-direction: row;
      gap: 12px;
      align-items: stretch;
      width: 100%;
      margin-bottom: 16px;
      flex-shrink: 0;
      min-height: 200px;
    }
    
    .benef-meta:last-child {
      margin-bottom: 0;
    }

    .benef-box {
      flex: 1;
      min-width: 160px;
      background: var(--card-alt);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .benef-year-indicator {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-width: 50px;
      align-self: stretch;
      background: linear-gradient(135deg, var(--accent), #4ade80);
      color: #fff;
      border-radius: 12px;
      padding: 12px 8px;
      font-weight: 700;
      font-size: 1.2rem;
      letter-spacing: 2px;
      writing-mode: vertical-rl;
      text-orientation: mixed;
      box-shadow: 0 4px 12px rgba(15, 155, 156, 0.3);
      white-space: nowrap;
    }
    
    .benef-year-indicator.multiple-years {
      writing-mode: horizontal-tb;
      text-orientation: unset;
      font-size: 0.9rem;
      padding: 8px 12px;
      min-width: auto;
    }

    .benef-box-title {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--muted);
      font-weight: 600;
      margin-bottom: 4px;
      border-bottom: 1px solid var(--border);
      padding-bottom: 4px;
    }

    .benef-box-item {
      font-size: 0.7rem;
      color: var(--muted);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .benef-box-item strong {
      color: var(--text);
      font-weight: 600;
      font-size: 0.7rem;
    }

    .benef-box-single {
      text-align: center;
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--accent);
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    label {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.04em;
      color: var(--muted);
    }

    select, input {
      background: var(--card-alt);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 10px 12px;
      color: var(--text);
      font-size: 0.95rem;
      transition: border 0.2s ease, box-shadow 0.2s ease;
    }

    select:focus, input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 2px rgba(15, 155, 156, 0.2);
    }

    button {
      background: linear-gradient(120deg, var(--accent), #4ade80);
      border: none;
      border-radius: 12px;
      color: #fff;
      font-weight: 600;
      font-size: 0.95rem;
      padding: 12px 18px;
      cursor: pointer;
      margin-top: 8px;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 12px 30px rgba(15, 155, 156, 0.3);
    }

    .highlight-card {
      display: flex;
      flex-direction: column;
      gap: 8px;
      padding: 20px;
      border-radius: 16px;
      background: linear-gradient(135deg, #e4fff5 0%, #ffffff 60%);
      border: 1px solid var(--border);
      margin-bottom: 16px;
    }

    .highlight-card[data-state="positive"] {
      border-color: rgba(34, 197, 94, 0.6);
      box-shadow: 0 10px 32px rgba(34, 197, 94, 0.2);
    }

    .highlight-card[data-state="negative"] {
      border-color: rgba(239, 68, 68, 0.5);
      box-shadow: 0 10px 32px rgba(239, 68, 68, 0.18);
    }

    .highlight-card small {
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-weight: 600;
      color: var(--muted);
    }

    .highlight-card strong {
      font-size: 2rem;
      letter-spacing: -0.02em;
    }

    .highlight-card p {
      margin: 0;
      color: var(--muted);
    }

    .year-summary-card {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      padding: 20px;
      border-radius: 16px;
      background: linear-gradient(135deg, #f9fffb 0%, #eefaf3 80%);
      border: 1px solid var(--border);
      margin-top: 16px;
    }

    .year-summary-item {
      display: flex;
      flex-direction: column;
      gap: 8px;
      padding: 16px;
      background: #fff;
      border-radius: 12px;
      border: 1px solid var(--border);
      box-shadow: 0 4px 12px rgba(15, 41, 36, 0.08);
    }

    .year-summary-item-label {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--muted);
      font-weight: 600;
    }

    .year-summary-item-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--text);
    }

    .year-summary-item-value.positive {
      color: var(--positive);
    }

    .year-summary-item-value.negative {
      color: var(--negative);
    }

    .year-summary-item-detail {
      font-size: 0.8rem;
      color: var(--muted);
      margin-top: 4px;
    }

    .summary-cards-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 16px;
      margin-top: 16px;
    }

    .summary-card {
      background: linear-gradient(135deg, #f9fffb 0%, #eefaf3 80%);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(15, 41, 36, 0.08);
    }

    .summary-card-title {
      font-size: 1rem;
      font-weight: 700;
      color: var(--text);
      margin-bottom: 16px;
      text-align: center;
      padding-bottom: 12px;
      border-bottom: 2px solid var(--border);
    }

    .summary-card-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 0;
      border-bottom: 1px solid rgba(15, 155, 156, 0.1);
    }

    .summary-card-item:last-child {
      border-bottom: none;
    }

    .summary-card-item-label {
      font-size: 0.9rem;
      color: var(--muted);
      font-weight: 500;
    }

    .summary-card-item-value {
      font-size: 1rem;
      font-weight: 700;
      color: var(--text);
    }

    .summary-card-item-value.positive {
      color: var(--positive);
    }

    .summary-card-item-value.negative {
      color: var(--negative);
    }

    .chart-container {
      position: relative;
      width: 100%;
      min-height: 320px;
    }

    .insights-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(190px, 1fr));
      gap: 16px;
    }

    .insight-card {
      background: linear-gradient(135deg, #fcfffd 0%, #e8f8f1 80%);
      border: 1px solid rgba(15, 155, 156, 0.12);
      border-radius: 14px;
      padding: 20px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      align-items: center;
      text-align: center;
      gap: 10px;
      min-height: 150px;
    }

    .insight-card span {
      font-size: 0.8rem;
      color: var(--muted);
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }

    .insight-card strong {
      font-size: 1.6rem;
      font-weight: 600;
    }

    .insight-card p {
      margin: 0;
      font-size: 0.85rem;
      color: var(--muted);
    }

    .table-wrapper {
      margin-top: 20px;
      border-radius: 14px;
      border: 1px solid var(--border);
      overflow: hidden;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.9rem;
    }

    thead {
      background: var(--card-alt);
    }

    th, td {
      padding: 12px 14px;
      text-align: left;
      border-bottom: 1px solid rgba(15, 42, 36, 0.08);
    }

    tbody tr:hover {
      background: rgba(15, 155, 156, 0.12);
    }

    .empty-state {
      text-align: center;
      padding: 40px 0;
      color: var(--muted);
    }

    @media (max-width: 640px) {
      body {
        padding: 16px;
      }
      section {
        padding: 18px;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="header-container">
      <h1>Analítica de Energia Contratada vs Recebida</h1>
      <img src="logo_cooperebr.jpg" alt="COOPEREBR - Energia Verde" class="header-logo">
    </div>
    <p id="instalacoesIndicator" class="header-metric">Instalações monitoradas: 0</p>
  </header>

  <main>
    <section>
      <div class="section-title">
        <span>01</span>
        <div>Filtros inteligentes</div>
      </div>
      <form id="filters" class="filters-grid">
        <div class="field">
          <label for="parceiroFilter">Parceiro</label>
          <select id="parceiroFilter">
            <option value="">Todos</option>
          </select>
        </div>
        <div class="field">
          <label>Ano</label>
          <div class="checkbox-filter-container" id="anoFilterContainer">
            <label class="checkbox-filter-all">
              <input type="checkbox" id="anoFilterAll" data-filter="ano">
              <span>Todos</span>
            </label>
            <div class="checkbox-filter-list" id="anoFilterList"></div>
          </div>
        </div>
        <div class="field">
          <label>Semestre</label>
          <div class="checkbox-filter-container" id="semestreFilterContainer">
            <label class="checkbox-filter-all">
              <input type="checkbox" id="semestreFilterAll" data-filter="semestre">
              <span>Todos</span>
            </label>
            <div class="checkbox-filter-list" id="semestreFilterList"></div>
          </div>
        </div>
        <div class="field">
          <label>Mês / Ano</label>
          <div class="checkbox-filter-container" id="mesFilterContainer">
            <label class="checkbox-filter-all">
              <input type="checkbox" id="mesFilterAll" data-filter="mes">
              <span>Todos</span>
            </label>
            <div class="checkbox-filter-list" id="mesFilterList"></div>
          </div>
        </div>
        <div class="field">
          <label>Instalação</label>
          <div class="checkbox-filter-container" id="instalacaoFilterContainer">
            <label class="checkbox-filter-all">
              <input type="checkbox" id="instalacaoFilterAll" data-filter="instalacao">
              <span>Todas</span>
            </label>
            <div class="checkbox-filter-list" id="instalacaoFilterList"></div>
          </div>
        </div>
        <div class="field field-full">
          <label for="benefFilter">Benefici├írio</label>
          <div id="benefFilter" class="checkbox-list"></div>
        </div>
        <button type="reset">Limpar filtros</button>
      </form>
    </section>

    <section>
      <h2 class="section-title" style="margin-bottom: 16px; font-size: 1.2rem; font-weight: 700;">
        Total Período Filtro
      </h2>
      <div class="highlight-card" id="diffCard" data-state="positive">
        <small>Balanço recebido x contratado</small>
        <strong id="diffValue">0 kWh</strong>
        <p id="diffLegend">Nenhum filtro aplicado</p>
      </div>
      <div class="year-summary-card" id="yearSummaryCard" hidden>
        <div class="year-summary-item">
          <div class="year-summary-item-label">kWh Contratados (Período Filtro)</div>
          <div class="year-summary-item-value" id="yearContratado">0</div>
        </div>
        <div class="year-summary-item">
          <div class="year-summary-item-label">kWh Recebidos (Período Filtro)</div>
          <div class="year-summary-item-value" id="yearRecebido">0</div>
        </div>
        <div class="year-summary-item">
          <div class="year-summary-item-label">Diferença</div>
          <div class="year-summary-item-value" id="yearDiferenca">0</div>
          <div class="year-summary-item-detail" id="yearDiferencaDetail"></div>
        </div>
        <div class="year-summary-item">
          <div class="year-summary-item-label">% Diferença</div>
          <div class="year-summary-item-value" id="yearPercentual">0%</div>
        </div>
      </div>
      <div class="summary-cards-container" id="summaryCardsContainer" hidden>
        <div class="summary-card" id="valorMedioKwhCard">
          <div class="summary-card-title">Valor Médio kWh</div>
          <div class="summary-card-item">
            <span class="summary-card-item-label">Valor Médio Contratado:</span>
            <span class="summary-card-item-value" id="valorMedioKwh">R$ 0,00</span>
          </div>
          <div class="summary-card-item">
            <span class="summary-card-item-label">Valor Médio kWh EDP:</span>
            <span class="summary-card-item-value" id="valorMedioKwhEdpCard">R$ 0,00</span>
          </div>
          <div class="summary-card-item">
            <span class="summary-card-item-label">Comparação com EDP:</span>
            <span class="summary-card-item-value" id="comparacaoEdp">0%</span>
          </div>
        </div>
        <div class="summary-card" id="valorMedioAnoCard">
          <div class="summary-card-title">Valores Totais</div>
          <div class="summary-card-item">
            <span class="summary-card-item-label">Soma da Mensalidade:</span>
            <span class="summary-card-item-value" id="somaMensalidadeAno">R$ 0</span>
          </div>
          <div class="summary-card-item">
            <span class="summary-card-item-label">Soma do kWh:</span>
            <span class="summary-card-item-value" id="somaKwhAno">0</span>
          </div>
          <div class="summary-card-item">
            <span class="summary-card-item-label">Média Valor kWh EDP:</span>
            <span class="summary-card-item-value" id="mediaKwhEdpAno">R$ 0,00</span>
          </div>
          <div class="summary-card-item">
            <span class="summary-card-item-label">Soma kWh Recebido:</span>
            <span class="summary-card-item-value" id="somaKwhRecebidoAno">0</span>
          </div>
        </div>
      </div>
      <div class="section-title">
        <span>02</span>
        <div>Distribuição mensal</div>
      </div>
      <div class="chart-container">
        <canvas id="energiaChart" aria-label="Gr├ífico contratado vs recebido" role="img"></canvas>
      </div>
    </section>

    <section>
      <div class="section-title">
        <span>03</span>
        <div>Insights-chave Filtro</div>
      </div>
      <div class="insights-grid" id="insightsGrid">
        <!-- preenchido via JS -->
      </div>
      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>Mês/Ano</th>
              <th>Instalação</th>
              <th>Beneficiário</th>
              <th>kWh contratado</th>
              <th>kWh recebido</th>
              <th>Diferença</th>
              <th>Mensalidade (R$)</th>
              <th>Valor kWh</th>
              <th>Valor kWh EDP</th>
              <th>% Desc. Energia</th>
              <th>% Desc. Aplicado</th>
            </tr>
          </thead>
          <tbody id="tableBody">
            <!-- preenchido via JS -->
          </tbody>
        </table>
        <div class="empty-state" id="emptyState" hidden>
          Nenhum registro encontrado para os filtros selecionados.
        </div>
      </div>
    </section>

    <section>
      <div class="section-title">
        <span>04</span>
        <div>Energia Total Gerada pela Usina</div>
      </div>
      <div class="chart-container">
        <canvas id="usinaChart" aria-label="Gráfico energia gerada pela usina" role="img"></canvas>
      </div>
      <div class="table-wrapper" style="margin-top: 24px;">
        <table id="usinaTable" style="width: 100%; border-collapse: collapse;">
          <thead id="usinaTableHead">
            <!-- preenchido via JS -->
          </thead>
          <tbody id="usinaTableBody">
            <!-- preenchido via JS -->
          </tbody>
        </table>
      </div>
      <div id="usinaSummaryContainer" style="margin-top: 32px; display: flex; flex-direction: column; gap: 24px;">
        <!-- Resumo por ano será inserido aqui via JS -->
        <div id="usinaYearSummary" style="display: flex; flex-wrap: wrap; gap: 16px;">
          <!-- Caixas por ano serão inseridas aqui -->
        </div>
        <!-- Resumo geral -->
        <div id="usinaGeneralSummary" style="display: flex; flex-wrap: wrap; gap: 16px;">
          <!-- Caixas gerais serão inseridas aqui -->
        </div>
      </div>
    </section>

    <section>
      <div class="section-title">
        <span>05</span>
        <div>Análise de Performance da Usina</div>
      </div>
      <div id="usinaPerformanceContainer" style="display: flex; flex-direction: column; gap: 24px;">
        <!-- Análises de performance serão inseridas aqui via JS -->
      </div>
    </section>

    <!-- Dashboard Executivo -->
    <section id="executiveDashboard" style="background: linear-gradient(135deg, rgba(15, 155, 156, 0.1) 0%, rgba(15, 155, 156, 0.05) 100%);">
      <div class="section-title">
        <span>06</span>
        <div>Dashboard Executivo</div>
      </div>
      <div id="executiveKPIs" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-top: 20px;">
        <!-- KPIs serão inseridos aqui via JS -->
      </div>
    </section>
  </main>

  <script>
    // ============================================
    // FUNÇÃO DE CARREGAMENTO DE DADOS
    // ============================================
    // Para carregar de um endpoint no futuro, substitua esta função por:
    // async function loadDashboardData() {
    //   const response = await fetch('https://seu-endpoint.com/api/dados');
    //   const json = await response.json();
    //   return json.detalhamento_beneficiarios || [];
    // }
    // ============================================
    function loadDashboardData() {
      // Dados embutidos atualmente - pode ser removido quando usar endpoint
      return [{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-12-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":7217.13,"valorMensalidade":5281.46,"percent_desc_energia":10,"valor_kwh":0.73,"percentual_desconto_aplicado":17.78,"edp_total_kwh":7524,"edp_dif_recebidos_x_contratado":306.86999999999989,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-01-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":7217.13,"valorMensalidade":5281.46,"percent_desc_energia":10,"valor_kwh":0.73,"percentual_desconto_aplicado":17.78,"edp_total_kwh":7091,"edp_dif_recebidos_x_contratado":-126.13000000000009,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-02-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6495,"valorMensalidade":6062.39,"percent_desc_energia":10,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":6476,"edp_dif_recebidos_x_contratado":-19,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-03-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6495,"valorMensalidade":6062.39,"percent_desc_energia":10,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":8502,"edp_dif_recebidos_x_contratado":2007,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-04-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":7217.13,"valorMensalidade":6062.39,"percent_desc_energia":10,"valor_kwh":0.84,"percentual_desconto_aplicado":5.62,"edp_total_kwh":7527,"edp_dif_recebidos_x_contratado":309.86999999999989,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-05-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6495,"valorMensalidade":6062.39,"percent_desc_energia":10,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":6474,"edp_dif_recebidos_x_contratado":-21,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-06-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6495,"valorMensalidade":6062.39,"percent_desc_energia":10,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":5238,"edp_dif_recebidos_x_contratado":-1257,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-07-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6495,"valorMensalidade":6062.39,"percent_desc_energia":10,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":5506,"edp_dif_recebidos_x_contratado":-989,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-08-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6495,"valorMensalidade":6062.39,"percent_desc_energia":10,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":6094,"edp_dif_recebidos_x_contratado":-401,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-09-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6495,"valorMensalidade":6062.39,"percent_desc_energia":10,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":6334,"edp_dif_recebidos_x_contratado":-161,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-10-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6495,"valorMensalidade":6062.39,"percent_desc_energia":10,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":5648,"edp_dif_recebidos_x_contratado":-847,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-11-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6495,"valorMensalidade":6574,"percent_desc_energia":10,"valor_kwh":1.01,"percentual_desconto_aplicado":0,"edp_total_kwh":4641,"edp_dif_recebidos_x_contratado":-1854,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-12-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6495,"valorMensalidade":6584,"percent_desc_energia":10,"valor_kwh":1.01,"percentual_desconto_aplicado":0,"edp_total_kwh":6191,"edp_dif_recebidos_x_contratado":-304,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-01-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":7217.13,"valorMensalidade":6062.39,"percent_desc_energia":10,"valor_kwh":0.84,"percentual_desconto_aplicado":22.22,"edp_total_kwh":5787,"edp_dif_recebidos_x_contratado":-1430.13,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-02-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6495,"valorMensalidade":6584,"percent_desc_energia":10,"valor_kwh":1.01,"percentual_desconto_aplicado":6.14,"edp_total_kwh":6719,"edp_dif_recebidos_x_contratado":224,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-03-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6495,"valorMensalidade":6584,"percent_desc_energia":10,"valor_kwh":1.01,"percentual_desconto_aplicado":6.14,"edp_total_kwh":7263,"edp_dif_recebidos_x_contratado":768,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-04-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6495,"valorMensalidade":6584,"percent_desc_energia":10,"valor_kwh":1.01,"percentual_desconto_aplicado":6.14,"edp_total_kwh":5641,"edp_dif_recebidos_x_contratado":-854,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-05-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6495,"valorMensalidade":6584,"percent_desc_energia":10,"valor_kwh":1.01,"percentual_desconto_aplicado":6.14,"edp_total_kwh":5066,"edp_dif_recebidos_x_contratado":-1429,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-06-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6495,"valorMensalidade":6584,"percent_desc_energia":10,"valor_kwh":1.01,"percentual_desconto_aplicado":6.14,"edp_total_kwh":5434,"edp_dif_recebidos_x_contratado":-1061,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-07-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6495,"valorMensalidade":6584,"percent_desc_energia":10,"valor_kwh":1.01,"percentual_desconto_aplicado":12.61,"edp_total_kwh":5654,"edp_dif_recebidos_x_contratado":-841,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.1600},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-08-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6495,"valorMensalidade":6574,"percent_desc_energia":10,"valor_kwh":1.01,"percentual_desconto_aplicado":12.74,"edp_total_kwh":6020,"edp_dif_recebidos_x_contratado":-475,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":1.1600},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-12-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1209.57,"valorMensalidade":1283.85,"percent_desc_energia":15,"valor_kwh":1.06,"percentual_desconto_aplicado":0,"edp_total_kwh":1267,"edp_dif_recebidos_x_contratado":57.430000000000057,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-01-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1209.57,"valorMensalidade":1283.85,"percent_desc_energia":15,"valor_kwh":1.06,"percentual_desconto_aplicado":0,"edp_total_kwh":1194,"edp_dif_recebidos_x_contratado":-15.56999999999994,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-02-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1090,"valorMensalidade":1016.04,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":1090,"edp_dif_recebidos_x_contratado":0,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-03-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1090,"valorMensalidade":1016.04,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":1431,"edp_dif_recebidos_x_contratado":341,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-04-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1209.57,"valorMensalidade":1016.04,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":5.62,"edp_total_kwh":1267,"edp_dif_recebidos_x_contratado":57.430000000000057,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-05-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1090,"valorMensalidade":1016.04,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":1081,"edp_dif_recebidos_x_contratado":-9,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-06-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1090,"valorMensalidade":1016.04,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":875,"edp_dif_recebidos_x_contratado":-215,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-07-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1090,"valorMensalidade":1016.04,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":920,"edp_dif_recebidos_x_contratado":-170,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-08-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1090,"valorMensalidade":1016.04,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":1018,"edp_dif_recebidos_x_contratado":-72,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-09-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1090,"valorMensalidade":1016.04,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":1066,"edp_dif_recebidos_x_contratado":-24,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-10-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1090,"valorMensalidade":1016.04,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":943,"edp_dif_recebidos_x_contratado":-147,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-11-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1090,"valorMensalidade":1101.9,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":0,"edp_total_kwh":775,"edp_dif_recebidos_x_contratado":-315,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-12-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1090,"valorMensalidade":1111.9,"percent_desc_energia":15,"valor_kwh":1.02,"percentual_desconto_aplicado":0,"edp_total_kwh":1034,"edp_dif_recebidos_x_contratado":-56,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-01-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1209.57,"valorMensalidade":1016.04,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":22.22,"edp_total_kwh":976,"edp_dif_recebidos_x_contratado":-233.56999999999991,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-02-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1090,"valorMensalidade":1111.9,"percent_desc_energia":15,"valor_kwh":1.02,"percentual_desconto_aplicado":5.55,"edp_total_kwh":1133,"edp_dif_recebidos_x_contratado":43,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-03-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1090,"valorMensalidade":1111.9,"percent_desc_energia":15,"valor_kwh":1.02,"percentual_desconto_aplicado":5.55,"edp_total_kwh":1224,"edp_dif_recebidos_x_contratado":134,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-04-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1090,"valorMensalidade":1111.9,"percent_desc_energia":15,"valor_kwh":1.02,"percentual_desconto_aplicado":5.55,"edp_total_kwh":951,"edp_dif_recebidos_x_contratado":-139,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-05-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1090,"valorMensalidade":1111.9,"percent_desc_energia":15,"valor_kwh":1.02,"percentual_desconto_aplicado":5.55,"edp_total_kwh":854,"edp_dif_recebidos_x_contratado":-236,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-06-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1090,"valorMensalidade":1111.9,"percent_desc_energia":15,"valor_kwh":1.02,"percentual_desconto_aplicado":5.55,"edp_total_kwh":916,"edp_dif_recebidos_x_contratado":-174,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-07-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1090,"valorMensalidade":1111.9,"percent_desc_energia":15,"valor_kwh":1.02,"percentual_desconto_aplicado":12.06,"edp_total_kwh":953,"edp_dif_recebidos_x_contratado":-137,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.1600},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-08-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1090,"valorMensalidade":1101.9,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":12.85,"edp_total_kwh":1014,"edp_dif_recebidos_x_contratado":-76,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":1.1600},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-12-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA DÂ´AMPEZZO LTDA","kWhDisponibilizadosMes":2347.91,"valorMensalidade":1662.3,"percent_desc_energia":15,"valor_kwh":0.71,"percentual_desconto_aplicado":20.45,"edp_total_kwh":2456,"edp_dif_recebidos_x_contratado":108.0900000000002,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-01-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA DÂ´AMPEZZO LTDA","kWhDisponibilizadosMes":2347.91,"valorMensalidade":1662.3,"percent_desc_energia":15,"valor_kwh":0.71,"percentual_desconto_aplicado":20.45,"edp_total_kwh":2314,"edp_dif_recebidos_x_contratado":-33.909999999999847,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-02-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA DÂ´AMPEZZO LTDA","kWhDisponibilizadosMes":2050,"valorMensalidade":1972.24,"percent_desc_energia":15,"valor_kwh":0.96,"percentual_desconto_aplicado":0,"edp_total_kwh":2113,"edp_dif_recebidos_x_contratado":63,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-03-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA DÂ´AMPEZZO LTDA","kWhDisponibilizadosMes":2050,"valorMensalidade":1972.24,"percent_desc_energia":15,"valor_kwh":0.96,"percentual_desconto_aplicado":0,"edp_total_kwh":2775,"edp_dif_recebidos_x_contratado":725,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-04-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA DÂ´AMPEZZO LTDA","kWhDisponibilizadosMes":2347.91,"valorMensalidade":1972.24,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":5.62,"edp_total_kwh":2456,"edp_dif_recebidos_x_contratado":108.0900000000002,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-05-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA DÂ´AMPEZZO LTDA","kWhDisponibilizadosMes":2050,"valorMensalidade":1972.24,"percent_desc_energia":15,"valor_kwh":0.96,"percentual_desconto_aplicado":0,"edp_total_kwh":2039,"edp_dif_recebidos_x_contratado":-11,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-06-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA DÂ´AMPEZZO LTDA","kWhDisponibilizadosMes":2050,"valorMensalidade":1972.24,"percent_desc_energia":15,"valor_kwh":0.96,"percentual_desconto_aplicado":0,"edp_total_kwh":1660,"edp_dif_recebidos_x_contratado":-390,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-07-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA DÂ´AMPEZZO LTDA","kWhDisponibilizadosMes":2050,"valorMensalidade":1972.24,"percent_desc_energia":15,"valor_kwh":0.96,"percentual_desconto_aplicado":0,"edp_total_kwh":1745,"edp_dif_recebidos_x_contratado":-305,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-08-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA DÂ´AMPEZZO LTDA","kWhDisponibilizadosMes":2050,"valorMensalidade":1972.24,"percent_desc_energia":15,"valor_kwh":0.96,"percentual_desconto_aplicado":0,"edp_total_kwh":1931,"edp_dif_recebidos_x_contratado":-119,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-09-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA DÂ´AMPEZZO LTDA","kWhDisponibilizadosMes":2050,"valorMensalidade":1972.24,"percent_desc_energia":15,"valor_kwh":0.96,"percentual_desconto_aplicado":0,"edp_total_kwh":1993,"edp_dif_recebidos_x_contratado":-57,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-10-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA DÂ´AMPEZZO LTDA","kWhDisponibilizadosMes":2050,"valorMensalidade":1972.24,"percent_desc_energia":15,"valor_kwh":0.96,"percentual_desconto_aplicado":0,"edp_total_kwh":1790,"edp_dif_recebidos_x_contratado":-260,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-11-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA DÂ´AMPEZZO LTDA","kWhDisponibilizadosMes":2050,"valorMensalidade":2133.72,"percent_desc_energia":15,"valor_kwh":1.04,"percentual_desconto_aplicado":0,"edp_total_kwh":1471,"edp_dif_recebidos_x_contratado":-579,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-12-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA DÂ´AMPEZZO LTDA","kWhDisponibilizadosMes":2050,"valorMensalidade":2143.72,"percent_desc_energia":15,"valor_kwh":1.05,"percentual_desconto_aplicado":0,"edp_total_kwh":1950,"edp_dif_recebidos_x_contratado":-100,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-01-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA DÂ´AMPEZZO LTDA","kWhDisponibilizadosMes":2347.91,"valorMensalidade":1972.24,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":22.22,"edp_total_kwh":1828,"edp_dif_recebidos_x_contratado":-519.90999999999985,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-02-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA DÂ´AMPEZZO LTDA","kWhDisponibilizadosMes":2050,"valorMensalidade":2143.72,"percent_desc_energia":15,"valor_kwh":1.05,"percentual_desconto_aplicado":3.17,"edp_total_kwh":2122,"edp_dif_recebidos_x_contratado":72,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-03-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA DÂ´AMPEZZO LTDA","kWhDisponibilizadosMes":2050,"valorMensalidade":2143.72,"percent_desc_energia":15,"valor_kwh":1.05,"percentual_desconto_aplicado":3.17,"edp_total_kwh":2298,"edp_dif_recebidos_x_contratado":248,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-04-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA DÂ´AMPEZZO LTDA","kWhDisponibilizadosMes":2050,"valorMensalidade":2143.72,"percent_desc_energia":15,"valor_kwh":1.05,"percentual_desconto_aplicado":3.17,"edp_total_kwh":1784,"edp_dif_recebidos_x_contratado":-266,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-05-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA DÂ´AMPEZZO LTDA","kWhDisponibilizadosMes":2050,"valorMensalidade":2143.72,"percent_desc_energia":15,"valor_kwh":1.05,"percentual_desconto_aplicado":3.17,"edp_total_kwh":1602,"edp_dif_recebidos_x_contratado":-448,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-06-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA DÂ´AMPEZZO LTDA","kWhDisponibilizadosMes":2050,"valorMensalidade":2143.72,"percent_desc_energia":15,"valor_kwh":1.05,"percentual_desconto_aplicado":3.17,"edp_total_kwh":1719,"edp_dif_recebidos_x_contratado":-331,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-07-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA DÂ´AMPEZZO LTDA","kWhDisponibilizadosMes":2050,"valorMensalidade":2143.72,"percent_desc_energia":15,"valor_kwh":1.05,"percentual_desconto_aplicado":9.85,"edp_total_kwh":1789,"edp_dif_recebidos_x_contratado":-261,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.1600},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-08-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA DÂ´AMPEZZO LTDA","kWhDisponibilizadosMes":2050,"valorMensalidade":2133.72,"percent_desc_energia":15,"valor_kwh":1.04,"percentual_desconto_aplicado":10.27,"edp_total_kwh":1904,"edp_dif_recebidos_x_contratado":-146,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":1.1600},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-12-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":4180.92,"valorMensalidade":3039.04,"percent_desc_energia":15,"valor_kwh":0.73,"percentual_desconto_aplicado":18.33,"edp_total_kwh":4364,"edp_dif_recebidos_x_contratado":183.0799999999999,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-01-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":4180.92,"valorMensalidade":3039.04,"percent_desc_energia":15,"valor_kwh":0.73,"percentual_desconto_aplicado":18.33,"edp_total_kwh":4113,"edp_dif_recebidos_x_contratado":-67.920000000000073,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-02-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3780,"valorMensalidade":3511.97,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":3756,"edp_dif_recebidos_x_contratado":-24,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-03-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3780,"valorMensalidade":3511.97,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":4931,"edp_dif_recebidos_x_contratado":1151,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-04-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":4180.92,"valorMensalidade":3511.97,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":5.62,"edp_total_kwh":4366,"edp_dif_recebidos_x_contratado":185.0799999999999,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-05-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3780,"valorMensalidade":3511.97,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":3770,"edp_dif_recebidos_x_contratado":-10,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-06-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3780,"valorMensalidade":3511.97,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":3050,"edp_dif_recebidos_x_contratado":-730,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-07-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3780,"valorMensalidade":3511.97,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":3206,"edp_dif_recebidos_x_contratado":-574,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-08-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3780,"valorMensalidade":3511.97,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":3548,"edp_dif_recebidos_x_contratado":-232,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-09-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3780,"valorMensalidade":3511.97,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":3692,"edp_dif_recebidos_x_contratado":-88,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-10-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3780,"valorMensalidade":3511.97,"percent_desc_energia":15,"valor_kwh":0.93,"percentual_desconto_aplicado":0,"edp_total_kwh":3289,"edp_dif_recebidos_x_contratado":-491,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-11-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3780,"valorMensalidade":3809.72,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":0,"edp_total_kwh":2702,"edp_dif_recebidos_x_contratado":-1078,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-12-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3780,"valorMensalidade":3819.72,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":0,"edp_total_kwh":3605,"edp_dif_recebidos_x_contratado":-175,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-01-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":4180.92,"valorMensalidade":3511.97,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":22.22,"edp_total_kwh":3368,"edp_dif_recebidos_x_contratado":-812.92000000000007,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-02-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3780,"valorMensalidade":3819.72,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":6.43,"edp_total_kwh":3910,"edp_dif_recebidos_x_contratado":130,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-03-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3780,"valorMensalidade":3819.72,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":6.43,"edp_total_kwh":4227,"edp_dif_recebidos_x_contratado":447,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-04-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3780,"valorMensalidade":3819.72,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":6.43,"edp_total_kwh":3283,"edp_dif_recebidos_x_contratado":-497,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-05-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3780,"valorMensalidade":3819.72,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":6.43,"edp_total_kwh":2948,"edp_dif_recebidos_x_contratado":-832,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-06-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3780,"valorMensalidade":3819.72,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":6.43,"edp_total_kwh":3162,"edp_dif_recebidos_x_contratado":-618,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-07-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3780,"valorMensalidade":3819.72,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":12.89,"edp_total_kwh":3291,"edp_dif_recebidos_x_contratado":-489,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.1600},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-08-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3780,"valorMensalidade":3809.72,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":13.12,"edp_total_kwh":3503,"edp_dif_recebidos_x_contratado":-277,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":1.1600},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-12-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2276.78,"valorMensalidade":2455.51,"percent_desc_energia":15,"valor_kwh":1.08,"percentual_desconto_aplicado":0,"edp_total_kwh":2377,"edp_dif_recebidos_x_contratado":100.2199999999998,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-01-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2276.78,"valorMensalidade":2455.51,"percent_desc_energia":15,"valor_kwh":1.08,"percentual_desconto_aplicado":0,"edp_total_kwh":2240,"edp_dif_recebidos_x_contratado":-36.7800000000002,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-02-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2076,"valorMensalidade":1912.5,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":0,"edp_total_kwh":2046,"edp_dif_recebidos_x_contratado":-30,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-03-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2076,"valorMensalidade":1912.5,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":0,"edp_total_kwh":2686,"edp_dif_recebidos_x_contratado":610,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-04-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2276.78,"valorMensalidade":1912.5,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":5.62,"edp_total_kwh":2378,"edp_dif_recebidos_x_contratado":101.2199999999998,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-05-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2076,"valorMensalidade":1912.5,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":0,"edp_total_kwh":2070,"edp_dif_recebidos_x_contratado":-6,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-06-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2076,"valorMensalidade":1912.5,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":0,"edp_total_kwh":1673,"edp_dif_recebidos_x_contratado":-403,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-07-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2076,"valorMensalidade":1912.5,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":0,"edp_total_kwh":1758,"edp_dif_recebidos_x_contratado":-318,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-08-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2076,"valorMensalidade":1912.5,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":0,"edp_total_kwh":1946,"edp_dif_recebidos_x_contratado":-130,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-09-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2076,"valorMensalidade":1912.5,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":0,"edp_total_kwh":2024,"edp_dif_recebidos_x_contratado":-52,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-10-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2076,"valorMensalidade":1912.5,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":0,"edp_total_kwh":1804,"edp_dif_recebidos_x_contratado":-272,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-11-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2076,"valorMensalidade":2076.03,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":0,"edp_total_kwh":1482,"edp_dif_recebidos_x_contratado":-594,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-12-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2076,"valorMensalidade":2086.03,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":0,"edp_total_kwh":1979,"edp_dif_recebidos_x_contratado":-97,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-01-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2276.78,"valorMensalidade":1912.5,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":22.22,"edp_total_kwh":1855,"edp_dif_recebidos_x_contratado":-421.7800000000002,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-02-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2076,"valorMensalidade":2086.03,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":6.96,"edp_total_kwh":2154,"edp_dif_recebidos_x_contratado":78,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-03-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2076,"valorMensalidade":2086.03,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":6.96,"edp_total_kwh":2315,"edp_dif_recebidos_x_contratado":239,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-04-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2076,"valorMensalidade":2086.03,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":6.96,"edp_total_kwh":1797,"edp_dif_recebidos_x_contratado":-279,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-05-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2076,"valorMensalidade":2086.03,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":6.96,"edp_total_kwh":1614,"edp_dif_recebidos_x_contratado":-462,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-06-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2076,"valorMensalidade":2086.03,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":6.96,"edp_total_kwh":1731,"edp_dif_recebidos_x_contratado":-345,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-07-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2076,"valorMensalidade":2086.03,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":13.38,"edp_total_kwh":1802,"edp_dif_recebidos_x_contratado":-274,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.1600},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-08-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2076,"valorMensalidade":2076.03,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":13.79,"edp_total_kwh":1918,"edp_dif_recebidos_x_contratado":-158,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":1.1600},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-12-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1535.09,"valorMensalidade":778.35,"percent_desc_energia":15,"valor_kwh":0.51,"percentual_desconto_aplicado":43.03,"edp_total_kwh":1595,"edp_dif_recebidos_x_contratado":59.910000000000082,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-01-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1535.09,"valorMensalidade":778.35,"percent_desc_energia":15,"valor_kwh":0.51,"percentual_desconto_aplicado":43.03,"edp_total_kwh":1503,"edp_dif_recebidos_x_contratado":-32.089999999999918,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-02-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1355,"valorMensalidade":1289.48,"percent_desc_energia":15,"valor_kwh":0.95,"percentual_desconto_aplicado":0,"edp_total_kwh":1373,"edp_dif_recebidos_x_contratado":18,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-03-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1355,"valorMensalidade":1289.48,"percent_desc_energia":15,"valor_kwh":0.95,"percentual_desconto_aplicado":0,"edp_total_kwh":1802,"edp_dif_recebidos_x_contratado":447,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-04-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1535.09,"valorMensalidade":1289.48,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":5.62,"edp_total_kwh":1596,"edp_dif_recebidos_x_contratado":60.910000000000082,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-05-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1355,"valorMensalidade":1289.48,"percent_desc_energia":15,"valor_kwh":0.95,"percentual_desconto_aplicado":0,"edp_total_kwh":1344,"edp_dif_recebidos_x_contratado":-11,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-06-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1355,"valorMensalidade":1289.48,"percent_desc_energia":15,"valor_kwh":0.95,"percentual_desconto_aplicado":0,"edp_total_kwh":1094,"edp_dif_recebidos_x_contratado":-261,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-07-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1355,"valorMensalidade":1289.48,"percent_desc_energia":15,"valor_kwh":0.95,"percentual_desconto_aplicado":0,"edp_total_kwh":1150,"edp_dif_recebidos_x_contratado":-205,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-08-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1355,"valorMensalidade":1289.48,"percent_desc_energia":15,"valor_kwh":0.95,"percentual_desconto_aplicado":0,"edp_total_kwh":1272,"edp_dif_recebidos_x_contratado":-83,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-09-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1355,"valorMensalidade":1289.48,"percent_desc_energia":15,"valor_kwh":0.95,"percentual_desconto_aplicado":0,"edp_total_kwh":1313,"edp_dif_recebidos_x_contratado":-42,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-10-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1355,"valorMensalidade":1289.48,"percent_desc_energia":15,"valor_kwh":0.95,"percentual_desconto_aplicado":0,"edp_total_kwh":1179,"edp_dif_recebidos_x_contratado":-176,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-11-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1355,"valorMensalidade":1396.21,"percent_desc_energia":15,"valor_kwh":1.03,"percentual_desconto_aplicado":0,"edp_total_kwh":969,"edp_dif_recebidos_x_contratado":-386,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-12-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1355,"valorMensalidade":1406.21,"percent_desc_energia":15,"valor_kwh":1.04,"percentual_desconto_aplicado":0,"edp_total_kwh":1285,"edp_dif_recebidos_x_contratado":-70,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-01-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1535.09,"valorMensalidade":1289.48,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":22.22,"edp_total_kwh":1209,"edp_dif_recebidos_x_contratado":-326.08999999999992,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-02-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1355,"valorMensalidade":1406.21,"percent_desc_energia":15,"valor_kwh":1.04,"percentual_desconto_aplicado":3.91,"edp_total_kwh":1404,"edp_dif_recebidos_x_contratado":49,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-03-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1355,"valorMensalidade":1406.21,"percent_desc_energia":15,"valor_kwh":1.04,"percentual_desconto_aplicado":3.91,"edp_total_kwh":1509,"edp_dif_recebidos_x_contratado":154,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-04-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1355,"valorMensalidade":1406.21,"percent_desc_energia":15,"valor_kwh":1.04,"percentual_desconto_aplicado":3.91,"edp_total_kwh":1172,"edp_dif_recebidos_x_contratado":-183,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-05-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1355,"valorMensalidade":1406.21,"percent_desc_energia":15,"valor_kwh":1.04,"percentual_desconto_aplicado":3.91,"edp_total_kwh":1053,"edp_dif_recebidos_x_contratado":-302,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-06-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1355,"valorMensalidade":1406.21,"percent_desc_energia":15,"valor_kwh":1.04,"percentual_desconto_aplicado":3.91,"edp_total_kwh":1129,"edp_dif_recebidos_x_contratado":-226,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-07-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1355,"valorMensalidade":1406.21,"percent_desc_energia":15,"valor_kwh":1.04,"percentual_desconto_aplicado":10.54,"edp_total_kwh":1175,"edp_dif_recebidos_x_contratado":-180,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.1600},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-08-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1355,"valorMensalidade":1396.21,"percent_desc_energia":15,"valor_kwh":1.03,"percentual_desconto_aplicado":11.17,"edp_total_kwh":1251,"edp_dif_recebidos_x_contratado":-104,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":1.1600},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-12-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":9056.35,"valorMensalidade":6257.31,"percent_desc_energia":15,"valor_kwh":0.69,"percentual_desconto_aplicado":22.37,"edp_total_kwh":9449,"edp_dif_recebidos_x_contratado":392.64999999999958,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-01-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":9056.35,"valorMensalidade":6257.31,"percent_desc_energia":15,"valor_kwh":0.69,"percentual_desconto_aplicado":22.37,"edp_total_kwh":8904,"edp_dif_recebidos_x_contratado":-152.35000000000039,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-02-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8500,"valorMensalidade":7607.33,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":0,"edp_total_kwh":8132,"edp_dif_recebidos_x_contratado":-368,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-03-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8500,"valorMensalidade":7607.33,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":0,"edp_total_kwh":10676,"edp_dif_recebidos_x_contratado":2176,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-04-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":9056.35,"valorMensalidade":7607.33,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":5.62,"edp_total_kwh":9452,"edp_dif_recebidos_x_contratado":395.64999999999958,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-05-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8500,"valorMensalidade":7607.33,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":0,"edp_total_kwh":8467,"edp_dif_recebidos_x_contratado":-33,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-06-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8500,"valorMensalidade":7607.33,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":0,"edp_total_kwh":6860,"edp_dif_recebidos_x_contratado":-1640,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-07-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8500,"valorMensalidade":7607.33,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":0.56,"edp_total_kwh":7211,"edp_dif_recebidos_x_contratado":-1289,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-08-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8500,"valorMensalidade":7607.33,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":0.56,"edp_total_kwh":7981,"edp_dif_recebidos_x_contratado":-519,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-09-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8500,"valorMensalidade":7607.33,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":0.56,"edp_total_kwh":8281,"edp_dif_recebidos_x_contratado":-219,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-10-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8500,"valorMensalidade":7607.33,"percent_desc_energia":15,"valor_kwh":0.89,"percentual_desconto_aplicado":0.56,"edp_total_kwh":7397,"edp_dif_recebidos_x_contratado":-1103,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-11-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8500,"valorMensalidade":8276.88,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":0,"edp_total_kwh":6078,"edp_dif_recebidos_x_contratado":-2422,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-12-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8500,"valorMensalidade":8286.88,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":0,"edp_total_kwh":8097,"edp_dif_recebidos_x_contratado":-403,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-01-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":9056.35,"valorMensalidade":7607.33,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":22.22,"edp_total_kwh":7588,"edp_dif_recebidos_x_contratado":-1468.35,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-02-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8500,"valorMensalidade":8286.88,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":9.73,"edp_total_kwh":8809,"edp_dif_recebidos_x_contratado":309,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-03-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8500,"valorMensalidade":8286.88,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":9.73,"edp_total_kwh":9511,"edp_dif_recebidos_x_contratado":1011,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-04-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8500,"valorMensalidade":8286.88,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":9.73,"edp_total_kwh":7387,"edp_dif_recebidos_x_contratado":-1113,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-05-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8500,"valorMensalidade":8286.88,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":9.73,"edp_total_kwh":6634,"edp_dif_recebidos_x_contratado":-1866,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-06-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8500,"valorMensalidade":8286.88,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":9.73,"edp_total_kwh":7115,"edp_dif_recebidos_x_contratado":-1385,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-07-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8500,"valorMensalidade":8286.88,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":15.95,"edp_total_kwh":7404,"edp_dif_recebidos_x_contratado":-1096,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.1600},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-08-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8500,"valorMensalidade":8276.88,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":16.06,"edp_total_kwh":7883,"edp_dif_recebidos_x_contratado":-617,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":1.1600},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-12-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":4723.19,"valorMensalidade":4863.65,"percent_desc_energia":15,"valor_kwh":1.03,"percentual_desconto_aplicado":0,"edp_total_kwh":4927,"edp_dif_recebidos_x_contratado":203.8100000000004,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-01-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":4723.19,"valorMensalidade":4863.65,"percent_desc_energia":15,"valor_kwh":1.03,"percentual_desconto_aplicado":0,"edp_total_kwh":4643,"edp_dif_recebidos_x_contratado":-80.1899999999996,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-02-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":500,"valorMensalidade":420,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":5.62,"edp_total_kwh":4241,"edp_dif_recebidos_x_contratado":3741,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-03-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":500,"valorMensalidade":420,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":5.62,"edp_total_kwh":5567,"edp_dif_recebidos_x_contratado":5067,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-04-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":500,"valorMensalidade":420,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":5.62,"edp_total_kwh":4929,"edp_dif_recebidos_x_contratado":4429,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-05-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":500,"valorMensalidade":420,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":5.62,"edp_total_kwh":494,"edp_dif_recebidos_x_contratado":-6,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-06-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":500,"valorMensalidade":420,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":5.62,"edp_total_kwh":399,"edp_dif_recebidos_x_contratado":-101,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-07-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":500,"valorMensalidade":420,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":6.67,"edp_total_kwh":419,"edp_dif_recebidos_x_contratado":-81,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-08-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":500,"valorMensalidade":420,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":6.67,"edp_total_kwh":464,"edp_dif_recebidos_x_contratado":-36,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-09-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":500,"valorMensalidade":420,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":6.67,"edp_total_kwh":494,"edp_dif_recebidos_x_contratado":-6,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-10-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":500,"valorMensalidade":420,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":6.67,"edp_total_kwh":430,"edp_dif_recebidos_x_contratado":-70,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-11-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":500,"valorMensalidade":459.38,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":0,"edp_total_kwh":353,"edp_dif_recebidos_x_contratado":-147,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-12-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":500,"valorMensalidade":469.38,"percent_desc_energia":15,"valor_kwh":0.94,"percentual_desconto_aplicado":0,"edp_total_kwh":472,"edp_dif_recebidos_x_contratado":-28,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-01-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":500,"valorMensalidade":420,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":22.22,"edp_total_kwh":439,"edp_dif_recebidos_x_contratado":-61,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-02-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":500,"valorMensalidade":469.38,"percent_desc_energia":15,"valor_kwh":0.94,"percentual_desconto_aplicado":13.08,"edp_total_kwh":510,"edp_dif_recebidos_x_contratado":10,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-03-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":500,"valorMensalidade":469.38,"percent_desc_energia":15,"valor_kwh":0.94,"percentual_desconto_aplicado":13.08,"edp_total_kwh":553,"edp_dif_recebidos_x_contratado":53,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-04-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":500,"valorMensalidade":469.38,"percent_desc_energia":15,"valor_kwh":0.94,"percentual_desconto_aplicado":13.08,"edp_total_kwh":429,"edp_dif_recebidos_x_contratado":-71,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-05-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":500,"valorMensalidade":469.38,"percent_desc_energia":15,"valor_kwh":0.94,"percentual_desconto_aplicado":13.08,"edp_total_kwh":386,"edp_dif_recebidos_x_contratado":-114,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-06-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":500,"valorMensalidade":469.38,"percent_desc_energia":15,"valor_kwh":0.94,"percentual_desconto_aplicado":13.08,"edp_total_kwh":414,"edp_dif_recebidos_x_contratado":-86,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-07-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":500,"valorMensalidade":469.38,"percent_desc_energia":15,"valor_kwh":0.94,"percentual_desconto_aplicado":19.07,"edp_total_kwh":430,"edp_dif_recebidos_x_contratado":-70,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.1600},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-08-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":500,"valorMensalidade":459.38,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":20.8,"edp_total_kwh":458,"edp_dif_recebidos_x_contratado":-42,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":1.1600},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-02-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7300,"valorMensalidade":6720,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":0,"edp_total_kwh":10596,"edp_dif_recebidos_x_contratado":3296,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-03-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7300,"valorMensalidade":6720,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":0,"edp_total_kwh":13910,"edp_dif_recebidos_x_contratado":6610,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-04-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":8000,"valorMensalidade":6720,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":5.62,"edp_total_kwh":12315,"edp_dif_recebidos_x_contratado":4315,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-05-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7300,"valorMensalidade":6720,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":0,"edp_total_kwh":7277,"edp_dif_recebidos_x_contratado":-23,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_1_2024","mes_ano":"2024-06-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7300,"valorMensalidade":6720,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":0,"edp_total_kwh":5895,"edp_dif_recebidos_x_contratado":-1405,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-07-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7300,"valorMensalidade":6720,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":0,"edp_total_kwh":6197,"edp_dif_recebidos_x_contratado":-1103,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-08-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7300,"valorMensalidade":6720,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":0,"edp_total_kwh":6858,"edp_dif_recebidos_x_contratado":-442,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-09-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7300,"valorMensalidade":6720,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":0,"edp_total_kwh":7122,"edp_dif_recebidos_x_contratado":-178,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-10-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7300,"valorMensalidade":6720,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":0,"edp_total_kwh":6356,"edp_dif_recebidos_x_contratado":-944,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-11-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7300,"valorMensalidade":7295.02,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":0,"edp_total_kwh":5222,"edp_dif_recebidos_x_contratado":-2078,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2024,"semestre":"Semestre_2_2024","mes_ano":"2024-12-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7300,"valorMensalidade":7305.02,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":0,"edp_total_kwh":6959,"edp_dif_recebidos_x_contratado":-341,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":0.9000},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-01-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":8000,"valorMensalidade":6720,"percent_desc_energia":15,"valor_kwh":0.84,"percentual_desconto_aplicado":22.22,"edp_total_kwh":6516,"edp_dif_recebidos_x_contratado":-1484,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-02-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7300,"valorMensalidade":7305.02,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":7.34,"edp_total_kwh":7565,"edp_dif_recebidos_x_contratado":265,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-03-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7300,"valorMensalidade":7305.02,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":7.34,"edp_total_kwh":8169,"edp_dif_recebidos_x_contratado":869,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-04-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7300,"valorMensalidade":7305.02,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":7.34,"edp_total_kwh":6344,"edp_dif_recebidos_x_contratado":-956,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-05-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7300,"valorMensalidade":7305.02,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":7.34,"edp_total_kwh":5697,"edp_dif_recebidos_x_contratado":-1603,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_1_2025","mes_ano":"2025-06-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7300,"valorMensalidade":7305.02,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":7.34,"edp_total_kwh":6111,"edp_dif_recebidos_x_contratado":-1189,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.0800},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-07-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7300,"valorMensalidade":7305.02,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":13.73,"edp_total_kwh":6360,"edp_dif_recebidos_x_contratado":-940,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.1600},{"parceiro":"UAINE GROUP","ano":2025,"semestre":"Semestre_2_2025","mes_ano":"2025-08-01","instalacao":"1485359","cpf_cnpj_beneficiario":"52805088000112","nome_beneficiario":"BALTHAZAR RESTAURANTE E COMERCIO DE BEBIDAS LTDA","kWhDisponibilizadosMes":7300,"valorMensalidade":7295.02,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":13.85,"edp_total_kwh":6770,"edp_dif_recebidos_x_contratado":-530,"id_tbl_plano_assinatura_benef":579,"valor_kwh_edp":1.1600},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-11-01","instalacao":"596654","cpf_cnpj_beneficiario":"36224796000103","nome_beneficiario":"UGO RESTAURANTE LTDA","kWhDisponibilizadosMes":500,"valorMensalidade":459.38,"percent_desc_energia":15,"valor_kwh":0.92,"percentual_desconto_aplicado":0,"edp_total_kwh":5446,"edp_dif_recebidos_x_contratado":4946,"id_tbl_plano_assinatura_benef":478,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-11-01","instalacao":"1990889","cpf_cnpj_beneficiario":"39741461000150","nome_beneficiario":"DELTA HOLDING DE PARTICIPACOES E SERVICOS LTDA","kWhDisponibilizadosMes":1090,"valorMensalidade":1101.9,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":0,"edp_total_kwh":1400,"edp_dif_recebidos_x_contratado":310,"id_tbl_plano_assinatura_benef":468,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-11-01","instalacao":"1921756","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":3780,"valorMensalidade":3809.72,"percent_desc_energia":15,"valor_kwh":1.01,"percentual_desconto_aplicado":0,"edp_total_kwh":4824,"edp_dif_recebidos_x_contratado":1044,"id_tbl_plano_assinatura_benef":472,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-11-01","instalacao":"1921762","cpf_cnpj_beneficiario":"02016402792","nome_beneficiario":"GEDALIAS ROSA","kWhDisponibilizadosMes":2076,"valorMensalidade":2076.03,"percent_desc_energia":15,"valor_kwh":1.00,"percentual_desconto_aplicado":0,"edp_total_kwh":2628,"edp_dif_recebidos_x_contratado":552,"id_tbl_plano_assinatura_benef":473,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-11-01","instalacao":"1506204","cpf_cnpj_beneficiario":"16642060000148","nome_beneficiario":"RESTAURANTE CANTO DA PRAIA LTDA ME","kWhDisponibilizadosMes":8500,"valorMensalidade":8276.88,"percent_desc_energia":15,"valor_kwh":0.97,"percentual_desconto_aplicado":0,"edp_total_kwh":10445,"edp_dif_recebidos_x_contratado":1945,"id_tbl_plano_assinatura_benef":476,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-11-01","instalacao":"506279","cpf_cnpj_beneficiario":"39275789000129","nome_beneficiario":"PIZZARIA DÂ´AMPEZZO LTDA","kWhDisponibilizadosMes":2050,"valorMensalidade":2133.72,"percent_desc_energia":15,"valor_kwh":1.04,"percentual_desconto_aplicado":0,"edp_total_kwh":2714,"edp_dif_recebidos_x_contratado":664,"id_tbl_plano_assinatura_benef":471,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-11-01","instalacao":"634374","cpf_cnpj_beneficiario":"07688213000105","nome_beneficiario":"SCM-COMERCIO DE PRESENTES LTDA","kWhDisponibilizadosMes":1355,"valorMensalidade":1396.21,"percent_desc_energia":15,"valor_kwh":1.03,"percentual_desconto_aplicado":0,"edp_total_kwh":1763,"edp_dif_recebidos_x_contratado":408,"id_tbl_plano_assinatura_benef":475,"valor_kwh_edp":0.8900},{"parceiro":"UAINE GROUP","ano":2023,"semestre":"Semestre_2_2023","mes_ano":"2023-11-01","instalacao":"506281","cpf_cnpj_beneficiario":"27320134000146","nome_beneficiario":"BAR E RESTAURANTE PIRAO LTDA ME","kWhDisponibilizadosMes":6495,"valorMensalidade":6574,"percent_desc_energia":10,"valor_kwh":1.01,"percentual_desconto_aplicado":0,"edp_total_kwh":8317,"edp_dif_recebidos_x_contratado":1822,"id_tbl_plano_assinatura_benef":467,"valor_kwh_edp":0.8900}]
    }

    // Carrega os dados (atualmente embutidos, mas pode ser facilmente substituído por fetch)
    let rawData = loadDashboardData();

    // Função de inicialização do dashboard
    function initDashboard() {

    const filtersForm = document.getElementById('filters');
    const diffCard = document.getElementById('diffCard');
    const diffValue = document.getElementById('diffValue');
    const diffLegend = document.getElementById('diffLegend');
    const tableBody = document.getElementById('tableBody');
    const emptyState = document.getElementById('emptyState');
    const insightsGrid = document.getElementById('insightsGrid');
    const yearSummaryCard = document.getElementById('yearSummaryCard');
    const yearContratado = document.getElementById('yearContratado');
    const yearRecebido = document.getElementById('yearRecebido');
    const yearDiferenca = document.getElementById('yearDiferenca');
    const yearDiferencaDetail = document.getElementById('yearDiferencaDetail');
    const yearPercentual = document.getElementById('yearPercentual');
    const summaryCardsContainer = document.getElementById('summaryCardsContainer');
    const valorMedioKwh = document.getElementById('valorMedioKwh');
    const valorMedioKwhEdpCard = document.getElementById('valorMedioKwhEdpCard');
    const comparacaoEdp = document.getElementById('comparacaoEdp');
    const somaMensalidadeAno = document.getElementById('somaMensalidadeAno');
    const somaKwhAno = document.getElementById('somaKwhAno');
    const mediaKwhEdpAno = document.getElementById('mediaKwhEdpAno');
    const somaKwhRecebidoAno = document.getElementById('somaKwhRecebidoAno');

    const selectElements = {
      parceiro: document.getElementById('parceiroFilter'),
      ano: { container: document.getElementById('anoFilterContainer'), list: document.getElementById('anoFilterList'), all: document.getElementById('anoFilterAll') },
      semestre: { container: document.getElementById('semestreFilterContainer'), list: document.getElementById('semestreFilterList'), all: document.getElementById('semestreFilterAll') },
      mes: { container: document.getElementById('mesFilterContainer'), list: document.getElementById('mesFilterList'), all: document.getElementById('mesFilterAll') },
      instalacao: { container: document.getElementById('instalacaoFilterContainer'), list: document.getElementById('instalacaoFilterList'), all: document.getElementById('instalacaoFilterAll') },
      beneficiario: document.getElementById('benefFilter')
    };

    // Sets para armazenar valores selecionados
    const selectedFilters = {
      ano: new Set(),
      semestre: new Set(),
      mes: new Set(),
      instalacao: new Set()
    };

    const monthFormatter = new Intl.DateTimeFormat('pt-BR', { month: 'short', year: 'numeric' });
    const currencyFormatter = new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL', maximumFractionDigits: 0 });
    const numberFormatter = new Intl.NumberFormat('pt-BR', { maximumFractionDigits: 0 });
    const currencyPerKwhFormatter = new Intl.NumberFormat('pt-BR', {
      style: 'currency',
      currency: 'BRL',
      minimumFractionDigits: 2,
      maximumFractionDigits: 2
    });

    let beneficiariosList = [];
    let selectedBeneficiarios = new Set();
    let benefProfiles = [];

    function populateFilters(data) {
      const sets = {
        parceiro: new Set(),
        ano: new Set(),
        semestre: new Set(),
        mes: new Set(),
        instalacao: new Set(),
        beneficiario: new Set()
      };

      data.forEach(item => {
        if (item.parceiro) sets.parceiro.add(item.parceiro);
        sets.ano.add(item.ano);
        sets.semestre.add(item.semestre);
        sets.mes.add(item.mes_ano);
        sets.instalacao.add(item.instalacao);
        sets.beneficiario.add(item.nome_beneficiario);
      });

      const sortedMes = Array.from(sets.mes).sort();
      const parceiros = Array.from(sets.parceiro).sort();

      populateSelect(selectElements.parceiro, parceiros);
      
      // Se houver apenas 1 parceiro, seleciona automaticamente
      if (parceiros.length === 1) {
        selectElements.parceiro.value = parceiros[0];
        // Dispara o evento change para atualizar o dashboard
        setTimeout(() => {
          selectElements.parceiro.dispatchEvent(new Event('change', { bubbles: true }));
        }, 0);
      }

      populateCheckboxFilter('ano', sets.ano);
      populateCheckboxFilter('semestre', sets.semestre);
      populateCheckboxFilter('mes', sets.mes, formatMesLabel);
      populateCheckboxFilter('instalacao', sets.instalacao);

      const selectedYears = getSelectedYears();
      benefProfiles = buildBeneficiaryProfiles(data, selectedYears);
      populateBenefCheckboxes(benefProfiles);
      
      const instalacoesIndicator = document.getElementById('instalacoesIndicator');
      if (instalacoesIndicator) {
        instalacoesIndicator.textContent = `Instalações monitoradas: ${sets.instalacao.size}`;
      }
    }

    function populateSelect(select, values, formatFn, defaultLabel = 'Todos') {
      const defaultOption = document.createElement('option');
      defaultOption.value = '';
      defaultOption.textContent = defaultLabel;
      select.innerHTML = '';
      select.appendChild(defaultOption);
      values.forEach(value => {
        const option = document.createElement('option');
        option.value = value;
        option.textContent = formatFn ? formatFn(value) : value;
        select.appendChild(option);
      });
    }

    function populateCheckboxFilter(filterKey, values, formatFn) {
      const filter = selectElements[filterKey];
      if (!filter || !filter.list) return;
      
      filter.list.innerHTML = '';
      const allValues = Array.from(values).sort();
      
      // Handler para "Selecionar todos"
      filter.all.addEventListener('change', function() {
        const checkboxes = filter.list.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach(cb => {
          cb.checked = this.checked;
          if (this.checked) {
            selectedFilters[filterKey].add(cb.value);
          } else {
            selectedFilters[filterKey].delete(cb.value);
          }
        });
        refreshDashboard();
      });
      
      // Cria checkboxes para cada valor
      allValues.forEach(value => {
        const item = document.createElement('div');
        item.className = 'checkbox-filter-item';
        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.value = String(value);
        checkbox.id = `${filterKey}_${value}`;
        checkbox.dataset.filter = filterKey;
        
        checkbox.addEventListener('change', function() {
          const val = String(value);
          if (this.checked) {
            selectedFilters[filterKey].add(val);
          } else {
            selectedFilters[filterKey].delete(val);
            filter.all.checked = false;
          }
          // Atualiza o estado de "Selecionar todos"
          const allChecked = filter.list.querySelectorAll('input[type="checkbox"]:checked').length === allValues.length;
          filter.all.checked = allChecked;
          refreshDashboard();
        });
        
        const label = document.createElement('label');
        label.htmlFor = checkbox.id;
        label.textContent = formatFn ? formatFn(value) : value;
        
        item.appendChild(checkbox);
        item.appendChild(label);
        filter.list.appendChild(item);
      });
    }

    function getSelectedYears() {
      // Se nenhum ano foi selecionado, retorna todos os anos disponíveis nos dados
      if (selectedFilters.ano.size === 0) {
        const allYears = new Set();
        rawData.forEach(item => allYears.add(String(item.ano)));
        return Array.from(allYears).map(y => parseInt(y)).sort();
      }
      // Retorna os anos selecionados
      return Array.from(selectedFilters.ano).map(y => parseInt(y)).sort();
    }

    function formatYearIndicator(years) {
      if (years.length === 0) return new Date().getFullYear();
      if (years.length === 1) return years[0];
      // Se múltiplos anos, mostra todos separados por vírgula
      return years.join(', ');
    }

    function getMonthlyDataForYear(registros, year) {
      const registrosAno = registros.filter(item => {
        const itemYear = new Date(`${item.mes_ano}T00:00:00`).getFullYear();
        return itemYear === year;
      }).sort((a, b) => {
        const dateA = new Date(`${a.mes_ano}T00:00:00`);
        const dateB = new Date(`${b.mes_ano}T00:00:00`);
        return dateA - dateB;
      });
      
      return {
        meses: registrosAno.map(item => {
          const date = new Date(`${item.mes_ano}T00:00:00`);
          const mesesAbrev = ['jan', 'fev', 'mar', 'abr', 'mai', 'jun', 'jul', 'ago', 'set', 'out', 'nov', 'dez'];
          return mesesAbrev[date.getMonth()];
        }),
        contratado: registrosAno.map(item => item.kWhDisponibilizadosMes || 0),
        recebido: registrosAno.map(item => item.edp_total_kwh || 0),
        valorPago: registrosAno.map(item => item.valorMensalidade || 0)
      };
    }

    function buildBeneficiaryProfiles(data, selectedYears) {
      const map = new Map();
      const anoAtual = new Date().getFullYear();
      
      // Agrupa por beneficiário e encontra o último mês de cada um
      data.forEach(item => {
        if (!map.has(item.nome_beneficiario)) {
          map.set(item.nome_beneficiario, {
            nome: item.nome_beneficiario,
            instalacoes: new Set(),
            registros: []
          });
        }
        const profile = map.get(item.nome_beneficiario);
        profile.instalacoes.add(item.instalacao);
        profile.registros.push(item);
      });
      
      return Array.from(map.values()).map(profile => {
        // Ordena registros por data (mais recente primeiro)
        const registrosOrdenados = profile.registros.sort((a, b) => {
          const dateA = new Date(`${a.mes_ano}T00:00:00`);
          const dateB = new Date(`${b.mes_ano}T00:00:00`);
          return dateB - dateA;
        });
        
        // Pega o registro do último mês
        const ultimoRegistro = registrosOrdenados[0];
        
        // Calcula valores do ano atual (2025)
        const registrosAnoAtual = profile.registros.filter(item => {
          const itemYear = new Date(`${item.mes_ano}T00:00:00`).getFullYear();
          return itemYear === anoAtual;
        });
        
        const somaMensalidadeAno = registrosAnoAtual.reduce((sum, item) => sum + (item.valorMensalidade || 0), 0);
        const somaKwhContratadoAno = registrosAnoAtual.reduce((sum, item) => sum + (item.kWhDisponibilizadosMes || 0), 0);
        const valorMedioKwhAno = somaKwhContratadoAno > 0 ? somaMensalidadeAno / somaKwhContratadoAno : 0;
        const somaValorKwhEdpAno = registrosAnoAtual.reduce((sum, item) => sum + (item.valor_kwh_edp || 0), 0);
        const mediaKwhEdpAno = registrosAnoAtual.length > 0 ? somaValorKwhEdpAno / registrosAnoAtual.length : 0;
        const somaKwhRecebidoAno = registrosAnoAtual.reduce((sum, item) => sum + (item.edp_total_kwh || 0), 0);
        const diferencaKwhAno = somaKwhRecebidoAno - somaKwhContratadoAno;
        const percentualDiferencaAno = somaKwhContratadoAno > 0 ? ((diferencaKwhAno / somaKwhContratadoAno) * 100) : 0;
        // Média do percentual_desconto_aplicado para o ano atual
        const somaPercentualAplicadoAno = registrosAnoAtual.reduce((sum, item) => sum + (item.percentual_desconto_aplicado || 0), 0);
        const mediaPercentualAplicadoAno = registrosAnoAtual.length > 0 ? somaPercentualAplicadoAno / registrosAnoAtual.length : 0;
        
        // Calcula valores por ano para os outros anos selecionados
        const anosComDados = {};
        selectedYears.forEach(year => {
          if (year !== anoAtual) {
            const registrosAno = profile.registros.filter(item => {
              const itemYear = new Date(`${item.mes_ano}T00:00:00`).getFullYear();
              return itemYear === year;
            });
            
            if (registrosAno.length > 0) {
              const somaMensalidade = registrosAno.reduce((sum, item) => sum + (item.valorMensalidade || 0), 0);
              const somaKwhContratado = registrosAno.reduce((sum, item) => sum + (item.kWhDisponibilizadosMes || 0), 0);
              const valorMedioKwh = somaKwhContratado > 0 ? somaMensalidade / somaKwhContratado : 0;
              const somaValorKwhEdp = registrosAno.reduce((sum, item) => sum + (item.valor_kwh_edp || 0), 0);
              const mediaKwhEdp = registrosAno.length > 0 ? somaValorKwhEdp / registrosAno.length : 0;
              const somaKwhRecebido = registrosAno.reduce((sum, item) => sum + (item.edp_total_kwh || 0), 0);
              const diferencaKwh = somaKwhRecebido - somaKwhContratado;
              const percentualDiferenca = somaKwhContratado > 0 ? ((diferencaKwh / somaKwhContratado) * 100) : 0;
              // Média do percentual_desconto_aplicado para o ano
              const somaPercentualAplicado = registrosAno.reduce((sum, item) => sum + (item.percentual_desconto_aplicado || 0), 0);
              const mediaPercentualAplicado = registrosAno.length > 0 ? somaPercentualAplicado / registrosAno.length : 0;
              
              anosComDados[year] = {
                somaMensalidade,
                somaKwhContratado,
                valorMedioKwh,
                mediaKwhEdp,
                somaKwhRecebido,
                diferencaKwh,
                percentualDiferenca,
                mediaPercentualAplicado
              };
            }
          }
        });
        
        return {
          nome: profile.nome,
          instalacoes: Array.from(profile.instalacoes).sort(),
          mensalidadeDistinct: ultimoRegistro?.valorMensalidade || 0,
          contratadoDistinct: ultimoRegistro?.kWhDisponibilizadosMes || 0,
          valorUnitario: ultimoRegistro?.valor_kwh || 0,
          valorKwhEdp: ultimoRegistro?.valor_kwh_edp || 0,
          percentDescEnergia: ultimoRegistro?.percent_desc_energia || 0,
          percentualDescontoAplicado: ultimoRegistro?.percentual_desconto_aplicado || 0,
          // Valores do ano atual (2025)
          somaMensalidadeAno,
          somaKwhContratadoAno,
          valorMedioKwhAno,
          mediaKwhEdpAno,
          somaKwhRecebidoAno,
          diferencaKwhAno,
          percentualDiferencaAno,
          mediaPercentualAplicadoAno,
          // Dados por ano para outros anos selecionados
          anosComDados: anosComDados,
          selectedYears: selectedYears,
          // Mantém os registros para gerar gráficos
          registros: profile.registros
        };
      }).sort((a, b) => profileSort(a.nome, b.nome));
    }

    function profileSort(a, b) {
      return a.localeCompare(b, 'pt-BR', { sensitivity: 'base' });
    }

    function formatInstalacoes(instalacoes) {
      if (!instalacoes.length) return 'Sem instalação registrada';
      if (instalacoes.length === 1) return `Instalação ${instalacoes[0]}`;
      const preview = instalacoes.slice(0, 2).join(', ');
      const remaining = instalacoes.length - 2;
      return `Instalações ${preview}${remaining > 0 ? ` +${remaining}` : ''}`;
    }

    function populateBenefCheckboxes(profiles) {
      beneficiariosList = profiles.map(profile => profile.nome);
      selectedBeneficiarios = new Set();
      const benefFilterContainer = selectElements.beneficiario;
      benefFilterContainer.innerHTML = '';

      const allLabel = document.createElement('label');
      allLabel.className = 'checkbox-item checkbox-all';
      const allInput = document.createElement('input');
      allInput.type = 'checkbox';
      allInput.id = 'benef-all';
      allInput.checked = false;
      allInput.addEventListener('change', () => {
        const checked = allInput.checked;
        toggleBenefCheckboxes(checked);
        selectedBeneficiarios = checked ? new Set(beneficiariosList) : new Set();
        refreshDashboard();
      });
      const allMeta = document.createElement('div');
      allMeta.className = 'checkbox-meta';
      allMeta.innerHTML = `
        <div class="benef-primary">
          <strong>Todos os beneficiários</strong>
          <span>Visão geral</span>
        </div>
        <div class="benef-metrics">
          <span>Selecione para limpar filtros individuais</span>
        </div>
      `;
      allLabel.appendChild(allInput);
      allLabel.appendChild(allMeta);
      benefFilterContainer.appendChild(allLabel);

      profiles.forEach(profile => {
        const label = document.createElement('label');
        label.className = 'checkbox-item';
        const input = document.createElement('input');
        input.type = 'checkbox';
        input.value = profile.nome;
        input.dataset.role = 'benef-option';
        input.checked = false;
        input.addEventListener('change', () => {
          if (input.checked) {
            selectedBeneficiarios.add(profile.nome);
          } else {
            selectedBeneficiarios.delete(profile.nome);
          }
          const allCheckbox = document.getElementById('benef-all');
          if (allCheckbox) {
            allCheckbox.checked = selectedBeneficiarios.size === beneficiariosList.length;
          }
          refreshDashboard();
        });
        const meta = document.createElement('div');
        meta.className = 'checkbox-meta';
        meta.innerHTML = `
          <div class="benef-primary">
            <strong>${profile.nome}</strong>
            <span>${formatInstalacoes(profile.instalacoes)}</span>
          </div>
          <div class="benef-metrics">
            ${(() => {
              const anoAtual = new Date().getFullYear();
              const todosAnos = [anoAtual, ...Object.keys(profile.anosComDados || {}).map(y => parseInt(y)).sort((a, b) => b - a)];
              return todosAnos.map(year => {
                let dadosAno;
                if (year === anoAtual) {
                  dadosAno = {
                    somaMensalidade: profile.somaMensalidadeAno,
                    somaKwhContratado: profile.somaKwhContratadoAno,
                    valorMedioKwh: profile.valorMedioKwhAno,
                    mediaKwhEdp: profile.mediaKwhEdpAno,
                    somaKwhRecebido: profile.somaKwhRecebidoAno,
                    diferencaKwh: profile.diferencaKwhAno,
                    percentualDiferenca: profile.percentualDiferencaAno,
                    mediaPercentualAplicado: profile.mediaPercentualAplicadoAno || 0
                  };
                } else {
                  dadosAno = profile.anosComDados[year];
                }
                
                if (!dadosAno) return '';
                
                return `
            <div class="benef-meta-row">
              <div class="benef-meta-content">
                ${year === anoAtual ? `
                <div class="benef-atualmente-container">
                  <div class="benef-atualmente-title">Atualmente</div>
                  <div class="benef-atualmente-boxes">
                    <div class="benef-box">
                      <div class="benef-box-title">Plano de assinatura</div>
                      <div class="benef-box-item">
                        <span>Mensalidade:</span>
                        <strong>${currencyFormatter.format(profile.mensalidadeDistinct)}</strong>
                      </div>
                      <div class="benef-box-item">
                        <span>kWh:</span>
                        <strong>${numberFormatter.format(profile.contratadoDistinct)}</strong>
                      </div>
                      <div class="benef-box-item">
                        <span>Valor kWh:</span>
                        <strong>${currencyPerKwhFormatter.format(profile.valorUnitario)}</strong>
                      </div>
                      <div class="benef-box-item">
                        <span>% Desc. Energia:</span>
                        <strong>${profile.percentDescEnergia}%</strong>
                      </div>
                    </div>
                    <div class="benef-box">
                      <div class="benef-box-title">EDP</div>
                      <div class="benef-box-item">
                        <span>Valor kWh:</span>
                        <strong>${currencyPerKwhFormatter.format(profile.valorKwhEdp)}</strong>
                      </div>
                    </div>
                    <div class="benef-box">
                      <div class="benef-box-title">% Aplicado Médio</div>
                      <div class="benef-box-single">${profile.percentualDescontoAplicado.toFixed(2)}%</div>
                    </div>
                  </div>
                </div>
                ` : ''}
                <div class="benef-year-data-container">
                  <div class="benef-year-data-left">
                    <div class="benef-box">
                      <div class="benef-box-title">Valor Médio Total ${year}</div>
                      <div class="benef-box-item">
                        <span>Soma Mensalidade:</span>
                        <strong>${currencyFormatter.format(dadosAno.somaMensalidade || 0)}</strong>
                      </div>
                      <div class="benef-box-item">
                        <span>Soma kWh:</span>
                        <strong>${numberFormatter.format(dadosAno.somaKwhContratado || 0)}</strong>
                      </div>
                      <div class="benef-box-item">
                        <span>Valor Médio kWh:</span>
                        <strong>${currencyPerKwhFormatter.format(dadosAno.valorMedioKwh || 0)}</strong>
                      </div>
                      <div class="benef-box-item">
                        <span>Média kWh EDP:</span>
                        <strong>${currencyPerKwhFormatter.format(dadosAno.mediaKwhEdp || 0)}</strong>
                      </div>
                      <div class="benef-box-item">
                        <span>Soma kWh Recebido:</span>
                        <strong>${numberFormatter.format(dadosAno.somaKwhRecebido || 0)}</strong>
                      </div>
                      <div class="benef-box-item">
                        <span>Diferença:</span>
                        <strong style="color: ${(dadosAno.diferencaKwh || 0) >= 0 ? 'var(--positive)' : 'var(--negative)'}">
                          ${(dadosAno.diferencaKwh || 0) >= 0 ? '+' : ''}${numberFormatter.format(dadosAno.diferencaKwh || 0)}
                        </strong>
                      </div>
                      <div class="benef-box-item">
                        <span>% Diferença:</span>
                        <strong style="color: ${(dadosAno.percentualDiferenca || 0) >= 0 ? 'var(--positive)' : 'var(--negative)'}">
                          ${(dadosAno.percentualDiferenca || 0) >= 0 ? '+' : ''}${(dadosAno.percentualDiferenca || 0).toFixed(2)}%
                        </strong>
                      </div>
                    </div>
                    <div class="benef-atualmente-container">
                      <div class="benef-atualmente-boxes">
                        <div class="benef-box">
                          <div class="benef-box-title">EDP</div>
                          <div class="benef-box-item">
                            <span>Valor kWh:</span>
                            <strong>${currencyPerKwhFormatter.format(dadosAno.mediaKwhEdp || 0)}</strong>
                          </div>
                        </div>
                        <div class="benef-box">
                          <div class="benef-box-title">% Aplicado Médio</div>
                          <div class="benef-box-single">${(dadosAno.mediaPercentualAplicado || 0).toFixed(2)}%</div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="benef-year-data-right">
                    <div class="benef-box">
                      <div class="benef-box-title">Gráfico Mensal ${year}</div>
                      <canvas id="chart-${profile.nome.replace(/\s+/g, '-')}-${year}" style="width: 100%; max-height: 350px; height: 350px;"></canvas>
                    </div>
                  </div>
                </div>
              </div>
              <div class="benef-year-indicator">${year}</div>
            </div>
                `;
              }).join('');
            })()}
          </div>
        `;
        label.appendChild(input);
        label.appendChild(meta);
        benefFilterContainer.appendChild(label);
      });
      
      // Cria gráficos para todos os anos (incluindo o atual)
      setTimeout(() => {
        profiles.forEach(profile => {
          const anoAtual = new Date().getFullYear();
          // Inclui o ano atual e todos os anos com dados
          const todosAnos = [anoAtual, ...Object.keys(profile.anosComDados || {}).map(y => parseInt(y))];
          const anosUnicos = [...new Set(todosAnos)];
          
          anosUnicos.forEach(yearNum => {
            const chartId = `chart-${profile.nome.replace(/\s+/g, '-')}-${yearNum}`;
            const canvas = document.getElementById(chartId);
            if (canvas) {
              const monthlyData = getMonthlyDataForYear(profile.registros, yearNum);
              if (monthlyData.meses.length > 0) {
                new Chart(canvas, {
                  type: 'line',
                  data: {
                    labels: monthlyData.meses,
                    datasets: [
                      {
                        label: 'Contratado (kWh)',
                        data: monthlyData.contratado,
                        borderColor: 'rgb(75, 192, 192)',
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                        tension: 0.1
                      },
                      {
                        label: 'Recebido (kWh)',
                        data: monthlyData.recebido,
                        borderColor: 'rgb(255, 99, 132)',
                        backgroundColor: 'rgba(255, 99, 132, 0.2)',
                        tension: 0.1
                      },
                      {
                        label: 'Valor Pago (R$)',
                        data: monthlyData.valorPago,
                        borderColor: 'rgb(54, 162, 235)',
                        backgroundColor: 'rgba(54, 162, 235, 0.2)',
                        tension: 0.1,
                        yAxisID: 'y1',
                        borderWidth: 2
                      }
                    ]
                  },
                  options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                      legend: {
                        display: true,
                        position: 'bottom'
                      }
                    },
                    scales: {
                      y: {
                        type: 'linear',
                        display: true,
                        position: 'left',
                        title: {
                          display: true,
                          text: 'kWh',
                          font: {
                            size: 12
                          }
                        },
                        ticks: {
                          callback: function(value) {
                            return numberFormatter.format(value);
                          }
                        }
                      },
                      y1: {
                        type: 'linear',
                        display: true,
                        position: 'right',
                        title: {
                          display: true,
                          text: 'R$',
                          font: {
                            size: 12
                          }
                        },
                        ticks: {
                          callback: function(value) {
                            return currencyFormatter.format(value);
                          }
                        },
                        grid: {
                          drawOnChartArea: false
                        }
                      }
                    }
                  }
                });
              }
            }
          });
        });
      }, 100);
    }

    function toggleBenefCheckboxes(state) {
      selectElements.beneficiario
        .querySelectorAll('input[data-role="benef-option"]')
        .forEach(cb => {
          cb.checked = state;
        });
    }

    function resetBenefCheckboxes() {
      if (!beneficiariosList.length) return;
      const allCheckbox = document.getElementById('benef-all');
      if (allCheckbox) allCheckbox.checked = false;
      toggleBenefCheckboxes(false);
      selectedBeneficiarios = new Set();
    }

    function formatMesLabel(value) {
      const date = new Date(`${value}T00:00:00`);
      const month = String(date.getMonth() + 1).padStart(2, '0');
      const year = date.getFullYear();
      return `${month}/${year}`;
    }

    function getFilters() {
      return {
        parceiro: selectElements.parceiro.value,
        ano: selectedFilters.ano,
        semestre: selectedFilters.semestre,
        mes: selectedFilters.mes,
        instalacao: selectedFilters.instalacao,
        beneficiarios: new Set(selectedBeneficiarios)
      };
    }

    function applyFilters(data, filters) {
      return data.filter(item => {
        if (filters.parceiro && item.parceiro !== filters.parceiro) return false;
        if (filters.ano.size && !filters.ano.has(String(item.ano))) return false;
        if (filters.semestre.size && !filters.semestre.has(item.semestre)) return false;
        if (filters.mes.size && !filters.mes.has(item.mes_ano)) return false;
        if (filters.instalacao.size && !filters.instalacao.has(String(item.instalacao))) return false;
        if (filters.beneficiarios.size && !filters.beneficiarios.has(item.nome_beneficiario)) return false;
        return true;
      });
    }

    function summarize(data) {
      const months = data.length;
      const totalContratado = data.reduce((sum, item) => sum + item.kWhDisponibilizadosMes, 0);
      const totalRecebido = data.reduce((sum, item) => sum + item.edp_total_kwh, 0);
      const totalDiferenca = data.reduce((sum, item) => sum + item.edp_dif_recebidos_x_contratado, 0);
      const totalMensalidade = data.reduce((sum, item) => sum + item.valorMensalidade, 0);
      const mediaContratada = months ? totalContratado / months : 0;
      const mediaRecebida = months ? totalRecebido / months : 0;

      return {
        months,
        totalContratado,
        totalRecebido,
        totalDiferenca,
        totalMensalidade,
        mediaContratada,
        mediaRecebida,
        aderencia: mediaContratada ? (mediaRecebida / mediaContratada) * 100 : 0
      };
    }

    function updateDiffCard(summary) {
      diffValue.textContent = `${summary.totalDiferenca >= 0 ? '+' : ''}${numberFormatter.format(summary.totalDiferenca)} kWh`;
      diffCard.dataset.state = summary.totalDiferenca >= 0 ? 'positive' : 'negative';
      diffLegend.textContent = summary.totalDiferenca >= 0
        ? 'Recebimento acima do contratado nos filtros selecionados.'
        : 'Recebimento abaixo do contratado nos filtros selecionados.';
    }

    function updateYearSummary(data) {
      if (!data || data.length === 0) {
        if (yearSummaryCard) yearSummaryCard.hidden = true;
        return;
      }

      // Usa todos os dados filtrados (não apenas ano atual)
      // Soma kWh contratados (kWhDisponibilizadosMes)
      const somaContratado = data.reduce((sum, item) => sum + (item.kWhDisponibilizadosMes || 0), 0);
      
      // Soma kWh recebidos (edp_total_kwh)
      const somaRecebido = data.reduce((sum, item) => sum + (item.edp_total_kwh || 0), 0);
      
      // Diferença
      const diferenca = somaRecebido - somaContratado;
      
      // Percentual da diferença
      const percentualDiferenca = somaContratado > 0 ? ((diferenca / somaContratado) * 100) : 0;
      
      // Média do valor_kwh_edp do período filtrado
      const somaValorKwhEdp = data.reduce((sum, item) => sum + (item.valor_kwh_edp || 0), 0);
      const mediaValorKwhEdp = data.length > 0 ? somaValorKwhEdp / data.length : 0;

      // Atualiza os elementos
      if (yearContratado) {
        yearContratado.textContent = numberFormatter.format(somaContratado);
      }
      if (yearRecebido) {
        yearRecebido.textContent = numberFormatter.format(somaRecebido);
      }
      if (yearDiferenca) {
        yearDiferenca.textContent = `${diferenca >= 0 ? '+' : ''}${numberFormatter.format(diferenca)}`;
        yearDiferenca.className = `year-summary-item-value ${diferenca >= 0 ? 'positive' : 'negative'}`;
      }
      if (yearDiferencaDetail) {
        yearDiferencaDetail.textContent = diferenca >= 0 
          ? 'Recebido acima do contratado' 
          : 'Recebido abaixo do contratado';
      }
      if (yearPercentual) {
        yearPercentual.textContent = `${percentualDiferenca >= 0 ? '+' : ''}${percentualDiferenca.toFixed(2)}%`;
        yearPercentual.className = `year-summary-item-value ${percentualDiferenca >= 0 ? 'positive' : 'negative'}`;
      }
      if (yearSummaryCard) {
        yearSummaryCard.hidden = false;
      }
    }

    function updateSummaryCards(data) {
      if (!data || data.length === 0) {
        if (summaryCardsContainer) summaryCardsContainer.hidden = true;
        return;
      }

      // Calcula valores totais do período filtrado
      const somaMensalidade = data.reduce((sum, item) => sum + (item.valorMensalidade || 0), 0);
      const somaKwhContratado = data.reduce((sum, item) => sum + (item.kWhDisponibilizadosMes || 0), 0);
      const somaKwhRecebido = data.reduce((sum, item) => sum + (item.edp_total_kwh || 0), 0);
      const diferencaKwh = somaKwhRecebido - somaKwhContratado;
      const percentualDiferenca = somaKwhContratado > 0 ? ((diferencaKwh / somaKwhContratado) * 100) : 0;
      
      // Média do valor_kwh_edp do período
      const somaValorKwhEdp = data.reduce((sum, item) => sum + (item.valor_kwh_edp || 0), 0);
      const mediaKwhEdp = data.length > 0 ? somaValorKwhEdp / data.length : 0;
      
      // Valor Médio kWh = Valor Total Plano / kWh Contratados
      const valorMedioKwhCalculado = somaKwhContratado > 0 ? somaMensalidade / somaKwhContratado : 0;
      
      // % Diferença entre valor médio kWh EDP e valor médio kWh do plano
      // Fórmula: ((EDP - Plano) / Plano) * 100
      // Usa os valores calculados diretamente (sem arredondamento intermediário)
      const comparacaoPercentual = valorMedioKwhCalculado > 0 
        ? ((mediaKwhEdp - valorMedioKwhCalculado) / valorMedioKwhCalculado) * 100 
        : 0;

      // Atualiza os elementos
      if (valorMedioKwh) {
        valorMedioKwh.textContent = currencyPerKwhFormatter.format(valorMedioKwhCalculado);
      }
      if (valorMedioKwhEdpCard) {
        valorMedioKwhEdpCard.textContent = currencyPerKwhFormatter.format(mediaKwhEdp);
      }
      if (comparacaoEdp) {
        // Calcula o percentual usando os valores arredondados para 2 casas decimais (como exibidos)
        const valorMedioKwhArredondado = Math.round(valorMedioKwhCalculado * 100) / 100;
        const mediaKwhEdpArredondada = Math.round(mediaKwhEdp * 100) / 100;
        const comparacaoPercentualCorrigido = valorMedioKwhArredondado > 0 
          ? ((mediaKwhEdpArredondada - valorMedioKwhArredondado) / valorMedioKwhArredondado) * 100 
          : 0;
        comparacaoEdp.textContent = `${comparacaoPercentualCorrigido >= 0 ? '+' : ''}${comparacaoPercentualCorrigido.toFixed(2)}%`;
        // Se > 0: verde (EDP mais caro), se <= 0: vermelho (EDP mais barato ou igual)
        comparacaoEdp.style.color = comparacaoPercentualCorrigido > 0 ? 'var(--positive)' : 'var(--negative)';
      }
      if (somaMensalidadeAno) {
        somaMensalidadeAno.textContent = currencyFormatter.format(somaMensalidade);
      }
      if (somaKwhAno) {
        somaKwhAno.textContent = numberFormatter.format(somaKwhContratado);
      }
      if (mediaKwhEdpAno) {
        mediaKwhEdpAno.textContent = currencyPerKwhFormatter.format(mediaKwhEdp);
      }
      if (somaKwhRecebidoAno) {
        somaKwhRecebidoAno.textContent = numberFormatter.format(somaKwhRecebido);
      }
      if (summaryCardsContainer) {
        summaryCardsContainer.hidden = false;
      }
    }

    function updateInsights(summary) {
      const cards = [
        {
          label: 'Meses analisados',
          value: summary.months,
          detail: summary.months >= 12 ? 'Janela completa de 12 meses' : 'Ainda sem 12 meses completos'
        },
        {
          label: 'Média contratada (kWh)',
          value: numberFormatter.format(summary.mediaContratada),
          detail: 'Meta mensal do plano de assinatura'
        },
        {
          label: 'Média recebida (kWh)',
          value: numberFormatter.format(summary.mediaRecebida),
          detail: summary.mediaRecebida >= summary.mediaContratada ? 'Acima da meta contratada' : 'Abaixo da meta contratada'
        },
        {
          label: 'Índice de entrega',
          value: `${summary.aderencia.toFixed(1)}%`,
          detail: summary.aderencia >= 100 ? 'Plano entregue na totalidade' : 'Ajustar recebimento para 100%'
        },
        {
          label: 'Diferença acumulada',
          value: `${summary.totalDiferenca >= 0 ? '+' : ''}${numberFormatter.format(summary.totalDiferenca)} kWh`,
          detail: summary.totalDiferenca >= 0 ? 'Excedente recebido' : 'Déficit acumulado'
        },
      ];

      insightsGrid.innerHTML = cards.map(card => {
        // Aplica cor para "Diferença acumulada"
        const valueStyle = card.label === 'Diferença acumulada' 
          ? `style="color: ${summary.totalDiferenca > 0 ? 'var(--positive)' : 'var(--negative)'}"`
          : '';
        
        return `
        <div class="insight-card">
          <span>${card.label}</span>
          <strong ${valueStyle}>${card.value}</strong>
          <p>${card.detail}</p>
        </div>
      `;
      }).join('');
    }

    function updateTable(data) {
      tableBody.innerHTML = data.map(item => {
        // Calcula percent_desc_aplicado: diferença de % entre valor_kwh e valor_kwh_edp
        const valorKwh = item.valor_kwh || 0;
        const valorKwhEdp = item.valor_kwh_edp || 0;
        const percentDescAplicado = valorKwh > 0 ? ((valorKwhEdp - valorKwh) / valorKwh) * 100 : 0;
        
        return `
        <tr>
          <td>${formatMesLabel(item.mes_ano)}</td>
          <td>${item.instalacao}</td>
          <td>${item.nome_beneficiario}</td>
          <td>${numberFormatter.format(item.kWhDisponibilizadosMes)} kWh</td>
          <td>${numberFormatter.format(item.edp_total_kwh)} kWh</td>
          <td style="color:${item.edp_dif_recebidos_x_contratado >= 0 ? 'var(--positive)' : 'var(--negative)'}">
            ${item.edp_dif_recebidos_x_contratado >= 0 ? '+' : ''}${numberFormatter.format(item.edp_dif_recebidos_x_contratado)} kWh
          </td>
          <td>${currencyFormatter.format(item.valorMensalidade)}</td>
          <td>${currencyPerKwhFormatter.format(valorKwh)}</td>
          <td>${currencyPerKwhFormatter.format(valorKwhEdp)}</td>
          <td>${(item.percent_desc_energia || 0)}%</td>
          <td style="color:${percentDescAplicado >= 0 ? 'var(--positive)' : 'var(--negative)'}">
            ${percentDescAplicado >= 0 ? '+' : ''}${percentDescAplicado.toFixed(2)}%
          </td>
        </tr>
      `;
      }).join('');

      const hasData = data.length > 0;
      tableBody.parentElement.style.display = hasData ? 'table' : 'none';
      emptyState.hidden = hasData;
    }

    function buildChart(data) {
      const ctx = document.getElementById('energiaChart').getContext('2d');

      // Agrupa dados por ano
      const dadosPorAno = {};
      data.forEach(item => {
        const date = new Date(`${item.mes_ano}T00:00:00`);
        const ano = date.getFullYear();
        const mes = date.getMonth(); // 0-11
        
        if (!dadosPorAno[ano]) {
          dadosPorAno[ano] = {
            contratado: new Array(12).fill(null),
            recebido: new Array(12).fill(null)
          };
        }
        
        dadosPorAno[ano].contratado[mes] = item.kWhDisponibilizadosMes;
        dadosPorAno[ano].recebido[mes] = item.edp_total_kwh;
      });

      // Labels dos meses (jan, fev, etc)
      const mesesLabels = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
      
      // Cria datasets para cada ano
      const datasets = [];
      const anos = Object.keys(dadosPorAno).sort();
      
      // Cores para diferentes anos
      const coresAnos = {
        contratado: [
          'rgba(15, 155, 156, 0.9)',   // 2023
          'rgba(34, 197, 94, 0.9)',    // 2024
          'rgba(59, 130, 246, 0.9)',   // 2025
          'rgba(168, 85, 247, 0.9)',   // outros
        ],
        recebido: [
          'rgba(249, 115, 22, 0.9)',   // 2023
          'rgba(239, 68, 68, 0.9)',    // 2024
          'rgba(236, 72, 153, 0.9)',   // 2025
          'rgba(251, 146, 60, 0.9)',   // outros
        ]
      };

      anos.forEach((ano, indexAno) => {
        const corIndex = indexAno % coresAnos.contratado.length;
        
        // Linha de kWh contratado para este ano
        datasets.push({
          label: `${ano} - kWh contratado`,
          data: dadosPorAno[ano].contratado,
          borderColor: coresAnos.contratado[corIndex],
          backgroundColor: coresAnos.contratado[corIndex].replace('0.9', '0.2'),
          tension: 0.35,
          borderWidth: 3,
          pointRadius: 4,
          fill: false
        });
        
        // Linha de kWh recebido para este ano
        datasets.push({
          label: `${ano} - kWh recebido`,
          data: dadosPorAno[ano].recebido,
          borderColor: coresAnos.recebido[corIndex],
          backgroundColor: coresAnos.recebido[corIndex].replace('0.9', '0.2'),
          tension: 0.35,
          borderWidth: 3,
          pointRadius: 4,
          fill: false
        });
      });

      return new Chart(ctx, {
        type: 'line',
        data: {
          labels: mesesLabels,
          datasets: datasets
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: {
            mode: 'index',
            intersect: false
          },
          plugins: {
            legend: {
              labels: {
                color: '#0f2a24'
              }
            },
            tooltip: {
              callbacks: {
                label: context => `${context.dataset.label}: ${numberFormatter.format(context.parsed.y)} kWh`
              }
            }
          },
          scales: {
            x: {
              ticks: { color: '#0f2a24' },
              grid: { display: false }
            },
            y: {
              ticks: {
                color: '#0f2a24',
                callback: value => `${numberFormatter.format(value)}`
              },
              grid: {
                color: 'rgba(15, 42, 36, 0.1)'
              }
            }
          }
        }
      });
    }

    let energiaChart = null;

    function updateChart(chart, data) {
      // Agrupa dados por ano
      const dadosPorAno = {};
      data.forEach(item => {
        const date = new Date(`${item.mes_ano}T00:00:00`);
        const ano = date.getFullYear();
        const mes = date.getMonth(); // 0-11
        
        if (!dadosPorAno[ano]) {
          dadosPorAno[ano] = {
            contratado: new Array(12).fill(null),
            recebido: new Array(12).fill(null)
          };
        }
        
        dadosPorAno[ano].contratado[mes] = item.kWhDisponibilizadosMes;
        dadosPorAno[ano].recebido[mes] = item.edp_total_kwh;
      });

      // Labels dos meses (jan, fev, etc)
      const mesesLabels = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
      
      // Cores para diferentes anos
      const coresAnos = {
        contratado: [
          'rgba(15, 155, 156, 0.9)',   // 2023
          'rgba(34, 197, 94, 0.9)',    // 2024
          'rgba(59, 130, 246, 0.9)',   // 2025
          'rgba(168, 85, 247, 0.9)',   // outros
        ],
        recebido: [
          'rgba(249, 115, 22, 0.9)',   // 2023
          'rgba(239, 68, 68, 0.9)',    // 2024
          'rgba(236, 72, 153, 0.9)',   // 2025
          'rgba(251, 146, 60, 0.9)',   // outros
        ]
      };

      // Atualiza labels
      chart.data.labels = mesesLabels;
      
      // Recria datasets
      const datasets = [];
      const anos = Object.keys(dadosPorAno).sort();
      
      anos.forEach((ano, indexAno) => {
        const corIndex = indexAno % coresAnos.contratado.length;
        
        // Linha de kWh contratado para este ano
        datasets.push({
          label: `${ano} - kWh contratado`,
          data: dadosPorAno[ano].contratado,
          borderColor: coresAnos.contratado[corIndex],
          backgroundColor: coresAnos.contratado[corIndex].replace('0.9', '0.2'),
          tension: 0.35,
          borderWidth: 3,
          pointRadius: 4,
          fill: false
        });
        
        // Linha de kWh recebido para este ano
        datasets.push({
          label: `${ano} - kWh recebido`,
          data: dadosPorAno[ano].recebido,
          borderColor: coresAnos.recebido[corIndex],
          backgroundColor: coresAnos.recebido[corIndex].replace('0.9', '0.2'),
          tension: 0.35,
          borderWidth: 3,
          pointRadius: 4,
          fill: false
        });
      });
      
      chart.data.datasets = datasets;
      chart.update();
    }

    function hasActiveFilters(filters) {
      return Boolean(
        filters.parceiro ||
        filters.ano.size ||
        filters.semestre.size ||
        filters.mes.size ||
        filters.instalacao.size ||
        filters.beneficiarios.size
      );
    }

    // Função para normalizar valores de total_kwh_gerado (remove pontos de milhar, converte vírgula para ponto)
    function normalizeKwhValue(value) {
      if (typeof value === 'string') {
        // Remove espaços, pontos de milhar e converte vírgula para ponto
        return parseFloat(value.trim().replace(/\./g, '').replace(',', '.')) || 0;
      }
      return parseFloat(value) || 0;
    }

    // Função para carregar dados da usina
    function loadUsinaData() {
      // Dados embutidos - pode ser substituído por fetch quando usar endpoint
      return [
        {"numero_instalacao_geradora":161073905,"mes_ano":"2024-02","ano":2024,"total_kwh_gerado":"134.641"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2024-01","ano":2024,"total_kwh_gerado":"147.427"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2023-12","ano":2023,"total_kwh_gerado":"157.217"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2023-11","ano":2023,"total_kwh_gerado":"172.636"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2023-10","ano":2023,"total_kwh_gerado":"146.973"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2023-09","ano":2023,"total_kwh_gerado":"134.152"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2023-08","ano":2023,"total_kwh_gerado":"138.464"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2023-07","ano":2023,"total_kwh_gerado":"133.082"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2023-06","ano":2023,"total_kwh_gerado":"225.136"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2024-03","ano":2024,"total_kwh_gerado":"176.758"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2024-04","ano":2024,"total_kwh_gerado":"157.593"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2024-05","ano":2024,"total_kwh_gerado":"155.650"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2024-06","ano":2024,"total_kwh_gerado":" 129.830"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2024-07","ano":2024,"total_kwh_gerado":"136.462"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2024-08","ano":2024,"total_kwh_gerado":"150.823"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2024-09","ano":2024,"total_kwh_gerado":"155.550"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2024-10","ano":2024,"total_kwh_gerado":"139.826"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2024-11","ano":2024,"total_kwh_gerado":"114.967,6500"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2024-12","ano":2024,"total_kwh_gerado":"148.730,4000"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2025-01","ano":2025,"total_kwh_gerado":"138.415,2000"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2025-02","ano":2025,"total_kwh_gerado":"160.540,8000"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2025-03","ano":2025,"total_kwh_gerado":"168.792,7500"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2025-04","ano":2025,"total_kwh_gerado":"131.381,2500"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2025-05","ano":2025,"total_kwh_gerado":"118.170,1500"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2025-06","ano":2025,"total_kwh_gerado":"126.649,95"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2025-07","ano":2025,"total_kwh_gerado":"131.640,6000"},
        {"numero_instalacao_geradora":161073905,"mes_ano":"2025-08","ano":2025,"total_kwh_gerado":"140.094,150"}
      ];
    }

    function buildUsinaChart(data) {
      const ctx = document.getElementById('usinaChart').getContext('2d');

      // Normaliza e agrupa dados por ano
      const dadosPorAno = {};
      data.forEach(item => {
        const mesAno = item.mes_ano; // formato "YYYY-MM"
        const partes = mesAno.split('-');
        const ano = parseInt(partes[0]);
        const mes = parseInt(partes[1]) - 1; // 0-11 para JavaScript Date
        
        if (!dadosPorAno[ano]) {
          dadosPorAno[ano] = new Array(12).fill(null);
        }
        
        const kwhGerado = normalizeKwhValue(item.total_kwh_gerado);
        dadosPorAno[ano][mes] = kwhGerado;
      });

      // Labels dos meses (jan, fev, etc)
      const mesesLabels = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
      
      // Cria datasets para cada ano
      const datasets = [];
      const anos = Object.keys(dadosPorAno).sort();
      
      // Cores para diferentes anos - cores mais distintas e contrastantes
      const coresAnos = [
        'rgba(239, 68, 68, 1)',      // 2023 - Vermelho
        'rgba(34, 197, 94, 1)',      // 2024 - Verde
        'rgba(59, 130, 246, 1)',     // 2025 - Azul
        'rgba(168, 85, 247, 1)',     // Outros - Roxo
        'rgba(249, 115, 22, 1)',     // Laranja
        'rgba(236, 72, 153, 1)',     // Rosa
        'rgba(14, 165, 233, 1)',     // Azul claro
        'rgba(34, 197, 94, 1)',      // Verde claro
      ];

      anos.forEach((ano, indexAno) => {
        const corIndex = indexAno % coresAnos.length;
        
        datasets.push({
          label: `${ano} - kWh Gerado`,
          data: dadosPorAno[ano],
          borderColor: coresAnos[corIndex],
          backgroundColor: coresAnos[corIndex].replace('1)', '0.2)'),
          tension: 0.35,
          borderWidth: 3,
          pointRadius: 4,
          fill: false
        });
      });

      return new Chart(ctx, {
        type: 'line',
        data: {
          labels: mesesLabels,
          datasets: datasets
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: {
            mode: 'index',
            intersect: false
          },
          plugins: {
            legend: {
              labels: {
                color: '#0f2a24'
              }
            },
            tooltip: {
              callbacks: {
                label: context => {
                  const value = context.parsed.y;
                  if (value === null || value === undefined) return '';
                  const rounded = Math.round(value);
                  return `${context.dataset.label}: ${numberFormatter.format(rounded)} kWh`;
                }
              }
            }
          },
          scales: {
            x: {
              ticks: { color: '#0f2a24' },
              grid: { display: false }
            },
            y: {
              ticks: {
                display: false
              },
              grid: {
                color: 'rgba(15, 42, 36, 0.1)'
              }
            }
          }
        }
      });
    }

    let usinaChart = null;
    let usinaTrendChart = null; // Gráfico de tendência da usina

    function updateUsinaChart(chart, data) {
      // Normaliza e agrupa dados por ano
      const dadosPorAno = {};
      data.forEach(item => {
        const mesAno = item.mes_ano; // formato "YYYY-MM"
        const partes = mesAno.split('-');
        const ano = parseInt(partes[0]);
        const mes = parseInt(partes[1]) - 1; // 0-11 para JavaScript Date
        
        if (!dadosPorAno[ano]) {
          dadosPorAno[ano] = new Array(12).fill(null);
        }
        
        const kwhGerado = normalizeKwhValue(item.total_kwh_gerado);
        dadosPorAno[ano][mes] = kwhGerado;
      });

      // Atualiza datasets
      const anos = Object.keys(dadosPorAno).sort();
      // Cores para diferentes anos - cores mais distintas e contrastantes
      const coresAnos = [
        'rgba(239, 68, 68, 1)',      // 2023 - Vermelho
        'rgba(34, 197, 94, 1)',      // 2024 - Verde
        'rgba(59, 130, 246, 1)',     // 2025 - Azul
        'rgba(168, 85, 247, 1)',     // Outros - Roxo
        'rgba(249, 115, 22, 1)',     // Laranja
        'rgba(236, 72, 153, 1)',     // Rosa
        'rgba(14, 165, 233, 1)',     // Azul claro
        'rgba(34, 197, 94, 1)',      // Verde claro
      ];

      const datasets = anos.map((ano, indexAno) => {
        const corIndex = indexAno % coresAnos.length;
        return {
          label: `${ano} - kWh Gerado`,
          data: dadosPorAno[ano],
          borderColor: coresAnos[corIndex],
          backgroundColor: coresAnos[corIndex].replace('1)', '0.2)'),
          tension: 0.35,
          borderWidth: 3,
          pointRadius: 4,
          fill: false
        };
      });

      chart.data.datasets = datasets;
      chart.update();
    }

    function buildUsinaTable(data) {
      const tableHead = document.getElementById('usinaTableHead');
      const tableBody = document.getElementById('usinaTableBody');
      
      if (!tableHead || !tableBody) return;
      
      // Normaliza e agrupa dados por ano e mês
      const dadosPorAno = {};
      const todosValores = [];
      
      data.forEach(item => {
        const mesAno = item.mes_ano; // formato "YYYY-MM"
        const partes = mesAno.split('-');
        const ano = parseInt(partes[0]);
        const mes = parseInt(partes[1]) - 1; // 0-11 para JavaScript Date
        
        if (!dadosPorAno[ano]) {
          dadosPorAno[ano] = new Array(12).fill(null);
        }
        
        const kwhGerado = normalizeKwhValue(item.total_kwh_gerado);
        dadosPorAno[ano][mes] = kwhGerado;
        if (kwhGerado !== null && kwhGerado !== undefined) {
          todosValores.push(kwhGerado);
        }
      });
      
      const thresholdVerde = 150000; // Limite acima do qual fica verde
      const thresholdAmarelo = 140000; // Limite abaixo do qual fica vermelho
      
      // Função para calcular a cor baseada no valor
      function getHeatmapColor(value) {
        // Valores nulos, muito baixos (como 225.136) ou muito altos (acima de 180 mil) ficam cinza
        if (value === null || value === undefined || value < 10000 || value > 180000) {
          return 'rgba(200, 200, 200, 0.3)'; // Cinza para valores inválidos
        }
        
        // Valores abaixo de 140 mil: gradiente vermelho
        if (value < thresholdAmarelo) {
          // Gradiente vermelho: quanto menor, mais vermelho
          const normalized = Math.min(1, value / thresholdAmarelo); // 0 a 1 dentro do range vermelho
          const red = 239;
          const green = Math.round(68 - (68 - 20) * (1 - normalized)); // 20 a 68
          const blue = Math.round(68 - (68 - 20) * (1 - normalized)); // 20 a 68
          const alpha = 0.3 + (0.4 * normalized); // 0.3 a 0.7
          return `rgba(${red}, ${green}, ${blue}, ${alpha})`;
        }
        
        // Valores entre 140 mil e 149 mil: gradiente amarelo
        if (value < thresholdVerde) {
          // Normaliza entre 0 e 1 (onde 0 = 140k e 1 = 150k)
          const normalized = (value - thresholdAmarelo) / (thresholdVerde - thresholdAmarelo);
          // Interpola entre vermelho (140k) e amarelo (150k)
          // Vermelho: rgba(239, 68, 68, ...)
          // Amarelo: rgba(255, 200, 0, ...)
          const red = Math.round(239 + (255 - 239) * normalized); // 239 a 255
          const green = Math.round(68 + (200 - 68) * normalized); // 68 a 200
          const blue = Math.round(68 - (68 - 0) * normalized); // 68 a 0
          const alpha = 0.5 + (0.3 * normalized); // 0.5 a 0.8
          return `rgba(${red}, ${green}, ${blue}, ${alpha})`;
        }
        
        // Valores acima de 150 mil: gradiente verde
        // Normaliza o valor entre 0 e 1 (onde 0 = 150k e 1 = 180k)
        const maxValido = 180000;
        const normalized = (value - thresholdVerde) / (maxValido - thresholdVerde);
        
        // Interpola entre amarelo (150k) e verde (180k)
        // Amarelo: rgba(255, 200, 0, ...)
        // Verde: rgba(34, 197, 94, ...)
        const red = Math.round(255 - (255 - 34) * normalized);
        const green = Math.round(200 + (197 - 200) * normalized);
        const blue = Math.round(0 + (94 - 0) * normalized);
        const alpha = 0.6 + (0.4 * normalized); // Mais opaco para valores maiores
        
        return `rgba(${red}, ${green}, ${blue}, ${alpha})`;
      }
      
      // Labels dos meses
      const mesesLabels = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
      
      // Cria o cabeçalho da tabela
      let headerHTML = '<tr><th style="padding: 12px; text-align: left; background: #f8f9fa; border: 1px solid #dee2e6; font-weight: 600;">Ano</th>';
      mesesLabels.forEach(mes => {
        headerHTML += `<th style="padding: 12px; text-align: center; background: #f8f9fa; border: 1px solid #dee2e6; font-weight: 600;">${mes}</th>`;
      });
      headerHTML += '</tr>';
      tableHead.innerHTML = headerHTML;
      
      // Cria as linhas da tabela
      const anos = Object.keys(dadosPorAno).sort((a, b) => parseInt(b) - parseInt(a)); // Mais recente primeiro
      let bodyHTML = '';
      
      anos.forEach(ano => {
        bodyHTML += `<tr><td style="padding: 12px; text-align: left; background: #f8f9fa; border: 1px solid #dee2e6; font-weight: 600;">${ano}</td>`;
        
        dadosPorAno[ano].forEach((valor, mesIndex) => {
          const cor = getHeatmapColor(valor);
          const valorFormatado = valor !== null && valor !== undefined ? Math.round(valor).toLocaleString('pt-BR') : '-';
          bodyHTML += `<td style="padding: 12px; text-align: center; border: 1px solid #dee2e6; background-color: ${cor}; font-weight: 500;">${valorFormatado}</td>`;
        });
        
        bodyHTML += '</tr>';
      });
      
      tableBody.innerHTML = bodyHTML;
    }

    function buildExecutiveDashboard(beneficiariosData, usinaData) {
      const kpiContainer = document.getElementById('executiveKPIs');
      if (!kpiContainer) return;
      
      // Calcula KPIs da usina - apenas valores abaixo de 180 mil
      const usinaValida = (usinaData || []).filter(item => {
        const kwh = normalizeKwhValue(item.total_kwh_gerado);
        return kwh !== null && kwh !== undefined && kwh < 180000 && kwh >= 10000;
      });
      
      const totalGeradoUsina = usinaValida.reduce((sum, item) => sum + normalizeKwhValue(item.total_kwh_gerado), 0);
      const mediaGeracaoUsina = usinaValida.length > 0 ? totalGeradoUsina / usinaValida.length : 0;
      
      // Encontra melhor e pior mês da usina
      let melhorMesUsina = null;
      let melhorMesValor = 0;
      let piorMesUsina = null;
      let piorMesValor = Infinity;
      
      usinaValida.forEach(item => {
        const kwh = normalizeKwhValue(item.total_kwh_gerado);
        if (kwh > melhorMesValor) {
          melhorMesValor = kwh;
          const partes = item.mes_ano.split('-');
          const mes = partes[1].padStart(2, '0');
          melhorMesUsina = `${mes}/${partes[0]}`;
        }
        if (kwh < piorMesValor) {
          piorMesValor = kwh;
          const partes = item.mes_ano.split('-');
          const mes = partes[1].padStart(2, '0');
          piorMesUsina = `${mes}/${partes[0]}`;
        }
      });
      
      const kpis = [
        {
          title: 'Total Gerado Usina',
          value: Math.round(totalGeradoUsina),
          unit: 'kWh',
          color: 'var(--accent)'
        },
        {
          title: 'Média Geração Usina',
          value: Math.round(mediaGeracaoUsina),
          unit: 'kWh',
          color: 'var(--accent)'
        },
        {
          title: 'Melhor Mês Usina',
          value: melhorMesUsina || 'N/A',
          unit: melhorMesUsina ? `(${Math.round(melhorMesValor).toLocaleString('pt-BR')} kWh)` : '',
          color: 'var(--positive)'
        },
        {
          title: 'Pior Mês Usina',
          value: piorMesUsina || 'N/A',
          unit: piorMesUsina ? `(${Math.round(piorMesValor).toLocaleString('pt-BR')} kWh)` : '',
          color: 'var(--negative)'
        }
      ];
      
      let html = '';
      kpis.forEach(kpi => {
        html += `
          <div class="executive-kpi-card" style="
            background: white;
            border: 2px solid ${kpi.color};
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s, box-shadow 0.2s;
          ">
            <div style="font-size: 0.9rem; color: #666; margin-bottom: 8px; font-weight: 500;">${kpi.title}</div>
            <div style="display: flex; align-items: baseline; gap: 8px; flex-wrap: wrap;">
              <div style="font-size: 2rem; font-weight: 700; color: ${kpi.color};">
                ${typeof kpi.value === 'number' ? kpi.value.toLocaleString('pt-BR') : kpi.value}
              </div>
              ${kpi.unit ? `<span style="font-size: 1rem; color: #666;">${kpi.unit}</span>` : ''}
              ${kpi.percentage ? `<span style="font-size: 0.9rem; color: ${kpi.color}; font-weight: 600;">${kpi.percentage}</span>` : ''}
            </div>
          </div>
        `;
      });
      
      kpiContainer.innerHTML = html;
    }

    function buildUsinaPerformance(data) {
      const container = document.getElementById('usinaPerformanceContainer');
      if (!container) return;
      
      // Filtra apenas valores válidos
      const dadosValidos = data.filter(item => {
        const kwh = normalizeKwhValue(item.total_kwh_gerado);
        return kwh !== null && kwh !== undefined && kwh < 180000 && kwh >= 10000;
      });
      
      if (dadosValidos.length === 0) {
        container.innerHTML = '<p style="color: #666; padding: 16px;">Nenhum dado válido para análise.</p>';
        return;
      }
      
      // Agrupa por ano
      const dadosPorAno = {};
      dadosValidos.forEach(item => {
        const ano = item.ano;
        if (!dadosPorAno[ano]) {
          dadosPorAno[ano] = [];
        }
        dadosPorAno[ano].push({
          mesAno: item.mes_ano,
          kwhGerado: normalizeKwhValue(item.total_kwh_gerado)
        });
      });
      
      // Calcula métricas de performance
      const anos = Object.keys(dadosPorAno).sort((a, b) => parseInt(b) - parseInt(a));
      const performanceMetrics = [];
      
      anos.forEach(ano => {
        const registros = dadosPorAno[ano];
        const valores = registros.map(r => r.kwhGerado);
        const soma = valores.reduce((sum, v) => sum + v, 0);
        const media = soma / valores.length;
        const max = Math.max(...valores);
        const min = Math.min(...valores);
        const variacao = max - min;
        const coeficienteVariacao = media > 0 ? (variacao / media) * 100 : 0;
        
        // Crescimento em relação ao ano anterior
        const anoAnterior = parseInt(ano) - 1;
        let crescimento = null;
        if (dadosPorAno[anoAnterior]) {
          const somaAnoAnterior = dadosPorAno[anoAnterior].reduce((sum, r) => sum + r.kwhGerado, 0);
          crescimento = somaAnoAnterior > 0 ? ((soma - somaAnoAnterior) / somaAnoAnterior) * 100 : 0;
        }
        
        performanceMetrics.push({
          ano,
          soma,
          media,
          max,
          min,
          variacao,
          coeficienteVariacao,
          crescimento,
          meses: registros.length
        });
      });
      
      // Gera HTML
      let html = `
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
      `;
      
      performanceMetrics.forEach(metric => {
        html += `
          <div class="summary-card" style="flex: 1 1 300px; min-width: 280px;">
            <div class="summary-card-title">Análise ${metric.ano}</div>
            <div class="summary-card-content">
              <div class="summary-item">
                <span>Total Gerado:</span>
                <strong>${Math.round(metric.soma).toLocaleString('pt-BR')} kWh</strong>
              </div>
              <div class="summary-item">
                <span>Média Mensal:</span>
                <strong>${Math.round(metric.media).toLocaleString('pt-BR')} kWh</strong>
              </div>
              <div class="summary-item">
                <span>Máximo:</span>
                <strong style="color: var(--positive);">${Math.round(metric.max).toLocaleString('pt-BR')} kWh</strong>
              </div>
              <div class="summary-item">
                <span>Mínimo:</span>
                <strong style="color: var(--negative);">${Math.round(metric.min).toLocaleString('pt-BR')} kWh</strong>
              </div>
              <div class="summary-item">
                <span>Variação:</span>
                <strong>${Math.round(metric.variacao).toLocaleString('pt-BR')} kWh</strong>
              </div>
              <div class="summary-item">
                <span>Coef. Variação:</span>
                <strong>${metric.coeficienteVariacao.toFixed(2)}%</strong>
              </div>
              ${metric.crescimento !== null ? `
                <div class="summary-item" style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #e5e7eb;">
                  <span>Crescimento vs ${metric.ano - 1}:</span>
                  <strong style="color: ${metric.crescimento >= 0 ? 'var(--positive)' : 'var(--negative)'};">
                    ${metric.crescimento >= 0 ? '+' : ''}${metric.crescimento.toFixed(2)}%
                  </strong>
                </div>
              ` : ''}
            </div>
          </div>
        `;
      });
      
      html += `</div>`;
      
      // Adiciona gráfico de tendência
      html += `
        <div style="margin-top: 32px;">
          <h3 style="font-size: 1.1rem; font-weight: 600; margin-bottom: 16px; color: var(--text);">
            Tendência de Geração (Média Mensal por Ano)
          </h3>
          <div class="chart-container" style="height: 300px;">
            <canvas id="usinaTrendChart" aria-label="Gráfico tendência geração usina" role="img"></canvas>
          </div>
        </div>
      `;
      
      container.innerHTML = html;
      
      // Cria gráfico de tendência
      setTimeout(() => {
        const ctx = document.getElementById('usinaTrendChart');
        if (ctx) {
          // Destrói gráfico anterior se existir
          if (usinaTrendChart) {
            usinaTrendChart.destroy();
            usinaTrendChart = null;
          }
          
          const trendData = performanceMetrics.map(m => ({
            ano: m.ano,
            media: m.media
          })).sort((a, b) => parseInt(a.ano) - parseInt(b.ano));
          
          usinaTrendChart = new Chart(ctx.getContext('2d'), {
            type: 'line',
            data: {
              labels: trendData.map(d => d.ano),
              datasets: [{
                label: 'Média Mensal (kWh)',
                data: trendData.map(d => d.media),
                borderColor: 'rgba(15, 155, 156, 1)',
                backgroundColor: 'rgba(15, 155, 156, 0.2)',
                tension: 0.4,
                borderWidth: 3,
                pointRadius: 6,
                pointBackgroundColor: 'rgba(15, 155, 156, 1)',
                fill: true
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: {
                  labels: {
                    color: '#0f2a24'
                  }
                },
                tooltip: {
                  callbacks: {
                    label: context => {
                      return `Média: ${Math.round(context.parsed.y).toLocaleString('pt-BR')} kWh`;
                    }
                  }
                }
              },
              scales: {
                x: {
                  ticks: { color: '#0f2a24' },
                  grid: { display: false }
                },
                y: {
                  ticks: {
                    color: '#0f2a24',
                    callback: value => {
                      return `${Math.round(value).toLocaleString('pt-BR')} kWh`;
                    }
                  },
                  grid: {
                    color: 'rgba(15, 42, 36, 0.1)'
                  }
                }
              }
            }
          });
        }
      }, 100);
    }

    function buildUsinaSummary(data) {
      const yearSummaryContainer = document.getElementById('usinaYearSummary');
      const generalSummaryContainer = document.getElementById('usinaGeneralSummary');
      
      if (!yearSummaryContainer || !generalSummaryContainer) return;
      
      // Filtra apenas valores válidos (abaixo de 180 mil)
      const dadosValidos = data.filter(item => {
        const kwhGerado = normalizeKwhValue(item.total_kwh_gerado);
        return kwhGerado !== null && kwhGerado !== undefined && kwhGerado < 180000 && kwhGerado >= 10000;
      });
      
      if (dadosValidos.length === 0) {
        yearSummaryContainer.innerHTML = '<p style="color: #666; padding: 16px;">Nenhum dado válido para exibir.</p>';
        generalSummaryContainer.innerHTML = '';
        return;
      }
      
      // Agrupa por ano
      const dadosPorAno = {};
      const mesesLabels = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
      
      dadosValidos.forEach(item => {
        const mesAno = item.mes_ano;
        const partes = mesAno.split('-');
        const ano = parseInt(partes[0]);
        const mes = parseInt(partes[1]) - 1;
        const kwhGerado = normalizeKwhValue(item.total_kwh_gerado);
        
        if (!dadosPorAno[ano]) {
          dadosPorAno[ano] = [];
        }
        
        dadosPorAno[ano].push({
          mes,
          mesAno,
          kwhGerado,
          mesLabel: mesesLabels[mes]
        });
      });
      
      // Calcula estatísticas por ano
      const statsPorAno = {};
      Object.keys(dadosPorAno).sort((a, b) => parseInt(b) - parseInt(a)).forEach(ano => {
        const registros = dadosPorAno[ano];
        const valores = registros.map(r => r.kwhGerado);
        const soma = valores.reduce((sum, v) => sum + v, 0);
        const media = soma / valores.length;
        
        // Encontra melhor e pior mês
        const melhorMes = registros.reduce((max, r) => r.kwhGerado > max.kwhGerado ? r : max, registros[0]);
        const piorMes = registros.reduce((min, r) => r.kwhGerado < min.kwhGerado ? r : min, registros[0]);
        
        statsPorAno[ano] = {
          media,
          melhorMes: melhorMes.mesLabel,
          melhorMesValor: melhorMes.kwhGerado,
          melhorMesAno: melhorMes.mesAno,
          piorMes: piorMes.mesLabel,
          piorMesValor: piorMes.kwhGerado,
          piorMesAno: piorMes.mesAno,
          total: soma
        };
      });
      
      // Gera caixas por ano
      let yearHTML = '';
      Object.keys(statsPorAno).forEach(ano => {
        const stats = statsPorAno[ano];
        yearHTML += `
          <div class="summary-card" style="flex: 1 1 300px; min-width: 280px; max-width: 400px;">
            <div class="summary-card-title">Ano ${ano}</div>
            <div class="summary-card-content">
              <div class="summary-item">
                <span>Média Gerada:</span>
                <strong>${Math.round(stats.media).toLocaleString('pt-BR')} kWh</strong>
              </div>
              <div class="summary-item">
                <span>Total Gerado:</span>
                <strong>${Math.round(stats.total).toLocaleString('pt-BR')} kWh</strong>
              </div>
              <div class="summary-item" style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #e5e7eb;">
                <span>Melhor Mês:</span>
                <strong style="color: var(--positive);">${stats.melhorMes} - ${Math.round(stats.melhorMesValor).toLocaleString('pt-BR')} kWh</strong>
              </div>
              <div class="summary-item">
                <span>Pior Mês:</span>
                <strong style="color: var(--negative);">${stats.piorMes} - ${Math.round(stats.piorMesValor).toLocaleString('pt-BR')} kWh</strong>
              </div>
            </div>
          </div>
        `;
      });
      yearSummaryContainer.innerHTML = yearHTML;
      
      // Calcula estatísticas gerais
      // Ano que mais gerou (soma total)
      let anoMaisGerou = null;
      let maxTotalAno = 0;
      Object.keys(statsPorAno).forEach(ano => {
        if (statsPorAno[ano].total > maxTotalAno) {
          maxTotalAno = statsPorAno[ano].total;
          anoMaisGerou = ano;
        }
      });
      
      // Melhor mês/ano (maior geração individual)
      let melhorMesAno = null;
      let melhorMesAnoValor = 0;
      dadosValidos.forEach(item => {
        const kwhGerado = normalizeKwhValue(item.total_kwh_gerado);
        if (kwhGerado > melhorMesAnoValor) {
          melhorMesAnoValor = kwhGerado;
          const partes = item.mes_ano.split('-');
          melhorMesAno = {
            mes: mesesLabels[parseInt(partes[1]) - 1],
            ano: partes[0],
            mesAno: item.mes_ano
          };
        }
      });
      
      // Pior mês/ano (menor geração individual)
      let piorMesAno = null;
      let piorMesAnoValor = Infinity;
      dadosValidos.forEach(item => {
        const kwhGerado = normalizeKwhValue(item.total_kwh_gerado);
        if (kwhGerado < piorMesAnoValor) {
          piorMesAnoValor = kwhGerado;
          const partes = item.mes_ano.split('-');
          piorMesAno = {
            mes: mesesLabels[parseInt(partes[1]) - 1],
            ano: partes[0],
            mesAno: item.mes_ano
          };
        }
      });
      
      // Gera caixas gerais
      let generalHTML = '';
      
      if (anoMaisGerou) {
        generalHTML += `
          <div class="summary-card" style="flex: 1 1 300px; min-width: 280px; max-width: 400px;">
            <div class="summary-card-title">Ano que Mais Gerou</div>
            <div class="summary-card-content">
              <div class="summary-item">
                <span>Ano:</span>
                <strong style="color: var(--positive); font-size: 1.2em;">${anoMaisGerou}</strong>
              </div>
              <div class="summary-item">
                <span>Total Gerado:</span>
                <strong>${Math.round(maxTotalAno).toLocaleString('pt-BR')} kWh</strong>
              </div>
            </div>
          </div>
        `;
      }
      
      if (melhorMesAno) {
        generalHTML += `
          <div class="summary-card" style="flex: 1 1 300px; min-width: 280px; max-width: 400px;">
            <div class="summary-card-title">Melhor Mês/Ano</div>
            <div class="summary-card-content">
              <div class="summary-item">
                <span>Período:</span>
                <strong style="color: var(--positive); font-size: 1.2em;">${melhorMesAno.mes}/${melhorMesAno.ano}</strong>
              </div>
              <div class="summary-item">
                <span>Geração:</span>
                <strong>${Math.round(melhorMesAnoValor).toLocaleString('pt-BR')} kWh</strong>
              </div>
            </div>
          </div>
        `;
      }
      
      if (piorMesAno) {
        generalHTML += `
          <div class="summary-card" style="flex: 1 1 300px; min-width: 280px; max-width: 400px;">
            <div class="summary-card-title">Pior Mês/Ano</div>
            <div class="summary-card-content">
              <div class="summary-item">
                <span>Período:</span>
                <strong style="color: var(--negative); font-size: 1.2em;">${piorMesAno.mes}/${piorMesAno.ano}</strong>
              </div>
              <div class="summary-item">
                <span>Geração:</span>
                <strong>${Math.round(piorMesAnoValor).toLocaleString('pt-BR')} kWh</strong>
              </div>
            </div>
          </div>
        `;
      }
      
      generalSummaryContainer.innerHTML = generalHTML;
    }

    function showAwaitingSelection() {
      diffValue.textContent = '0 kWh';
      diffCard.dataset.state = 'positive';
      diffLegend.textContent = 'Selecione um beneficiário ou aplique filtros para visualizar os dados.';
      insightsGrid.innerHTML = '';
      tableBody.innerHTML = '';
      tableBody.parentElement.style.display = 'none';
      emptyState.hidden = false;
      emptyState.textContent = 'Selecione um beneficiário ou aplique filtros para visualizar.';
      if (yearSummaryCard) yearSummaryCard.hidden = true;
      if (summaryCardsContainer) summaryCardsContainer.hidden = true;
      if (energiaChart) {
        updateChart(energiaChart, []);
      }
      // Seções da usina sempre exibidas (não dependem dos filtros)
      const usinaData = loadUsinaData();
      if (!usinaChart) {
        usinaChart = buildUsinaChart(usinaData);
      } else {
        updateUsinaChart(usinaChart, usinaData);
      }
      buildUsinaTable(usinaData);
      buildUsinaSummary(usinaData);
      buildUsinaPerformance(usinaData);
      buildExecutiveDashboard([], usinaData);
    }

    function refreshDashboard() {
      const filters = getFilters();
      const hasFilters = hasActiveFilters(filters);

      // Se não houver filtros selecionados, mostra mensagem de aguardo
      if (!hasFilters) {
        showAwaitingSelection();
        // Mas sempre atualiza as seções da usina (independente de filtros)
        const usinaData = loadUsinaData();
        if (!usinaChart) {
          usinaChart = buildUsinaChart(usinaData);
        } else {
          updateUsinaChart(usinaChart, usinaData);
        }
        buildUsinaTable(usinaData);
        buildUsinaSummary(usinaData);
        buildUsinaPerformance(usinaData);
        buildExecutiveDashboard([], usinaData);
        return;
      }

      // Aplica filtros e processa dados
      const filtered = applyFilters(rawData, filters);
      
      // Reconstrói os perfis de beneficiários com os anos selecionados
      const selectedYears = getSelectedYears();
      benefProfiles = buildBeneficiaryProfiles(filtered, selectedYears);
      populateBenefCheckboxes(benefProfiles);

      if (filtered.length === 0) {
        updateDiffCard({ totalDiferenca: 0 });
        diffLegend.textContent = 'Sem dados para os filtros aplicados.';
        insightsGrid.innerHTML = '';
        tableBody.innerHTML = '';
        emptyState.hidden = false;
        emptyState.textContent = 'Nenhum registro encontrado para os filtros selecionados.';
        if (yearSummaryCard) yearSummaryCard.hidden = true;
        if (summaryCardsContainer) summaryCardsContainer.hidden = true;
        energiaChart && updateChart(energiaChart, []);
        // Seções da usina sempre exibidas (não dependem dos filtros)
        const usinaDataEmpty = loadUsinaData();
        if (!usinaChart) {
          usinaChart = buildUsinaChart(usinaDataEmpty);
        } else {
          updateUsinaChart(usinaChart, usinaDataEmpty);
        }
        buildUsinaTable(usinaDataEmpty);
        buildUsinaSummary(usinaDataEmpty);
        buildUsinaPerformance(usinaDataEmpty);
        buildExecutiveDashboard([], usinaDataEmpty);
        return;
      }

      const summary = summarize(filtered);
      updateDiffCard(summary);
      updateInsights(summary);
      updateTable(filtered);
      updateYearSummary(filtered);
      updateSummaryCards(filtered);
      
      // Inicializa ou atualiza o gráfico
      if (!energiaChart) {
        energiaChart = buildChart(filtered);
      } else {
        updateChart(energiaChart, filtered);
      }
      
      // Carrega e exibe dados da usina (sempre exibido, independente dos filtros)
      const usinaData = loadUsinaData();
      if (!usinaChart) {
        usinaChart = buildUsinaChart(usinaData);
      } else {
        updateUsinaChart(usinaChart, usinaData);
      }
      // Atualiza a tabela com mapa de calor
      buildUsinaTable(usinaData);
      // Atualiza as caixas de resumo
      buildUsinaSummary(usinaData);
      // Atualiza análise de performance
      buildUsinaPerformance(usinaData);
      
      // Atualiza dashboard executivo
      buildExecutiveDashboard(filtered, usinaData);
      
      // Mostra a tabela se estava oculta
      tableBody.parentElement.style.display = 'table';
      emptyState.hidden = true;
    }

      populateFilters(rawData);
      // Não cria o gráfico inicialmente - será criado quando houver filtros
      showAwaitingSelection();
      
      // Inicializa o gráfico da usina (sempre exibido, independente dos filtros)
      const usinaData = loadUsinaData();
      usinaChart = buildUsinaChart(usinaData);
      buildUsinaTable(usinaData);
      buildUsinaSummary(usinaData);
      buildUsinaPerformance(usinaData);
      
      // Atualiza dashboard executivo
      buildExecutiveDashboard(rawData, usinaData);

      filtersForm.addEventListener('input', refreshDashboard);
      filtersForm.addEventListener('change', refreshDashboard);
      filtersForm.addEventListener('reset', () => {
        setTimeout(() => {
          // Limpa os checkboxes dos filtros
          Object.keys(selectedFilters).forEach(key => {
            selectedFilters[key].clear();
            const filter = selectElements[key];
            if (filter && filter.all) {
              filter.all.checked = false;
              const checkboxes = filter.list.querySelectorAll('input[type="checkbox"]');
              checkboxes.forEach(cb => cb.checked = false);
            }
          });
          resetBenefCheckboxes();
          refreshDashboard();
        }, 0);
      });
    }

    // Inicializa o dashboard
    initDashboard();
  </script>
  <footer style="text-align: center; padding: 40px 24px 24px;">
    <img src="logo_sisgdsolar.png" alt="SISGDSOLAR - Energia Limpa Inteligente" class="footer-logo">
  </footer>
</body>
</html>

